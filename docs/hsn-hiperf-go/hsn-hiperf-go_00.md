# 前言

《Go 高性能实战》是一个完整的资源，具有经过验证的方法和技术，可帮助您诊断和解决 Go 应用程序中的性能问题。本书从性能概念入手，您将了解 Go 性能背后的思想。接下来，您将学习如何有效地实现 Go 数据结构和算法，并探索数据操作和组织，以便编写可扩展软件的程序。通道和 goroutines 用于并行和并发，以编写分布式系统的高性能代码也是本书的核心部分。接着，您将学习如何有效地管理内存。您将探索**CUDA**驱动**API**，使用容器构建 Go 代码，并利用 Go 构建缓存加快编译速度。您还将清楚地了解如何对 Go 代码进行性能分析和跟踪，以检测系统中的瓶颈。最后，您将评估集群和作业队列以进行性能优化，并监视应用程序以检测性能回归。

# 本书适合对象

这本 Go 书对于具有中级到高级 Go 编程理解的开发人员和专业人士来说是必不可少的，他们有兴趣提高代码执行速度。

# 本书涵盖内容

第一章《Go 性能简介》将讨论计算机科学中性能为何重要。您还将了解为什么 Go 语言中性能很重要。

第二章《数据结构和算法》涉及数据结构和算法，它们是构建软件的基本单元，尤其是复杂性能软件。理解它们将帮助您思考如何最有效地组织和操作数据，以编写有效的、高性能的软件。此外，迭代器和生成器对于 Go 是必不可少的。本章将包括不同数据结构和算法的解释，以及它们的大 O 符号是如何受影响的。

第三章《理解并发》将讨论利用通道和 goroutines 进行并行和并发，这在 Go 中是惯用的，也是在系统中编写高性能代码的最佳方式。能够理解何时何地使用这些设计模式对于编写高性能的 Go 是至关重要的。

第四章《Go 中的 STL 算法等价物》讨论了许多来自其他高性能语言（尤其是 C++）的程序员如何理解标准模板库的概念，该库提供了常见的编程数据结构和函数，以便快速迭代和编写大规模的高性能代码。

第五章《Go 中的矩阵和向量计算》涉及一般的矩阵和向量计算。矩阵在图形处理和人工智能中很重要，特别是图像识别。向量可以在动态数组中保存大量对象。它们使用连续存储，并可以被操作以适应增长。

第六章《编写可读的 Go 代码》着重于编写可读的 Go 代码的重要性。理解本章讨论的模式和习惯用法将帮助您编写更易读、更易操作的 Go 代码。此外，能够编写习惯用法的 Go 将有助于提高代码质量，并帮助项目保持速度。

第七章《Go 中的模板编程》专注于 Go 中的模板编程。元编程允许最终用户编写生成、操作和运行 Go 程序的 Go 程序。Go 具有清晰的静态依赖关系，这有助于元编程。它在元编程方面存在其他语言所没有的缺点，比如 Python 中的`__getattr__`，但如果被认为明智，我们仍然可以生成 Go 代码并编译生成的代码。

第八章《Go 中的内存管理》讨论了内存管理对系统性能至关重要。能够充分利用计算机的内存占用量使您能够将高性能程序保留在内存中，这样您就不必经常承受切换到磁盘的巨大性能损失。有效地管理内存是编写高性能 Go 代码的核心原则。

第九章《Go 中的 GPU 并行化》专注于 GPU 加速编程，在当今高性能计算堆栈中变得越来越重要。我们可以使用 CUDA 驱动程序 API 进行 GPU 加速。这在诸如深度学习算法等主题中通常被使用。

第十章《Go 中的编译时评估》讨论了在编写 Go 程序时最小化依赖关系以及每个文件声明自己的依赖关系。常规语法和模块支持也有助于提高编译时间，以及接口满足。这些都有助于加快 Go 编译速度，同时利用容器构建 Go 代码并利用 Go 构建缓存。

第十一章《构建和部署 Go 代码》着重介绍了如何部署新的 Go 代码。更进一步地，本章解释了我们如何将其推送到一个或多个地方，以便针对不同环境进行测试。这样做将使我们能够推动系统的吞吐量极限。

第十二章《Go 代码性能分析》专注于对 Go 代码进行性能分析，这是确定 Go 函数中瓶颈所在的最佳方法之一。进行这种性能分析将帮助您推断在函数内部可以进行哪些改进，以及在整个系统中个别部分在函数调用中所占用的时间。

第十三章《跟踪 Go 代码》介绍了一种检查 Go 程序中函数和服务之间互操作性的绝妙方法，也称为跟踪。跟踪允许您通过系统传递上下文并评估您所卡住的位置。无论是第三方 API 调用、缓慢的消息队列还是 O(n²)函数，跟踪都将帮助您找到瓶颈所在。

第十四章《集群和作业队列》着重介绍了集群和作业队列在 Go 中的重要性，作为使分布式系统同步工作并传递一致消息的良好方式。分布式计算很困难，因此在集群和作业队列中寻找潜在的性能优化变得非常重要。

第十五章《跨版本比较代码质量》讨论了在编写、调试、分析和监控长期监控应用程序性能的 Go 代码之后，您应该做些什么。如果您无法继续提供基础架构中其他系统所依赖的性能水平，那么向您的代码添加新功能是毫无意义的。

# 为了充分利用本书

本书适用于 Go 专业人士和开发人员，他们希望加快代码执行速度，因此需要具有中级到高级的 Go 编程理解才能充分利用本书。Go 语言的系统要求相对较低。现代计算机和现代操作系统应该支持 Go 运行时及其依赖项。Go 在许多低功耗设备上使用，这些设备具有有限的 CPU、内存和 I/O 要求。

您可以在以下网址查看语言的要求：[`github.com/golang/go/wiki/MinimumRequirements`](https://github.com/golang/go/wiki/MinimumRequirements)。

在本书中，我使用 Fedora Core Linux（在撰写本书时为第 29 版）作为操作系统。有关如何安装 Fedora Workstation Linux 发行版的说明，请访问以下网址：[`getfedora.org/en/workstation/download/`](https://getfedora.org/en/workstation/download/)。

Docker 在本书的许多示例中使用。您可以在以下网址查看 Docker 的要求：[`docs.docker.com/install/`](https://docs.docker.com/install/)。

在第九章中，《Go 中的 GPU 并行化》，我们讨论了 GPU 编程。要执行本章的任务，您需要以下两种东西之一：

+   启用 NVIDIA 的 GPU。我在测试中使用了一款 NVIDIA GeForce GTX 670，计算能力为 3.0。

+   启用 GPU 的云实例。第九章讨论了几种不同的提供商和方法。Compute Engine 上的 GPU 适用于此。有关 Compute Engine 上 GPU 的最新信息，请访问以下网址：[`cloud.google.com/compute/docs/gpus`](https://cloud.google.com/compute/docs/gpus)。

阅读本书后，希望您能够编写更高效的 Go 代码。您将有望能够量化和验证自己的努力。

# 下载示例代码文件

您可以从您在[www.packt.com](http://www.packt.com)的帐户中下载本书的示例代码文件。如果您在其他地方购买了本书，可以访问[www.packtpub.com/support](https://www.packtpub.com/support)注册，直接将文件发送到您的邮箱。

按照以下步骤下载代码文件：

1.  登录或注册[www.packt.com](http://www.packt.com)。

1.  选择“支持”选项卡。

1.  单击“代码下载”。

1.  在搜索框中输入书名，然后按照屏幕上的说明操作。

下载文件后，请确保您使用最新版本的解压缩或提取文件夹：

+   WinRAR/7-Zip 适用于 Windows

+   Zipeg/iZip/UnRarX 适用于 Mac

+   7-Zip/PeaZip 适用于 Linux

本书的代码包也托管在 GitHub 上，网址为[`github.com/bobstrecansky/HighPerformanceWithGo/`](https://github.com/bobstrecansky/HighPerformanceWithGo/)。如果代码有更新，将在现有的 GitHub 存储库上进行更新。

我们还提供了来自我们丰富书籍和视频目录的其他代码包，可在**[`github.com/PacktPublishing/`](https://github.com/PacktPublishing/)**上找到。快去看看吧！

# 实际代码

本书的实际代码视频可在[`bit.ly/2QcfEJI`](http://bit.ly/2QcfEJI)上观看。

# 下载彩色图片

我们还提供了一个 PDF 文件，其中包含本书中使用的屏幕截图/图表的彩色图片。您可以在此处下载：[`static.packt-cdn.com/downloads/9781789805789_ColorImages.pdf`](https://static.packt-cdn.com/downloads/9781789805789_ColorImages.pdf)。

# 使用的约定

本书中使用了许多文本约定。

`CodeInText`：表示文本中的代码字词、数据库表名、文件夹名、文件名、文件扩展名、路径名、虚拟 URL、用户输入和 Twitter 句柄。例如："以下代码块将显示`Next()`咒语"

代码块设置如下：

```go
// Note the trailing () for this anonymous function invocation
func() {
  fmt.Println("Hello Go")
}()
```

当我们希望引起你对代码块的特定部分的注意时，相关的行或项目会以粗体显示：

```go
// Note the trailing () for this anonymous function invocation
func() {
  fmt.Println("Hello Go")
}()
```

任何命令行输入或输出都是这样写的：

```go
$ go test -bench=. -benchtime 2s -count 2 -benchmem -cpu 4
```

**粗体**：表示一个新术语，一个重要的词，或者你在屏幕上看到的词。例如，菜单或对话框中的单词会以这种方式出现在文本中。这是一个例子：“**reverse algorithm**接受一个数据集，并颠倒集合的值”

警告或重要提示会以这种方式出现。

技巧和窍门会以这种方式出现。
