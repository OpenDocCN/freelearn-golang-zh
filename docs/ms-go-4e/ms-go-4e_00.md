# 前言

欢迎阅读《精通 Go 语言》的第四版！随着 Go 编程语言的持续发展和流行，我很高兴向大家呈现这本书的更新版。

在技术快速变化的领域中，Go 语言已经成为构建可扩展、性能良好且易于维护的软件的首选语言。无论您是一位经验丰富的 Go 开发者，希望深化您的专业知识，还是一位渴望掌握语言复杂性的新手，本书都是您的全面指南。

如果您拥有《精通 Go 语言》的旧版，除了现在相当古老的初版之外，不要因为《精通 Go 语言，第四版》的推出就将其丢弃。Go 语言并没有发生太大的变化，第二版和第三版仍然有用且相关。然而，《精通 Go 语言，第四版》在很多方面都比之前的版本更好，并包含了关于最新 Go 版本的信息，这些信息您在之前的版本中是找不到的。

在最新版中存在许多令人兴奋的主题，包括编写 RESTful 服务、编写统计应用程序以及使用 eBPF，以及关于模糊测试和可观察性的全新章节。

我试图包含适量的理论和实践内容——但只有您，读者，才能告诉我是否成功。请尝试完成每章末尾的练习，并且不要犹豫与我联系，告诉我如何或有哪些想法可以使本书的后续版本更加完善。

感谢您选择阅读《精通 Go 语言，第四版》。让我们一起深入探索，共同发掘 Go 语言的全部潜力。祝您编码愉快！

# 本书面向读者

本书面向希望将 Go 语言知识提升到更高层次的业余和中级 Go 程序员，也适用于希望学习 Go 语言的其他编程语言开发者。

如果这是您读的第一本编程书，您可能会在理解上遇到一些问题，可能需要再次阅读才能完全吸收所有展示的知识。

通过实践学习是学习任何编程语言的基本原则。在本书中，您将找到实用的示例和动手练习，这些示例和练习说明了关键概念，并鼓励您将知识应用于实际场景。

**无论如何，都要准备好工作、学习、失败，然后再工作、学习、再失败。**毕竟，生活与编程并没有太大的区别。

# 本书涵盖内容

*第一章*，*Go 语言快速入门*，首先讨论了 Go 语言的历史、Go 语言的重要特性和优势，然后描述了`godoc`和`go doc`实用工具，并解释了如何编译和执行 Go 程序。接着，本章讨论了控制程序流程、打印输出和获取用户输入、处理命令行参数以及使用日志文件。在*第一章*的最后部分，我们开发了一个基本的统计应用程序版本，我们将在接下来的章节中对其进行改进。

*第二章*，*基本 Go 数据类型*，讨论了 Go 语言的基本数据类型，包括数值和非数值类型；允许您对相同类型的数据进行分组的数组切片；Go 指针；常量；以及处理日期和时间。本章的最后部分是关于生成随机数，并用随机数据填充统计应用程序。

*第三章*，*复合数据类型*，首先向您介绍映射，然后进入结构和`struct`关键字。此外，它还讨论了正则表达式、模式匹配以及处理 CSV 文件。最后，通过添加数据持久性来改进统计应用程序。

*第四章*，*Go 泛型*，是关于泛型和如何使用新语法编写泛型函数以及定义泛型数据类型。本章还介绍了`cmp`包、`slices`包和`maps`包，这些都是使用泛型实现的，以便与尽可能多的数据类型一起工作。

*第五章*，*反射和接口*，是关于反射、接口和类型方法，这些是附加到数据类型上的函数。本章还涵盖了使用`sort.Interface`接口对切片进行排序、使用空接口、类型断言、类型选择和`error`数据类型。此外，我们讨论了 Go 语言如何模仿一些面向对象的概念，并在改进统计应用程序之前进行讨论。本章还比较了泛型和接口以及反射。

*第六章*，*Go 包和函数*，主要关于包、模块和函数，它们是包的主要元素。其中，我们创建了一个用于与 SQLite3 数据库交互的 Go 包，为其编写了文档，并解释了有时棘手的`defer`关键字的使用。最后，我们讨论了工作区（Workspaces），这是 Go 语言的一个相对较新的特性。

*第七章*，*告诉 UNIX 系统做什么*，是关于系统编程的，包括处理命令行参数、处理 UNIX 信号、文件输入输出、`io.Reader`和`io.Writer`接口以及`viper`和`cobra`包的使用。最后，我们更新了统计应用程序，使其使用 JSON 数据，并在`cobra`包的帮助下将其转换为合适的命令行实用工具。

*第八章*，*Go 并发*，讨论了 goroutines、channels 和 pipelines。我们学习了进程、线程和 goroutines 之间的区别，`sync`包以及 Go 调度器的工作方式。此外，我们还探讨了`select`关键字的使用，以及 Go channels 的各种*类型*、共享内存、互斥锁、`sync.Mutex`类型和`sync.RWMutex`类型。本章的其余部分讨论了`context`包、`semaphore`包、工作池、如何超时 goroutines 以及如何检测竞态条件。

*第九章*，*构建 Web 服务*，讨论了`net/http`包、Web 服务器和 Web 服务的开发、创建 Web 客户端以及 HTTP 连接的超时。我们还把统计应用程序转换成一个 Web 服务，并为它创建了一个命令行客户端。

*第十章*，*与 TCP/IP 和 WebSocket 协同工作*，讲述了`net`包、TCP/IP、TCP 和 UDP 协议，以及 WebSocket 协议和与 RabbitMQ 协同工作。在本章中，我们开发了大量的实用服务器和客户端。

*第十一章*，*与 REST API 协同工作*，全部关于与 REST API 和 RESTful 服务协同工作。我们学习了如何定义 REST API，开发强大的并发 RESTful 服务器以及作为 RESTful 服务客户端的命令行实用工具。

*第十二章*，*代码测试和性能分析*，讨论了代码测试、代码优化和代码性能分析，以及交叉编译、创建示例函数、使用`go:generate`和查找不可达的 Go 代码。

*第十三章*，*模糊测试和可观察性*，讲述了模糊测试，这是 Go 编程语言中相对较新的功能，以及可观察性，它指的是根据系统的外部输出或可观察信号来理解、测量和分析系统内部状态和行为的能力。

*第十四章*，*效率和性能*，讲述了 Go 代码的基准测试、理解 Go 内存模型以及消除内存泄漏。本章还包括开发一个 eBPF 实用工具——eBPF 已成为提高现代 Linux 系统中可观察性、安全性和性能的基础技术。

*第十五章*，*近期 Go 版本的变化*，讲述了最新 Go 版本中的语言变化、新增功能和改进，这将帮助你了解 Go 语言是如何随时间演变的。

*附录*，*Go 垃圾回收器*，讲述了 Go 垃圾回收器的操作，并说明了这个 Go 组件如何影响你的代码性能。

# 为了充分利用这本书

这本书需要一台装有相对较新 Go 版本的现代计算机，包括运行 Mac OS X、macOS 或 Linux 的任何机器，以及熟悉你的操作系统、其文件系统和`git(1)`。大部分展示的代码在 Microsoft Windows 机器上也能运行，无需任何更改。

当您开始踏上掌握 Go 语言的旅程时，我鼓励您进行实验、提问并积极与材料互动。Go 编程语言提供了简单与强大的清新结合，我确信这本书将为您提供成为熟练 Go 开发人员所需的知识和技能。

## 下载示例代码文件

本书代码包托管在 GitHub 上，网址为[`github.com/mactsouk/mGo4th`](https://github.com/mactsouk/mGo4th)。我们还有其他来自我们丰富图书和视频目录的代码包可供下载，网址为[`github.com/PacktPublishing/`](https://github.com/PacktPublishing/)。请查看它们！

## 下载彩色图像

我们还提供了一份包含本书中使用的截图/图表彩色图像的 PDF 文件。您可以从这里下载：[`packt.link/gbp/9781805127147`](https://packt.link/gbp/9781805127147)。

## 使用的约定

本书中使用了多种文本约定。

`CodeInText`：表示文本中的代码单词、数据库表名、文件夹名、文件名、文件扩展名、路径名、虚拟 URL、用户输入和 Twitter 昵称。例如：“将下载的`WebStorm-10*.dmg`磁盘映像文件作为系统中的另一个磁盘挂载”。

代码块设置如下：

```go
package main
import "fmt"
func doubleSquare(x int) (int, int) {
    return x * 2, x * x
} 
```

当我们希望您注意代码块中的特定部分时，相关的行或项目将以粗体显示：

```go
fmt.Println("Double of", n, "is", d)
fmt.Println("Square of", n, "is", s)
**anF :=** **func****(param** **int****)****int** **{**
return param * param
} 
```

任何命令行输入或输出都按以下方式编写：

```go
$ go run namedReturn.go 1 -2
-2 1
-2 1 
```

**粗体**：表示新术语、重要单词或重要信息。例如，菜单或对话框中的单词在文本中显示如下。例如：“`wordByWord()`函数使用**正则表达式**来分隔输入文件每一行中找到的单词”。

警告或重要注意事项如下所示。

技巧和窍门如下所示。

# 联系我们

欢迎读者反馈。

**一般反馈**：请发送电子邮件至`feedback@packtpub.com`，并在邮件主题中提及书籍的标题。如果您对本书的任何方面有疑问，请通过`questions@packtpub.com`发送电子邮件给我们。

**勘误**：尽管我们已经尽一切努力确保内容的准确性，但错误仍然可能发生。如果您在本书中发现错误，我们将不胜感激，如果您能向我们报告，请访问[`www.packtpub.com/submit-errata`](http://www.packtpub.com/submit-errata)，点击**提交勘误**，并填写表格。

**盗版**：如果您在互联网上以任何形式发现我们作品的非法副本，如果您能提供位置地址或网站名称，我们将不胜感激。请通过`copyright@packtpub.com`与我们联系，并提供材料的链接。

**如果您想成为一名作者**：如果您在某个领域有专业知识，并且对撰写或参与一本书籍感兴趣，请访问[`authors.packtpub.com`](http://authors.packtpub.com)。

# 分享您的想法

读完《精通 Go，第四版》后，我们非常乐意听到您的想法！请[点击此处直接进入亚马逊评论](https://packt.link/r/1805127144)页面，分享您的反馈。

您的评论对我们和科技社区非常重要，并将帮助我们确保我们提供高质量的内容。

# 下载此书的免费 PDF 副本

感谢您购买此书！

您喜欢在路上阅读，但无法随身携带您的印刷书籍吗？

您的电子书购买是否与您选择的设备不兼容？

别担心，现在，每购买一本 Packt 书籍，您都可以免费获得该书的 DRM 免费 PDF 版本。

在任何地方、任何设备上阅读。直接从您最喜欢的技术书籍中搜索、复制和粘贴代码到您的应用程序中。

优惠远不止于此，您还可以获得独家折扣、时事通讯和丰富的免费内容，每天直接发送到您的收件箱。

按照以下简单步骤获取福利：

1.  扫描下面的二维码或访问以下链接

![二维码描述自动生成](img/Free_PDFQR.png)

[`packt.link/free-ebook/9781805127147`](https://packt.link/free-ebook/9781805127147)

1.  提交您的购买证明

1.  就这样！我们将直接将您的免费 PDF 和其他福利发送到您的邮箱
