<html><head></head><body>
<div class="book" title="Deferring function calls" id="1565U1-9c484ed022e64a0fb0e1aebf8e05d4fd">
<div class="book" title="Using defer"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_1"><a id="ch05lvl2sec91" class="calibre1"/>Using defer</h2></div></div></div><p class="calibre10">The <code class="email">defer</code> keyword modifies the execution flow of a program by delaying function calls. One idiomatic usage for this feature is to do a resource cleanup. Since defer will always get executed when the surrounding function returns, it is a good place to attach cleanup code such as:</p><div class="book"><ul class="itemizedlist"><li class="listitem">Closing open files</li><li class="listitem">Releasing network resources</li><li class="listitem">Closing the Go channel</li><li class="listitem">Committing database transactions</li><li class="listitem">And do on</li></ul></div><p class="calibre10">To illustrate, let us return to our anagram example from earlier. The following code snippet shows a version of the code where defer is used to close the file after it has been loaded. The <code class="email">load</code> function calls <code class="email">file.Close()</code> right before it returns:</p><pre class="programlisting">func load(fname string) ([]string, error) { 
... 
   file, err := os.Open(fname) 
   if err != nil { 
         return nil, err 
   } 
   defer file.Close() 
... 
} 
</pre><p class="calibre10">golang.fyi/ch05/anagram2.go</p><p class="calibre10">The pattern of opening-defer-closing resources is widely used in Go. By placing the deferred intent immediately after opening or creating a resource allows the code to read naturally and reduces the likeliness of creating a resource leakage.</p></div></div></body></html>