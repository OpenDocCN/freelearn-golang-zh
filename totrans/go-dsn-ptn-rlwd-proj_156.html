<html><head></head><body>
<div id="page" style="height:0pt"/><div class="book" title="Creating programs" id="1DOR01-9c484ed022e64a0fb0e1aebf8e05d4fd"><div class="book"><div class="book"><div class="book"><h1 class="title" id="calibre_pb_0"><a id="ch06lvl1sec44" class="calibre1"/>Creating programs</h1></div></div></div><p class="calibre10">So far in the book, you have learned how to create and bundle Go code as reusable packages. A package, however, cannot be executed as a standalone program. To create a program (also known as a command), you take a package and define an entry point of execution as follows:</p><div class="book"><ul class="itemizedlist"><li class="listitem">Declare (at least one) source file to be part of a special package called <code class="email">main</code></li><li class="listitem">Declare one function name <code class="email">main()</code> to be used as the entry point of the program</li></ul></div><p class="calibre10">The function <code class="email">main</code> takes no argument nor returns any value. The following shows the abbreviated source code for the <code class="email">main</code> package used in the Ohm's Law example (from earlier). It uses the package <code class="email">flag</code>, from Go's standard library, to parse program arguments formatted as <code class="email">flag</code>:</p><pre class="programlisting">package main 
import ( 
   "flag" 
   "fmt" 
   "os" 
 
   "github.com/vladimirvivien/learning-go/ch06/current" 
   "github.com/vladimirvivien/learning-go/ch06/power" 
   "github.com/vladimirvivien/learning-go/ch06/power/ir" 
   "github.com/vladimirvivien/learning-go/ch06/power/vr" 
   res "github.com/vladimirvivien/learning-go/ch06/resistor" 
   "github.com/vladimirvivien/learning-go/ch06/volt" 
) 
 
var ( 
   op string 
   v float64 
   r float64 
   i float64 
   p float64 
 
   usage = "Usage: ./circ &lt;command&gt; [arguments]\n" + 
     "Valid command { V | Vpi | R | Rvp | I | Ivp |"+  
    "P | Pir | Pvr }" 
) 
 
func init() { 
   flag.Float64Var(&amp;v, "v", 0.0, "Voltage value (volt)") 
   flag.Float64Var(&amp;r, "r", 0.0, "Resistance value (ohms)") 
   flag.Float64Var(&amp;i, "i", 0.0, "Current value (amp)") 
   flag.Float64Var(&amp;p, "p", 0.0, "Electrical power (watt)") 
   flag.StringVar(&amp;op, "op", "V", "Command - one of { V | Vpi |"+   
    " R | Rvp | I | Ivp | P | Pir | Pvr }") 
} 
 
func main() { 
   flag.Parse() 
   // execute operation 
   switch op { 
   case "V", "v": 
    val := volt.V(i, r) 
    fmt.Printf("V = %0.2f * %0.2f = %0.2f volts\n", i, r, val) 
   case "Vpi", "vpi": 
   val := volt.Vpi(p, i) 
    fmt.Printf("Vpi = %0.2f / %0.2f = %0.2f volts\n", p, i, val) 
   case "R", "r": 
   val := res.R(v, i)) 
    fmt.Printf("R = %0.2f / %0.2f = %0.2f Ohms\n", v, i, val) 
   case "I", "i": 
   val := current.I(v, r)) 
    fmt.Printf("I = %0.2f / %0.2f = %0.2f amps\n", v, r, val) 
   ... 
   default: 
         fmt.Println(usage) 
         os.Exit(1) 
   } 
} 
</pre><p class="calibre10">golang.fyi/ch06/main.go</p><p class="calibre10">The previous listing shows the source code of the <code class="email">main</code> package and the implementation of the function <code class="email">main</code> which gets executed when the program runs. The Ohm's Law program accepts command-line arguments that specify which electrical operation to execute (see the following <span class="strong"><em class="calibre11">Accessing program arguments </em></span>section). The function <code class="email">init</code> is used to initialize parsing of the program flag values. The function main is set up as a big switch statement block to select the proper operation to execute based on the selected flags.</p></div></body></html>