<html><head></head><body>
<div class="book" title="Channels">
<div class="book" title="Closing a channel"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_6"><a id="ch09lvl2sec155" class="calibre1"/>Closing a channel</h2></div></div></div><p class="calibre10">Once a channel is initialized it is ready for send and receive operations. A channel will remain in that open state until it is forcibly closed using the built-in <span class="strong"><em class="calibre11">close</em></span> function, as shown in the following example:</p><pre class="programlisting">func main() { 
   ch := make(chan int, 4) 
   ch &lt;- 2 
   ch &lt;- 4 
   close(ch) 
   // ch &lt;- 6 // panic, send on closed channel 
 
   fmt.Println(&lt;-ch) 
   fmt.Println(&lt;-ch) 
   fmt.Println(&lt;-ch) // closed, returns zero value for element 
 
} 
</pre><p class="calibre10">golang.fyi/ch09/chan2.go</p><p class="calibre10">Once a channel is closed, it has the following properties:</p><div class="book"><ul class="itemizedlist"><li class="listitem">Subsequent send operations will cause a program to panic</li><li class="listitem">Receive operations never block (regardless of whether buffered or unbuffered)</li><li class="listitem">All receive operations return the zero value of the channel's element type</li></ul></div><p class="calibre10">In the previous snippet, the <code class="email">ch</code> channel is closed after two send operations. As indicated in the comment, a third send operation would cause a panic because the channel is closed. On the receiving side, the code gets the two elements in the channel before it is closed. A third receive operation returns <code class="email">0</code>, the zero value for the channel's elements.</p><p class="calibre10">Go offers a long form of the receive operation that returns the value read from the channel followed by a Boolean indicating the closed status of the channel. This can be used to properly handle the zero value from a closed channel, as shown in the following example:</p><pre class="programlisting">func main() { 
   ch := make(chan int, 4) 
   ch &lt;- 2 
   ch &lt;- 4 
   close(ch) 
 
   for i := 0; i &lt; 4; i++ { 
         if <span class="strong"><strong class="calibre2">val, opened := &lt;-ch;</strong></span> opened { 
               fmt.Println(val) 
         } else { 
               fmt.Println("Channel closed!") 
         } 
   } 
} 
</pre><p class="calibre10">golang.fyi/ch09/chan3.go</p></div></div></body></html>