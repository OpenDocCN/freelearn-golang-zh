<html><head></head><body>
<div class="book" title="Working with files" id="24L8G1-9c484ed022e64a0fb0e1aebf8e05d4fd">
<div class="book" title="Files writing and reading"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_3"><a id="ch10lvl2sec168" class="calibre1"/>Files writing and reading</h2></div></div></div><p class="calibre10">We have already seen how to use the <code class="email">os.Copy</code> function to move data into or out of a file. Sometimes, however, it will be necessary to have complete control over the logic that writes or reads file data. The following code snippet, for instance, uses the <code class="email">WriteString</code> method from the <code class="email">os.File</code> variable, <code class="email">fout,</code> to create a text file:</p><pre class="programlisting">func main() { 
   rows := []string{ 
         "The quick brown fox", 
         "jumps over the lazy dog", 
   } 
 
   fout, err := os.Create("./filewrite.data") 
   if err != nil { 
         fmt.Println(err) 
         os.Exit(1) 
   } 
   defer fout.Close() 
 
   for _, row := range rows { 
         fout.WriteString(row) 
   } 
} 
</pre><p class="calibre10">golang.fyi/ch10/filewrite0.go</p><p class="calibre10">If, however, the source of your data is not text, you can write raw bytes directly to the file as shown in the following source snippet:</p><pre class="programlisting">func main() { 
   data := [][]byte{ 
         []byte("The quick brown fox\n"), 
         []byte("jumps over the lazy dog\n"), 
   } 
   fout, err := os.Create("./filewrite.data") 
   if err != nil { ... } 
   defer fout.Close() 
 
   for _, out := range data { 
         fout.Write(out) 
   } 
} 
</pre><p class="calibre10">golang.fyi/ch10/filewrite0.go</p><p class="calibre10">As an <code class="email">io.Reader</code>, reading from of the <code class="email">io.File</code> type directly can be done using the <span class="strong"><em class="calibre11">Read </em></span>method. This gives access to the content of the file as a raw stream of byte slices. The following code snippet reads the content of file <code class="email">../ch0r/dict.txt</code> as raw bytes assigned to slice <code class="email">p</code> up to 1024-byte chunks at a time:</p><pre class="programlisting">func main() { 
   fin, err := os.Open("../ch05/dict.txt") 
   if err != nil { 
         fmt.Println(err) 
         os.Exit(1) 
   } 
   defer fin.Close() 
   p := make([]byte, 1024) 
   for { 
         n, err := fin.Read(p) 
         if err == io.EOF { 
               break 
         } 
         fmt.Print(string(p[:n])) 
   } 
} 
</pre><p class="calibre10">golang.fyi/ch10/fileread.go</p></div></div></body></html>