<html><head></head><body>
<div class="book" title="Buffered IO" id="26I9K1-9c484ed022e64a0fb0e1aebf8e05d4fd">
<div class="book" title="Buffered writers and readers"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_1"><a id="ch10lvl3sec10" class="calibre1"/>Buffered writers and readers</h2></div></div></div><p class="calibre10">The <code class="email">bufio</code> package offers several functions to do buffered writing of IO streams using an <code class="email">io.Writer</code> interface. The following snippet creates a text file and writes to it using buffered IO:</p><pre class="programlisting">func main() { 
   rows := []string{ 
         "The quick brown fox", 
         "jumps over the lazy dog", 
   } 
 
   fout, err := os.Create("./filewrite.data") 
   writer := bufio.NewWriter(fout) 
   if err != nil { 
         fmt.Println(err) 
         os.Exit(1) 
   } 
   defer fout.Close() 
 
   for _, row := range rows { 
         writer.WriteString(row) 
   } 
   writer.Flush() 
} 
</pre><p class="calibre10">golang.fyi/ch10/bufwrite0.go</p><p class="calibre10">In general, the constructor functions in the <code class="email">bufio</code> package create a buffered writer by wrapping an existing <code class="email">io.Writer</code> as its underlying source. For instance, the previous code creates a buffered writer using the <code class="email">bufio.NewWriter</code> function by wrapping the io.File variable, <code class="email">fout</code>.</p><p class="calibre10">To influence the size of the internal buffer, use the constructor function <code class="email">bufio.NewWriterSize(w io.Writer, n int)</code> to specify the internal buffer size. The <code class="email">bufio.Writer</code> type also offers the methods <code class="email">Write</code> and <code class="email">WriteByte</code> for writing raw bytes and <code class="email">WriteRune</code> for writing Unicode-encoded characters.</p><p class="calibre10">Reading buffered streams can be done simply by calling the constructor function <span class="strong"><em class="calibre11">bufio.NewReader</em></span> to wrap an existing <code class="email">io.Reader</code>. The following code snippet creates a <code class="email">bufio.Reader</code> variable <code class="email">reader</code> by wrapping the <code class="email">file</code> variable as its underlying source:</p><pre class="programlisting">func main() { 
   file, err := os.Open("./bufread0.go") 
   if err != nil { 
         fmt.Println("Unable to open file:", err) 
         return 
   } 
   defer file.Close() 
 
   reader := bufio.NewReader(file) 
   for { 
         line, err := reader.ReadString('\n') 
         if err != nil { 
               if err == io.EOF { 
                     break 
               } else { 
                     fmt.Println("Error reading:, err") 
                     return 
               } 
         } 
         fmt.Print(line) 
   } 
} 
</pre><p class="calibre10">golang<code class="email">.fyi/ch10/bufread0.go</code></p><p class="calibre10">The previous code uses the <code class="email">reader.ReadString</code> method to read a text file using the <code class="email">'\n'</code> character as the content delimiter. To influence the size of the internal buffer, use the constructor function <code class="email">bufio.NewReaderSize(w io.Reader, n int)</code> to specify the internal buffer size. The <code class="email">bufio.Reader</code> type also offers the <span class="strong"><em class="calibre11">Read</em></span>, <span class="strong"><em class="calibre11">ReadByte</em></span>, and <span class="strong"><em class="calibre11">ReadBytes</em></span> methods for reading raw bytes from a stream and the <span class="strong"><em class="calibre11">ReadRune</em></span> method for reading Unicode-encoded characters.</p></div></div></body></html>