<html><head></head><body>
<div class="book" title="Chapter&#xA0;11.&#xA0;Writing Networked Services">
<div class="book" title="The net package">
<div class="book" title="Dialing a connection"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_4"><a id="ch11lvl2sec181" class="calibre1"/>Dialing a connection</h2></div></div></div><p class="calibre10">Client programs use the <code class="email">net.Dial</code> function, which has the following signature, to connect to a host service over the network:</p><pre class="programlisting">func Dial(network, address string) (Conn, error) 
</pre><p class="calibre10">The function takes two parameters where the first parameter, <span class="strong"><em class="calibre11">network</em></span>, specifies the network protocol for the connection which can be:</p><div class="book"><ul class="itemizedlist"><li class="listitem"><code class="email">tcp</code>, <code class="email">tcp4</code>, <code class="email">tcp6</code> : <code class="email">tcp</code> defaults to <code class="email">tcp4</code></li><li class="listitem"><code class="email">udp</code>, <code class="email">udp4</code>, <code class="email">udp6</code>: <code class="email">udp</code> defaults to <code class="email">udp4</code></li><li class="listitem"><code class="email">ip</code>, <code class="email">ip4</code>, <code class="email">ip6</code>: <code class="email">ip</code> defaults to <code class="email">ip4</code></li><li class="listitem"><code class="email">unix</code>, <code class="email">unixgram</code>, <code class="email">unixpacket</code>: for Unix domain sockets</li></ul></div><p class="calibre10">The latter parameter of the <code class="email">net.Dial</code> function specifies a string value for the host address to which to connect. The address can be provided as IPv4 or IPv6 addresses as discussed earlier. The <code class="email">net.Dial</code> function returns an implementation of the <code class="email">net.Conn</code> interface that matches the specified network parameter.</p><p class="calibre10">For instance, the following code snippet dials a <code class="email">"tcp"</code> network at the host address, <a class="calibre1" href="http://gutenberg.org/">www.gutenberg.org:80</a>, which returns a TCP connection of the <code class="email">*net.TCPConn</code> type. The abbreviated code uses the TCP connection to issue an <code class="email">"HTTP GET"</code> request to retrieve the full text of the literary classic Beowulf from the Project Gutenberg's website (<a class="calibre1" href="http://gutenberg.org/">http://gutenberg.org/</a>). The raw and unparsed HTTP response is subsequently written to a local file, <code class="email">beowulf.txt</code>:</p><pre class="programlisting">func main() { 
   host, port := "www.gutenberg.org", "80" 
   addr := net.JoinHostPort(host, port) 
   httpRequest:="GET  /cache/epub/16328/pg16328.txt HTTP/1.1\n" + 
         "Host: " + host + "\n\n" 
 
   conn, err := net.Dial("tcp", addr) 
   if err != nil { 
         fmt.Println(err) 
         return 
   } 
   defer conn.Close() 
 
   if _, err = conn.Write([]byte(httpRequest)); err != nil { 
         fmt.Println(err) 
         return 
   } 
 
   file, err := os.Create("beowulf.txt") 
   if err != nil { 
         fmt.Println(err) 
         return 
   } 
   defer file.Close() 
 
   io.Copy(file, conn) 
   fmt.Println("Text copied to file", file.Name()) 
<span class="strong"><strong class="calibre2">}</strong></span>
</pre><p class="calibre10">golang.fyi/ch11/dial0.go</p><p class="calibre10">Because the <code class="email">net.Conn</code> type implements the <code class="email">io.Reader</code> and <code class="email">io.Writer</code>, it can be used to both send data and receive data using streaming IO semantics. In the preceding example, <code class="email">conn.Write([]byte(httpRequest))</code> sends the HTTP request to the server. The response returned by the host is copied from the <code class="email">conn</code> variable to the <code class="email">file</code> variable using <code class="email">io.Copy(file, conn)</code>.</p><div class="informaltable" title="Note"><h3 class="title2"><a id="note26" class="calibre1"/>Note</h3><p class="calibre10">Note that the previous is an illustration that shows how to connect to an HTTP server using raw TCP. The Go standard library provides a separate package designed specifically for HTTP programming which abstracts away the low-level protocol details (covered later in the chapter).</p></div><p class="calibre10">The <code class="email">net</code> package also makes available network specific dialing functions such as <code class="email">DialUDP</code>, <code class="email">DiapTCP</code>, or <code class="email">DialIP</code>, each returning its respective connection implementation. In most cases, the <code class="email">net.Dial</code> function and the <code class="email">net.Conn</code> interface provide adequate capabilities to connect and manage connections to a remote host.</p></div></div></div></body></html>