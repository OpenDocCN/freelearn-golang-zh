- en: Handling client requests and responses
  id: totrans-0
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 处理客户端请求和响应
- en: '[PRE0]'
  id: totrans-1
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: '[PRE1]'
  id: totrans-2
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: golang.fyi/ch11/httpclient3.go
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: golang.fyi/ch11/httpclient3.go
- en: 'The `http.NewRequest` function has the following signature:'
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: '`http.NewRequest` 函数具有以下签名：'
- en: '[PRE2]'
  id: totrans-5
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: '[PRE3]'
  id: totrans-6
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: The method accepts a pointer to an `http.Request` value, as discussed in the
    previous section. It then returns a pointer to an `http.Response` value or an
    error if the request fails. In the previous source code, `resp, err := client.Do(req)`
    is used to send the request to the server and assigns the response to the `resp`
    variable.
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: 该方法接受一个指向 `http.Request` 值的指针，如前文所述。然后它返回一个指向 `http.Response` 值的指针或一个错误（如果请求失败）。在前面的源代码中，使用
    `resp, err := client.Do(req)` 来向服务器发送请求，并将响应赋值给 `resp` 变量。
- en: The response from the server is encapsulated in struct `http.Response` which
    contains several fields to describe the response including the HTTP response status,
    content length, headers, and the response body. The response body, exposed as
    the `http.Response.Body` field, implements the `io.Reader` which affords the use
    streaming IO primitives to consume the response content.
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: 服务器响应被封装在结构体 `http.Response` 中，该结构体包含多个字段来描述响应，包括 HTTP 响应状态、内容长度、头部和响应体。响应体作为
    `http.Response.Body` 字段暴露，实现了 `io.Reader` 接口，这使得可以使用流式 IO 原语来消费响应内容。
- en: The `Body` field also implements `*io.Closer*` which allows the closing of IO
    resources. The previous source uses `defer resp.Body.Close()` to close the IO
    resource associated with the response body. This is a recommended idiom when the
    server is expected to return a non-nil body.
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: '`Body` 字段也实现了 `*io.Closer*` 接口，这允许关闭 IO 资源。在先前的源代码中，使用 `defer resp.Body.Close()`
    来关闭与响应体相关的 IO 资源。当预期服务器返回非空体时，这是一个推荐的惯用用法。'
