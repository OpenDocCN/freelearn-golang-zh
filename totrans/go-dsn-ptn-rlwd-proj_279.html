<html><head></head><body>
<div class="book" title="The HTTP package">
<div class="book" title="Routing requests with http.ServeMux"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_5"><a id="ch11lvl2sec190" class="calibre1"/>Routing requests with http.ServeMux</h2></div></div></div><p class="calibre10">The <code class="email">http.Handler</code> implementation introduced in the previous section is not sophisticated. No matter what URL path is sent with the request, it sends the same response back to the client. That is not very useful. In most cases, you want to map each path of a request URL to a different response.</p><p class="calibre10">Fortunately, the HTTP package comes with the <code class="email">http.ServeMux</code> type which can multiplex incoming requests based on URL patterns. When an <code class="email">http.ServeMux</code> handler receives a request, associated with a URL path, it dispatches a function that is mapped to that URL. The following abbreviated code snippet shows <code class="email">http.ServeMux</code> variable <code class="email">mux</code> configured to handle two URL paths <code class="email">"/hello"</code> and <code class="email">"/goodbye"</code>:</p><pre class="programlisting">func main() { 
   mux := http.NewServeMux() 
   hello := func(resp http.ResponseWriter, req *http.Request) { 
         resp.Header().Add("Content-Type", "text/html") 
         resp.WriteHeader(http.StatusOK) 
         fmt.Fprint(resp, "Hello from Above!") 
   } 
 
   goodbye := func(resp http.ResponseWriter, req *http.Request) { 
         resp.Header().Add("Content-Type", "text/html") 
         resp.WriteHeader(http.StatusOK) 
         fmt.Fprint(resp, "Goodbye, it's been real!") 
   } 
 
   mux.HandleFunc("/hello", hello) 
   mux.HandleFunc("/goodbye", goodbye) 
 
   http.ListenAndServe(":4040", mux) 
} 
</pre><p class="calibre10">golang.fyi/ch11/httpserv3.go</p><p class="calibre10">The code declares two functions assigned to variables <code class="email">hello</code> and <code class="email">goodbye</code>. Each function is mapped to a path <code class="email">"/hello"</code> and <code class="email">"/goodbye"</code> respectively using the <code class="email">mux.HandleFunc("/hello", hello)</code> and <code class="email">mux.HandleFunc("/goodbye", goodbye)</code> method calls. When the server is launched, with <code class="email">http.ListenAndServe(":4040", mux)</code>, its handler will route the request <code class="email">"http://localhost:4040/hello"</code> to the <code class="email">hello</code> function and requests with the path <code class="email">"http://localhost:4040/goodbye"</code> to the <code class="email">goodbye </code>function.</p><div class="book" title="The default ServeMux"><div class="book"><div class="book"><div class="book"><h3 class="title2"><a id="ch11lvl3sec12" class="calibre1"/>The default ServeMux</h3></div></div></div><p class="calibre10">It is worth pointing out that the HTTP package makes available a default ServeMux internally. When used, it is not necessary to explicitly declare a ServeMux variable. Instead the code uses the package function, <code class="email">http.HandleFunc,</code> to map a path to a handler function as illustrated in the following code snippet:</p><pre class="programlisting">func main() { 
   hello := func(resp http.ResponseWriter, req *http.Request) { 
   ... 
   } 
 
   goodbye := func(resp http.ResponseWriter, req *http.Request) { 
   ... 
   } 
 
   http.HandleFunc("/hello", hello) 
   http.HandleFunc("/goodbye", goodbye) 
 
   http.ListenAndServe(":4040", nil) 
<span class="strong"><strong class="calibre2">}</strong></span>
</pre><p class="calibre10">golang.fyi/ch11/httpserv4.go</p><p class="calibre10">To launch the server, the code calls <code class="email">http.ListenAndServe(":4040", nil)</code> where the ServerMux parameter is set to <code class="email">nil</code>. This implies that the server will default to the per-declared package instance of http.ServeMux to handle incoming requests.</p></div></div></div></body></html>