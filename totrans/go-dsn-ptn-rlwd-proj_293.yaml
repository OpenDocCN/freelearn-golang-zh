- en: Reporting failure
  id: totrans-0
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 报告失败
- en: 'By default, the Go test runtime considers a test a success if the test function
    runs and returns normally without a panic. For example, the following test function
    is broken, since its expected value is not properly calculated. The test runtime,
    however, will always report it as passing because it does not include any code
    to report the failure:'
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 默认情况下，Go 测试运行时认为如果测试函数正常运行并返回，而没有发生恐慌，则测试成功。例如，以下测试函数是损坏的，因为它的预期值没有正确计算。然而，测试运行时总是会报告它通过，因为它没有包含任何报告失败的代码：
- en: '[PRE0]'
  id: totrans-2
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: golang.fyi/ch12/vec_test.go
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: golang.fyi/ch12/vec_test.go
- en: 'This false positive condition may go unnoticed, especially if the verbose flag
    is turned off, minimizing any visual clues that it is broken:'
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: 这种假阳性条件可能会被忽略，尤其是在详细模式标志被关闭的情况下，最小化了任何表明它已损坏的视觉线索：
- en: '[PRE1]'
  id: totrans-5
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: 'One way the previous test can be fixed is by using the `Fail` method from type
    `testing.T` to signal failure, as shown in the following snippet:'
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: 修复前面测试的一种方法是通过使用 `testing.T` 类型的 `Fail` 方法来表示失败，如下面的代码片段所示：
- en: '[PRE2]'
  id: totrans-7
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: 'So now, when the test is executed, it correctly reports that it is broken,
    as shown in the following output:'
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，现在当测试执行时，它正确地报告了它已损坏，如下面的输出所示：
- en: '[PRE3]'
  id: totrans-9
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: '[PRE4]'
  id: totrans-10
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: golang.fyi/ch12/vector/vec.go
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: golang.fyi/ch12/vector/vec.go
- en: Type `testing.T` also offers `Fatal` and `Formatf` methods as a way of combining
    the logging of a message and the immediate termination of a test function.
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 使用 `testing.T` 类型还提供了 `Fatal` 和 `Formatf` 方法，作为将消息记录和立即终止测试函数的一种方式。
