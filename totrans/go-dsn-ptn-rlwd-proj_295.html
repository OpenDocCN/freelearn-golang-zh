<html><head></head><body>
<div class="book" title="Writing Go tests">
<div class="book" title="Table-driven tests"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_6"><a id="ch12lvl2sec201" class="calibre1"/>Table-driven tests</h2></div></div></div><p class="calibre10">One technique you often encounter in Go is the use of table-driven tests. This is where a set of input and expected output is stored in a data structure, which is then used to cycle through different test scenarios. For instance, in the following test function, the <code class="email">cases</code> variable, of type <code class="email">[]struct{vec SimpleVector; expected float64}</code>, to store several vector values and their expected magnitude values used to test the vector method <code class="email">Mag</code>:</p><pre class="programlisting">func TestVectorMag(t *testing.T) { 
   cases := []struct{ 
         vec SimpleVector 
         expected float64 
 
   }{ 
       {New(1.2, 3.4), math.Sqrt(1.2*1.2 + 3.4*3.4)}, 
       {New(-0.21, 7.47), math.Sqrt(-0.21*-0.21 + 7.47*7.47)}, 
       {New(1.43, -5.40), math.Sqrt(1.43*1.43 + -5.40*-5.40)}, 
       {New(-2.07, -9.0), math.Sqrt(-2.07*-2.07 + -9.0*-9.0)}, 
   } 
   for _, c := range cases { 
       mag := c.vec.Mag() 
       if mag != c.expected { 
         t.Errorf("Magnitude failed, execpted %d, got %d",  
              c.expected, mag) 
       } 
   } 
} 
</pre><p class="calibre10">golang.fyi/ch12/vector/vec.go</p><p class="calibre10">With each iteration of the loop, the code tests the value calculated by the <code class="email">Mag</code> method against an expected value. Using this approach, we can test several combinations of input and their respective output, as is done in the preceding code. This technique can be expanded as necessary to include more parameters. For instance, a name field can be used to name each case, which is useful when the number of test cases is large. Or, to be even more fancy, one can include a function field in the test case struct to specify custom logic to use for each respective case.</p></div></div></body></html>