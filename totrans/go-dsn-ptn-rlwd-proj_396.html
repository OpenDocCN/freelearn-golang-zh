<html><head></head><body>
<div class="book" title="Prototype design pattern">
<div class="book" title="Implementation"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_6"><a id="ch02lvl2sec064" class="calibre1"/>Implementation</h2></div></div></div><p class="calibre10">We will start with the <code class="email">GetClone</code> method. This method should return an item of the specified type and we have three type: white, black and blue:</p><pre class="programlisting">var whitePrototype *Shirt = &amp;Shirt{ 
    Price: 15.00, 
    SKU:   "empty", 
    Color: White, 
} 
 
var blackPrototype *Shirt = &amp;Shirt{ 
    Price: 16.00, 
    SKU:   "empty", 
    Color: Black, 
} 
 
var bluePrototype *Shirt = &amp;Shirt{ 
    Price: 17.00, 
    SKU:   "empty", 
    Color: Blue, 
} 
</pre><p class="calibre10">So now that we have the three prototypes to work over we can implement <code class="email">GetClone(s int)</code> method:</p><pre class="programlisting">type ShirtsCache struct {} 
func (s *ShirtsCache)GetClone(s int) (ItemInfoGetter, error) { 
    switch m { 
        case White: 
            newItem := *whitePrototype 
            return &amp;newItem, nil 
        case Black: 
            newItem := *blackPrototype 
            return &amp;newItem, nil 
        case Blue: 
            newItem := *bluePrototype 
            return &amp;newItem, nil 
        default: 
            return nil, errors.New("Shirt model not recognized") 
    } 
} 
</pre><p class="calibre10">The <code class="email">Shirt</code> structure also needs a <code class="email">GetInfo</code> implementation to print the contents of the instances.</p><pre class="programlisting">type ShirtColor byte 
 
type Shirt struct { 
    Price float32 
    SKU   string 
    Color ShirtColor 
} 

func (s *Shirt) GetInfo() string { 
    return fmt.Sprintf("Shirt with SKU '%s' and Color id %d that costs %f\n", s.SKU, s.Color, s.Price) 
} 
</pre><p class="calibre10">Finally, let's run the tests to see that everything is now working:</p><pre class="programlisting">
<span class="strong"><strong class="calibre2">go test -run=TestClone -v . 
=== RUN   TestClone 
--- PASS: TestClone (0.00s) 
prototype_test.go:41: LOG: Shirt with SKU 'abbcc' and Color id 1 that costs 15.000000 
prototype_test.go:42: LOG: Shirt with SKU 'empty' and Color id 1 that costs 15.000000 
prototype_test.go:44: LOG: The memory positions of the shirts are different 0xc42002c038 != 0xc42002c040  
 
PASS 
ok</strong></span>
</pre><p class="calibre10">In the log, (remember to set the <code class="email">-v</code> flag when running the tests) you can check that <code class="email">shirt1</code> and <code class="email">shirt2</code> have different SKUs. Also, we can see the memory positions of both objects. Take into account that the positions shown on your computer will probably be different.</p></div></div></body></html>