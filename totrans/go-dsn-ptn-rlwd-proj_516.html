<html><head></head><body>
<div class="book" title="Interpreter design pattern">
<div class="book" title="Unit test of some operations"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_5"><a id="ch06lvl2sec0163" class="calibre1"/>Unit test of some operations</h2></div></div></div><p class="calibre10">In this case, we will only have a public method called <code class="email">Calculate</code> that takes an operation with its values defined as a string and will return a value or an error:</p><pre class="programlisting">func Calculate(o string) (int, error) { 
  return 0, fmt.Errorf("Not implemented yet") 
} 
</pre><p class="calibre10">So, we will send a string like <code class="email">"3 4 +"</code> to the <code class="email">Calculate</code> method and it should return <span class="strong"><em class="calibre11">7, nil</em></span>. Two tests more will check the correct implementation:</p><pre class="programlisting">func TestCalculate(t *testing.T) { 
  tempOperation = "3 4 sum 2 sub" 
  res, err = Calculate(tempOperation) 
  if err != nil { 
    t.Error(err) 
  } 
 
  if res != 5 { 
    t.Errorf("Expected result not found: %d != %d\n", 5, res) 
  } 
</pre><p class="calibre10">First, we are going to make the operation we have used as an example. The <code class="email">3 4 sum 2 sub</code> notation is part of our language and we use it in the <code class="email">Calculate</code> function. If an error is returned, the test fails. Finally, the result must be equal to <code class="email">5</code> and we check it on the last lines. The next test checks the rest of the operators on slightly more complex operations:</p><pre class="programlisting">  tempOperation := "5 3 sub 8 mul 4 sum 5 div" 
  res, err := Calculate(tempOperation) 
  if err != nil { 
    t.Error(err) 
  } 
 
  if res != 4 { 
    t.Errorf("Expected result not found: %d != %d\n", 4, res) 
  } 
} 
</pre><p class="calibre10">Here, we repeated the preceding process with a longer operation, the <span class="strong"><em class="calibre11">(((5 - 3) * 8) + 4) / 5</em></span> notation which is equal to <span class="strong"><em class="calibre11">4</em></span>. From left to right, it would be as follows:</p><pre class="programlisting">
<span class="strong"><strong class="calibre2">(((5 - 3) * 8) + 4) / 5</strong></span>
<span class="strong"><strong class="calibre2">  ((2 * 8) + 4) / 5</strong></span>
<span class="strong"><strong class="calibre2">    (16 + 4) / 5</strong></span>
<span class="strong"><strong class="calibre2">      20 / 5</strong></span>
<span class="strong"><strong class="calibre2">        4</strong></span>
</pre><p class="calibre10">The test must fail, of course!</p><pre class="programlisting">
<span class="strong"><strong class="calibre2">$ go test -v .</strong></span>
<span class="strong"><strong class="calibre2">  interpreter_test.go:9: Not implemented yet</strong></span>
<span class="strong"><strong class="calibre2">  interpreter_test.go:13: Expected result not found: 4 != 0</strong></span>
<span class="strong"><strong class="calibre2">  interpreter_test.go:19: Not implemented yet</strong></span>
<span class="strong"><strong class="calibre2">  interpreter_test.go:23: Expected result not found: 5 != 0</strong></span>
<span class="strong"><strong class="calibre2">exit status 1</strong></span>
<span class="strong"><strong class="calibre2">FAIL</strong></span>
</pre></div></div></body></html>