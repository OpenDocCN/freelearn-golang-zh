<html><head></head><body>
<div class="book" title="State design pattern">
<div class="book" title="A state to win and a state to lose"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_6"><a id="ch07lvl2sec0181" class="calibre1"/>A state to win and a state to lose</h2></div></div></div><p class="calibre10">Have you realized that we could have a winning and a lose state instead of printing the messages directly in the <code class="email">FinishState</code> struct? This way we could, for example, check some hypothetical scoreboard in the win section to see if we have set a record. Let's refactor our game. First we need a <code class="email">WinState</code> and a <code class="email">LoseState</code> struct:</p><pre class="programlisting">type WinState struct{} 
 
func (w *WinState) executeState(c *GameContext) bool { 
  println("Congrats, you won") 
 
  return false 
} 
 
type LoseState struct{} 
 
func (l *LoseState) executeState(c *GameContext) bool { 
  fmt.Printf("You lose. The correct number was: %d\n", c.SecretNumber) 
  return false 
} 
</pre><p class="calibre10">These two new states have nothing new. They contain the same messages that were previously in the <code class="email">FinishState</code> state that, by the way, must be modified to use these new states:</p><pre class="programlisting">func (f *FinishState) executeState(c *GameContext) bool { 
  if c.Won { 
    c.Next = &amp;WinState{} 
  } else { 
    c.Next = &amp;LoseState{} 
  } 
  return true 
} 
</pre><p class="calibre10">Now, the finish state doesn't print anything and, instead, delegates this to the next state in the chain--the <code class="email">WinState</code> structure, if the user has won and the <code class="email">LoseState</code> struct, if not. Remember that the game doesn't finish on the <code class="email">FinishState</code> struct now, and we must return <code class="email">true</code> instead of <code class="email">false</code> to notify to the engine that it must keep executing states in the chain.</p></div></div></body></html>