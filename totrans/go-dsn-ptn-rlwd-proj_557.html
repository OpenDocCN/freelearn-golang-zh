<html><head></head><body>
<div class="book" title="Chapter&#xA0;8.&#xA0;Introduction to Gos Concurrency" id="43JDK1-9c484ed022e64a0fb0e1aebf8e05d4fd">
<div class="book" title="A little bit of history and theory">
<div class="book" title="Concurrency versus parallelism"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_2"><a id="ch08lvl2sec0196" class="calibre1"/>Concurrency versus parallelism</h2></div></div></div><p class="calibre10">Many people have misunderstood the differences between both, even thinking that they are the same. There is a popular speech by Rob Pike, one of the creators of Go, <span class="strong"><em class="calibre11">Concurrency is not parallelism</em></span>, which I really agree with. As a quick summary of the talk, we can extract the following:</p><div class="book"><ul class="itemizedlist"><li class="listitem">Concurrency is about dealing with many things at once</li><li class="listitem">Parallelism is about doing many things at the same time</li></ul></div><p class="calibre10">Concurrency enables parallelism by designing a correct structure of concurrency work.</p><p class="calibre10">For example, we can think of the mechanism of a bike. When we pedal, we usually push down the pedal to produce force (and this push, raises our opposite leg on the opposite pedal). We cannot push with both legs at the same time because the cranks don't allow us to do it. But this design allows the construction of a parallel bike, commonly called a <span class="strong"><strong class="calibre2">tandem bike</strong></span>. A tandem bike is a bike that two people can ride at the same time; they both pedal and apply force to the bike.</p><p class="calibre10">In the bike example, concurrency is the design of a bike that, with two legs (Goroutines), you can produce power to move the bike by yourself. The design is concurrent and correct. If we use a tandem bike and two people (two cores), the solution is concurrent, correct, and parallel. But the key thing is that with a concurrent design, we don't have to worry about parallelism; we can think about it as an extra feature if our concurrent design is correct. In fact, we can use the tandem bike with only one person, but the concurrent design of the legs, pedals, chain, wheels of a bike is still correct.</p><p class="calibre10">
</p><div class="mediaobject"><img src="../images/00035.jpeg" alt="Concurrency versus parallelism" class="calibre14"/></div><p class="calibre15"> </p><p class="calibre10">
</p><p class="calibre10">With concurrency, on the left side, we have a design and a structure that is executed sequentially by the same CPU core. Once we have this design and structure, parallelism can be achieved by simply repeating this structure on a different thread.</p><p class="calibre10">This is how Go eases the reasoning about concurrent and parallel programs by simply not worrying too much about parallel execution and focusing much more on concurrent design and structure. Breaking a big task into smaller tasks that can be run concurrently usually provides much better performance in a single-core computer, but, if this design can also be run in parallel, we could achieve an even higher throughput (or not, depending on the design).</p><p class="calibre10">In fact, we can set the number of cores in use in a Go app by setting the environment variable <code class="email">GOMAXPROCS</code> to the number of cores we want. This is not only useful when using schedulers, such as <span class="strong"><strong class="calibre2">Apache Mesos</strong></span>, but it gives us more control about how a Go app works and performs.</p><p class="calibre10">So, to recap, it is very important to keep in mind that concurrency is about structure and parallelism is about execution. We must think about making our programs concurrent in a better way, by breaking them down into smaller pieces of work, and Go's scheduler will try to make them parallel if it's possible and allowed.</p></div></div></div></body></html>