<html><head></head><body>
<div class="book" title="Modeling a chat room and clients on the server">
<div class="book" title="Using helper functions to remove complexity"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_5"><a id="ch01lvl2sec0013" class="calibre1"/>Using helper functions to remove complexity</h2></div></div></div><p class="calibre10">Our room is almost ready to go, although in order for it to be of any use, the channels and map need to be created. As it is, this could be achieved by asking the developer to use the following code to be sure to do this:</p><pre class="programlisting">r := &amp;room{ 
  forward: make(chan []byte), 
  join:    make(chan *client), 
  leave:   make(chan *client), 
  clients: make(map[*client]bool), 
} 
</pre><p class="calibre10">Another, slightly more elegant, solution is to instead provide a <code class="email">newRoom</code> function that does this for us. This removes the need for others to know about exactly what needs to be done in order for our room to be useful. Underneath the <code class="email">type room struct</code> definition, add this function:</p><pre class="programlisting">// newRoom makes a new room. 
func newRoom() *room { 
  return &amp;room{ 
    forward: make(chan []byte), 
    join:    make(chan *client), 
    leave:   make(chan *client), 
    clients: make(map[*client]bool), 
  } 
} 
</pre><p class="calibre10">Now the users of our code need only call the <code class="email">newRoom</code> function instead of the more verbose six lines of code.</p></div></div></body></html>