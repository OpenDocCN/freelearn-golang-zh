<html><head></head><body>
<div class="book" title="Five simple programs">
<div class="book" title="Domainify"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_2"><a id="ch04lvl2sec0041" class="calibre1"/>Domainify</h2></div></div></div><p class="calibre10">Some of the words that output from Sprinkle contain spaces and perhaps other characters that are not allowed in domains. So we are going to write a program called Domainify; it converts a line of text into an acceptable domain segment and adds an appropriate <span class="strong"><strong class="calibre2">Top-level Domain</strong></span> (<span class="strong"><strong class="calibre2">TLD</strong></span>) to the end. Alongside the <code class="email">sprinkle</code> folder, create a new one called <code class="email">domainify</code> and add the <code class="email">main.go</code> file with the following code:</p><pre class="programlisting">package main 
var tlds = []string{"com", "net"} 
const allowedChars = "abcdefghijklmnopqrstuvwxyz0123456789_-" 
func main() { 
  rand.Seed(time.Now().UTC().UnixNano()) 
  s := bufio.NewScanner(os.Stdin) 
  for s.Scan() { 
    text := strings.ToLower(s.Text()) 
    var newText []rune 
    for _, r := range text { 
      if unicode.IsSpace(r) { 
        r = '-' 
      } 
      if !strings.ContainsRune(allowedChars, r) { 
        continue 
      } 
      newText = append(newText, r) 
    } 
    fmt.Println(string(newText) + "." +         
                tlds[rand.Intn(len(tlds))]) 
  } 
} 
</pre><p class="calibre10">You will notice a few similarities between Domainify and the Sprinkle program: we set the random seed using <code class="email">rand.Seed</code>, generate a <code class="email">NewScanner</code> method wrapping the <code class="email">os.Stdin</code> reader, and scan each line until there is no more input.</p><p class="calibre10">We then convert the text to lowercase and build up a new slice of <code class="email">rune</code> types called <code class="email">newText</code>. The <code class="email">rune</code> types consist of only characters that appear in the <code class="email">allowedChars</code> string, which <code class="email">strings.ContainsRune</code> lets us know. If <code class="email">rune</code> is a space that we determine by calling <code class="email">unicode.IsSpace</code>, we replace it with a hyphen, which is an acceptable practice in domain names.</p><div class="informaltable" title="Note"><h3 class="title2"><a id="note0061" class="calibre1"/>Note</h3><p class="calibre10">Ranging over a string returns the index of each character and a <code class="email">rune</code> type, which is a numerical value (specifically, <code class="email">int32</code>) representing the character itself. For more information about runes, characters, and strings, refer to <a class="calibre1" href="http://blog.golang.org/strings">http://blog.golang.org/strings</a>.</p></div><p class="calibre10">Finally, we convert <code class="email">newText</code> from a <code class="email">[]rune</code> slice into a string and add either <code class="email">.com</code> or <code class="email">.net</code> at the end, before printing it out using <code class="email">fmt.Println</code>.</p><p class="calibre10">Let's build and run Domainify:</p><pre class="programlisting">
<span class="strong"><strong class="calibre2">go build -o domainify</strong></span>
<span class="strong"><strong class="calibre2">./domainify</strong></span>
</pre><p class="calibre10">Type in some of these options to see how <code class="email">domainify</code> reacts:</p><div class="book"><ul class="itemizedlist"><li class="listitem">Monkey</li><li class="listitem">Hello Domainify</li><li class="listitem">"What's up?"</li><li class="listitem">One (two) three!</li></ul></div><p class="calibre10">You can see that, for example, <code class="email">One (two) three!</code> might yield <code class="email">one-two-three.com</code>.</p><p class="calibre10">We are now going to compose Sprinkle and Domainify to see them work together. In your terminal, navigate to the parent folder (probably <code class="email">$GOPATH/src</code>) of <code class="email">sprinkle</code> and <code class="email">domainify</code> and run the following command:</p><pre class="programlisting">
<span class="strong"><strong class="calibre2">./sprinkle/sprinkle | ./domainify/domainify</strong></span>
</pre><p class="calibre10">Here, we ran the <code class="email">sprinkle</code> program and piped the output to the <code class="email">domainify</code> program. By default, <code class="email">sprinkle</code> uses the terminal as the input and <code class="email">domanify</code> outputs to the terminal. Try typing in <code class="email">chat</code> a few times again and notice the output is similar to what Sprinkle was outputting previously, except now they are acceptable for domain names. It is this piping between programs that allows us to compose command-line tools together.</p><div class="informaltable" title="Tip"><h3 class="title2"><a id="tip62" class="calibre1"/>Tip</h3><p class="calibre10">Only supporting <code class="email">.com</code> and <code class="email">.net</code> top-level domains is fairly limiting. As an additional assignment, see whether you can accept a list of TLDs via a command-line flag.</p></div></div></div></body></html>