<html><head></head><body>
<div id="page" style="height:0pt"/><div class="book" title="Reading votes from Twitter"><div class="book" id="57R302-9c484ed022e64a0fb0e1aebf8e05d4fd"><div class="book"><div class="book"><h1 class="title" id="calibre_pb_0"><a id="ch05lvl1sec0030" class="calibre1"/>Reading votes from Twitter</h1></div></div></div><p class="calibre10">In your <code class="email">$GOPATH/src</code> folder, alongside other projects, create a new folder called <code class="email">socialpoll</code> for this chapter. This folder won't be a Go package or a program by itself, but it will contain our three component programs. Inside <code class="email">socialpoll</code>, create a new folder called <code class="email">twittervotes</code> and add the obligatory <code class="email">main.go</code> template (this is important as <code class="email">main</code> packages without a <code class="email">main</code> function won't compile):</p><pre class="programlisting">package main 
func main(){} 
</pre><p class="calibre10">Our <code class="email">twittervotes</code> program is going to:</p><div class="book"><ul class="itemizedlist"><li class="listitem">Load all polls from the MongoDB database using <code class="email">mgo</code> and collect all options from the <code class="email">options</code> array in each document</li><li class="listitem">Open and maintain a connection to Twitter's streaming APIs looking for any mention of the options</li><li class="listitem">Figure out which option is mentioned and push that option through to NSQ for each tweet that matches the filter</li><li class="listitem">If the connection to Twitter is dropped (which is common in long-running connections that are actually part of Twitter's streaming API specification) after a short delay (so that we do not bombard Twitter with connection requests), reconnect and continue</li><li class="listitem">Periodically re-query MongoDB for the latest polls and refresh the connection to Twitter to make sure we are always looking out for the right options</li><li class="listitem">Gracefully stop itself when the user terminates the program by hitting <span class="strong"><em class="calibre11">Ctrl + C</em></span></li></ul></div></div></body></html>