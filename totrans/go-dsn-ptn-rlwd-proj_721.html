<html><head></head><body>
<div id="page" style="height:0pt"/><div class="book" title="Handling endpoints"><div class="book" id="5IAP62-9c484ed022e64a0fb0e1aebf8e05d4fd"><div class="book"><div class="book"><h1 class="title" id="calibre_pb_0"><a id="ch06lvl1sec0041" class="calibre1"/>Handling endpoints</h1></div></div></div><p class="calibre10">The final piece of the puzzle is the <code class="email">handlePolls</code> function, which will use the helpers to understand the incoming request and access the database and generate a meaningful response that will be sent back to the client. We also need to model the poll data that we were working with in the previous chapter.</p><p class="calibre10">Create a new file called <code class="email">polls.go</code> and add the following code:</p><pre class="programlisting">package main 
import "gopkg.in/mgo.v2/bson" 
type poll struct { 
  ID      bson.ObjectId  `bson:"_id" json:"id"` 
  Title   string         `json:"title"` 
  Options []string       `json:"options"` 
  Results map[string]int `json:"results,omitempty"` 
  APIKey  string         `json:"apikey"` 
} 
</pre><p class="calibre10">Here, we define a structure called <code class="email">poll</code>, which has five fields that in turn describe the polls being created and maintained by the code we wrote in the previous chapter. We have also added the <code class="email">APIKey</code> field, which you probably wouldn't do in the real world but which will allow us to demonstrate how we extract the API key from the context. Each field also has a tag (two in the <code class="email">ID</code> case), which allows us to provide some extra metadata.</p></div></body></html>