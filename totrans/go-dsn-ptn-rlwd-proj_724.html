<html><head></head><body>
<div class="book" title="Handling endpoints">
<div class="book" title="Testing our API using curl"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_3"><a id="ch06lvl2sec0066" class="calibre1"/>Testing our API using curl</h2></div></div></div><p class="calibre10">Curl is a command-line tool that allows us to make HTTP requests to our service so that we can access it as though we were a real app or client consuming the service.</p><div class="informaltable" title="Note"><h3 class="title2"><a id="note00104" class="calibre1"/>Note</h3><p class="calibre10">Windows users do not have access to curl by default and will need to seek an alternative. Check out <a class="calibre1" href="http://curl.haxx.se/dlwiz/?type=bin">http://curl.haxx.se/dlwiz/?type=bin</a> or search the Web for Windows curl alternative.</p></div><p class="calibre10">In a terminal, let's read all the polls in the database through our API. Navigate to your <code class="email">api</code> folder and build and run the project and also ensure MongoDB is running:</p><pre class="programlisting">
<span class="strong"><strong class="calibre2">go build -o api</strong></span>
<span class="strong"><strong class="calibre2">./api</strong></span>
</pre><p class="calibre10">We then perform the following steps:</p><div class="book"><ol class="orderedlist"><li class="listitem" value="1">Enter the following <code class="email">curl</code> command that uses the <code class="email">-X</code> flag to denote we want to make a <code class="email">GET</code> request to the specified URL:<pre class="programlisting">
<span class="strong"><strong class="calibre2">curl -X GET http://localhost:8080/polls/?
         key=abc123</strong></span>
</pre></li><li class="listitem" value="2">The output is printed after you hit<span class="strong"><em class="calibre11">Enter</em></span>:<pre class="programlisting">
<span class="strong"><strong class="calibre2">[{"id":"541727b08ea48e5e5d5bb189","title":"Best
          Beatle?",
          "options": ["john","paul","george","ringo"]},
        {"id":"541728728ea48e5e5d5bb18a","title":"Favorite
          language?",
          "options": ["go","java","javascript","ruby"]}]</strong></span>
</pre></li><li class="listitem" value="3">While it isn't pretty, you can see that the API returns the polls from your database. Issue the following command to create a new poll:<pre class="programlisting">
<span class="strong"><strong class="calibre2">curl --data '{"title":"test","options":
         ["one","two","three"]}'
         -X POST http://localhost:8080/polls/?key=abc123</strong></span>
</pre></li><li class="listitem" value="4">Get the list again to see the new poll included:<pre class="programlisting">
<span class="strong"><strong class="calibre2">curl -X GET http://localhost:8080/polls/?
         key=abc123</strong></span>
</pre></li><li class="listitem" value="5">Copy and paste one of the IDs and adjust the URL to refer specifically to that poll:<pre class="programlisting">
<span class="strong"><strong class="calibre2">curl -X GET
          http://localhost:8080/polls/541727b08ea48e5e5d5bb189?
          key=abc123</strong></span>
<span class="strong"><strong class="calibre2">[{"id":"541727b08ea48e5e5d5bb189",","title":"Best  Beatle?",
          "options": ["john","paul","george","ringo"]}]</strong></span>
</pre></li><li class="listitem" value="6">Now we see only the selected poll. Let's make a <code class="email">DELETE</code> request to remove the poll:<pre class="programlisting">
<span class="strong"><strong class="calibre2">curl -X DELETE  
          http://localhost:8080/polls/541727b08ea48e5e5d5bb189? 
          key=abc123</strong></span>
</pre></li><li class="listitem" value="7">Now when we get all the polls again, we'll see that the Beatles poll has gone:<pre class="programlisting">
<span class="strong"><strong class="calibre2">curl -X GET http://localhost:8080/polls/?key=abc123</strong></span>
<span class="strong"><strong class="calibre2">[{"id":"541728728ea48e5e5d5bb18a","title":"Favorite    
          language?","options":["go","java","javascript","ruby"]}]</strong></span>
</pre></li></ol><div class="calibre12"/></div><p class="calibre10">So now that we know that our API is working as expected, it's time to build something that consumes the API properly.</p></div></div></body></html>