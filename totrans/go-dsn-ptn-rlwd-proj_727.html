<html><head></head><body>
<div class="book" title="A web client that consumes the API">
<div class="book" title="Creating a new poll"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_2"><a id="ch06lvl2sec0068" class="calibre1"/>Creating a new poll</h2></div></div></div><p class="calibre10">To allow users to create a new poll, create a file called <code class="email">new.html</code> inside the <code class="email">public</code> folder, and add the following HTML code to the file:</p><pre class="programlisting">&lt;!DOCTYPE html&gt; 
&lt;html&gt; 
&lt;head&gt; 
  &lt;title&gt;Create Poll&lt;/title&gt; 
  &lt;link rel="stylesheet"       
    href="//maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/
    bootstrap.min.css"&gt; 
&lt;/head&gt; 
&lt;body&gt; 
  &lt;script src="//ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"&gt;   &lt;/script&gt; 
&lt;/body&gt; 
&lt;/html&gt; 
</pre><p class="calibre10">We are going to add the elements for an HTML form that will capture the information we need when creating a new poll, namely the title of the poll and the options. Add the following code inside the <code class="email">body</code> tags:</p><pre class="programlisting">&lt;div class="container"&gt; 
  &lt;div class="col-md-4"&gt;&lt;/div&gt; 
  &lt;form id="poll" role="form" class="col-md-4"&gt; 
    &lt;h2&gt;Create Poll&lt;/h2&gt; 
    &lt;div class="form-group"&gt; 
      &lt;label for="title"&gt;Title&lt;/label&gt; 
      &lt;input type="text" class="form-control" id="title" 
        placeholder="Title"&gt; 
    &lt;/div&gt; 
    &lt;div class="form-group"&gt; 
      &lt;label for="options"&gt;Options&lt;/label&gt; 
      &lt;input type="text" class="form-control" id="options"
        placeholder="Options"&gt; 
      &lt;p class="help-block"&gt;Comma separated&lt;/p&gt; 
    &lt;/div&gt; 
    &lt;button type="submit" class="btn btn-primary"&gt;
      Create Poll&lt;/button&gt; or &lt;a href="/"&gt;cancel&lt;/a&gt; 
  &lt;/form&gt; 
  &lt;div class="col-md-4"&gt;&lt;/div&gt; 
&lt;/div&gt; 
</pre><p class="calibre10">Since our API speaks JSON, we need to do a bit of work to turn the HTML form into a JSON-encoded string and also break the comma-separated options string into an array of options. Add the following <code class="email">script</code> tag:</p><pre class="programlisting">&lt;script&gt; 
  $(function(){ 
    var form = $("form#poll"); 
    form.submit(function(e){ 
      e.preventDefault(); 
      var title = form.find("input[id='title']").val(); 
      var options = form.find("input[id='options']").val(); 
      options = options.split(","); 
      for (var opt in options) { 
        options[opt] = options[opt].trim(); 
      } 
      $.post("http://localhost:8080/polls/?key=abc123", 
        JSON.stringify({ 
          title: title, options: options 
        }) 
      ).done(function(d, s, r){ 
        location.href = "view.html?poll=" +
        r.getResponseHeader("Location"); 
      }); 
    }); 
  }); 
&lt;/script&gt; 
</pre><p class="calibre10">Here, we add a listener to the <code class="email">submit</code> event of our form and use jQuery's <code class="email">val</code> method to collect the input values. We split the options with a comma and trim the spaces away before using the <code class="email">$.post</code> method to make the <code class="email">POST</code> request to the appropriate API endpoint. <code class="email">JSON.stringify</code> allows us to turn the data object into a JSON string, and we use that string as the body of the request, as expected by the API. On success, we pull out the <code class="email">Location</code> header and redirect the user to the <code class="email">view.html</code> page, passing a reference to the newly created poll as the parameter.</p></div></div></body></html>