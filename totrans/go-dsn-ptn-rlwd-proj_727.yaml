- en: Creating a new poll
  id: totrans-0
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 创建新的投票
- en: 'To allow users to create a new poll, create a file called `new.html` inside
    the `public` folder, and add the following HTML code to the file:'
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 为了允许用户创建新的投票，在`public`文件夹内创建一个名为`new.html`的文件，并将以下HTML代码添加到该文件中：
- en: '[PRE0]'
  id: totrans-2
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: 'We are going to add the elements for an HTML form that will capture the information
    we need when creating a new poll, namely the title of the poll and the options.
    Add the following code inside the `body` tags:'
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将添加用于捕获在创建新投票时所需信息的HTML表单元素，即投票的标题和选项。请在`body`标签内添加以下代码：
- en: '[PRE1]'
  id: totrans-4
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: 'Since our API speaks JSON, we need to do a bit of work to turn the HTML form
    into a JSON-encoded string and also break the comma-separated options string into
    an array of options. Add the following `script` tag:'
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: 由于我们的API使用JSON，我们需要做一些工作将HTML表单转换为JSON编码的字符串，并将逗号分隔的选项字符串拆分为选项数组。请添加以下`script`标签：
- en: '[PRE2]'
  id: totrans-6
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: Here, we add a listener to the `submit` event of our form and use jQuery's `val`
    method to collect the input values. We split the options with a comma and trim
    the spaces away before using the `$.post` method to make the `POST` request to
    the appropriate API endpoint. `JSON.stringify` allows us to turn the data object
    into a JSON string, and we use that string as the body of the request, as expected
    by the API. On success, we pull out the `Location` header and redirect the user
    to the `view.html` page, passing a reference to the newly created poll as the
    parameter.
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: 在这里，我们为表单的`submit`事件添加一个监听器，并使用jQuery的`val`方法收集输入值。我们用逗号分隔选项，并在使用`$.post`方法向适当的API端点发送`POST`请求之前去除空格。`JSON.stringify`允许我们将数据对象转换为JSON字符串，我们使用该字符串作为请求的主体，符合API的预期。成功后，我们提取`Location`头信息，并将用户重定向到`view.html`页面，传递对新创建的投票的引用作为参数。
