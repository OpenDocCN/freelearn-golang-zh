<html><head></head><body>
<div class="book" title="Chapter&#xA0;7.&#xA0; Random Recommendations Web Service" id="5M4RE1-9c484ed022e64a0fb0e1aebf8e05d4fd">
<div class="book" title="The project overview">
<div class="book" title="Project design specifics"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_2"><a id="ch07lvl2sec0070" class="calibre1"/>Project design specifics</h2></div></div></div><p class="calibre10">In order to turn our stories into an interactive application, we are going to provide two JSON endpoints: one to deliver the kinds of journeys users will be able to select in the application and another to actually generate the random recommendations for the selected journey type.</p><pre class="programlisting">GET /journeys 
</pre><p class="calibre10">The preceding call should return a list similar to the following:</p><pre class="programlisting">[ 
  { 
    name: "Romantic", 
    journey: "park|bar|movie_theater|restaurant|florist" 
  }, 
  { 
    name: "Shopping", 
    journey: "department_store|clothing_store|jewelry_store" 
  } 
] 
</pre><p class="calibre10">The <code class="email">name</code> field is a human-readable label for the type of recommendations the app generates, and the <code class="email">journey</code> field is a pipe-separated list of the supported journey types. It is the journey value that we will pass, as a URL parameter, into our other endpoint, which generates the actual recommendations:</p><pre class="programlisting">GET /recommendations? 
 lat=1&amp;lng=2&amp;journey=bar|cafe&amp;radius=10&amp;cost=$...$$$$$ 
</pre><p class="calibre10">This endpoint is responsible for querying the Google Places API and generating the recommendations before returning an array of place objects. We will use the parameters in the URL to control the kind of query to make. The <code class="email">lat</code> and <code class="email">lng</code> parameters representing latitude and longitude, respectively tell our API where in the world we want recommendations from, and the <code class="email">radius</code> parameter represents the distance in meters around the point in which we are interested.</p><p class="calibre10">The <code class="email">cost</code> value is a human-readable way of representing the price range for places that the API returns. It is made up of two values: a lower and upper range separated by three dots. The number of dollar characters represents the price level, with <code class="email">$</code> being the most affordable and <code class="email">$$$$$</code> being the most expensive. Using this pattern, a value of <code class="email">$...$$</code> would represent very low-cost recommendations, where <code class="email">$$$$...$$$$$</code> would represent a pretty expensive experience.</p><div class="informaltable" title="Tip"><h3 class="title2"><a id="tip107" class="calibre1"/>Tip</h3><p class="calibre10">Some programmers might insist that the cost range is represented by numerical values, but since our API is going to be consumed by people, why not make things a little more interesting? It is up to you as the API designer.</p></div><p class="calibre10">An example payload for this call might look something like this:</p><pre class="programlisting">[ 
  { 
    icon: "http://maps.gstatic.com/mapfiles/place_api/icons/cafe-     
     71.png", 
    lat: 51.519583, lng: -0.146251, 
    vicinity: "63 New Cavendish St, London", 
    name: "Asia House", 
    photos: [{ 
      url: "https://maps.googleapis.com/maps/api/place/photo?        
      maxwidth=400&amp;photoreference=CnRnAAAAyLRN" 
     }] 
  }, ... 
] 
</pre><p class="calibre10">The array returned contains a place object representing a random recommendation for each segment in the journey in the appropriate order. The preceding example is a cafe in London. The data fields are fairly self-explanatory; the <code class="email">lat</code> and <code class="email">lng</code> fields represent the location of the place, the <code class="email">name</code> and <code class="email">vicinity</code> fields tell us what and where the business is, and the <code class="email">photos</code> array gives us a list of relevant photographs from Google's servers. The <code class="email">vicinity</code> and <code class="email">icon</code> fields will help us deliver a richer experience to our users.</p></div></div></div></body></html>