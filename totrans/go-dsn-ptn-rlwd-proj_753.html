<html><head></head><body>
<div id="page" style="height:0pt"/><div class="book" title="The user command-line tool"><div class="book" id="5RRUQ2-9c484ed022e64a0fb0e1aebf8e05d4fd"><div class="book"><div class="book"><h1 class="title" id="calibre_pb_0"><a id="ch08lvl1sec0051" class="calibre1"/>The user command-line tool</h1></div></div></div><p class="calibre10">The first of two tools we will build allows the user to add, list, and remove paths for the backup daemon tool (which we will write later). You can expose a web interface or even use the binding packages for the desktop user interface integration, but we are going to keep things simple and build ourselves a command-line tool.</p><p class="calibre10">Create a new folder called <code class="email">cmds</code> inside the <code class="email">backup</code> folder and create another <code class="email">backup</code> folder inside that so you have <code class="email">backup/cmds/backup</code>.</p><p class="calibre10">Inside our new <code class="email">backup</code> folder, add the following code to <code class="email">main.go</code>:</p><pre class="programlisting">func main() { 
  var fatalErr error 
  defer func() { 
    if fatalErr != nil { 
      flag.PrintDefaults() 
      log.Fatalln(fatalErr) 
    } 
  }() 
  var ( 
    dbpath = flag.String("db", "./backupdata", "path to database directory") 
  ) 
  flag.Parse() 
  args := flag.Args() 
  if len(args) &lt; 1 { 
    fatalErr = errors.New("invalid usage; must specify command") 
    return 
  } 
} 
</pre><p class="calibre10">We first define our <code class="email">fatalErr</code> variable and defer the function that checks to ensure that value is <code class="email">nil</code>. If it is not, it will print the error along with flag defaults and exit with a nonzero status code. We then define a flag called <code class="email">db</code> that expects the path to the <code class="email">filedb</code> database directory before parsing the flags and getting the remaining arguments and ensuring that there is at least one.</p></div></body></html>