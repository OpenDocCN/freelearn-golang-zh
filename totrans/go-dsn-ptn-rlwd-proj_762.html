<html><head></head><body><div class="book" title="Testing our solution" id="5TOVU1-9c484ed022e64a0fb0e1aebf8e05d4fd"><div class="book"><div class="book"><div class="book"><h1 class="title" id="calibre_pb_0"><a id="ch08lvl1sec0053" class="calibre1"/>Testing our solution</h1></div></div></div><p class="calibre10">Let's see whether our two programs play nicely together. You may want to open two terminal windows for this, since we'll be running two programs.</p><p class="calibre10">We have already added some paths to the database, so let's use <code class="email">backup</code> to see them:</p><pre class="programlisting">
<span class="strong"><strong class="calibre2">./backup -db="./backupdata" list</strong></span>
</pre><p class="calibre10">You should see the two test folders; if you don't, refer to the <span class="strong"><em class="calibre11">Adding paths</em></span> section:</p><pre class="programlisting">
<span class="strong"><strong class="calibre2">= ./test [Not yet archived]</strong></span>
<span class="strong"><strong class="calibre2">= ./test2 [Not yet archived]</strong></span>
</pre><p class="calibre10">In another window, navigate to the <code class="email">backupd</code> folder and create our two test folders, called <code class="email">test</code> and <code class="email">test2</code>.</p><p class="calibre10">Build <code class="email">backupd</code> using the usual method:</p><pre class="programlisting">
<span class="strong"><strong class="calibre2">go build -o backupd</strong></span>
</pre><p class="calibre10">Assuming all is well, we can now start the backup process, being sure to point the <code class="email">db</code> path to the same path as we used for the <code class="email">backup</code> program and specifying that we want to use a new folder called <code class="email">archive</code> to store the ZIP files. For testing purposes, let's specify an interval of <code class="email">5</code> seconds in order to save time:</p><pre class="programlisting">
<span class="strong"><strong class="calibre2">./backupd -db="../backup/backupdata/" -archive="./archive" - interval=5s</strong></span>
</pre><p class="calibre10">Immediately, <code class="email">backupd</code> should check the folders, calculate the hashes, note that they are different (to <code class="email">Not yet archived</code>), and initiate the archive process for both folders. It will print the output that tells us this:</p><pre class="programlisting">
<span class="strong"><strong class="calibre2">Checking...</strong></span>
<span class="strong"><strong class="calibre2">Archived 2 directories</strong></span>
</pre><p class="calibre10">Open the newly created <code class="email">archive</code> folder inside <code class="email">backup/cmds/backupd</code> and note that it has created two subfolders: <code class="email">test</code> and <code class="email">test2</code>. Inside these are compressed archive versions of the empty folders. Feel free to unzip one and see; nothing very exciting so far.</p><p class="calibre10">Meanwhile, back in the terminal window, <code class="email">backupd</code> has been checking the folders for changes again:</p><pre class="programlisting">
<span class="strong"><strong class="calibre2">Checking...</strong></span>
<span class="strong"><strong class="calibre2">  No changes</strong></span>
<span class="strong"><strong class="calibre2">Checking...</strong></span>
<span class="strong"><strong class="calibre2">  No changes</strong></span>
</pre><p class="calibre10">In your favorite text editor, create a new text file inside the <code class="email">test2</code> folder, containing the word <code class="email">test</code>, and save it as <code class="email">one.txt</code>. After a few seconds, you will see that <code class="email">backupd</code> has noticed the new file and created another snapshot inside the <code class="email">archive/test2</code> folder.</p><p class="calibre10">Of course, it has a different filename because the time is different, but if you unzip it, you will notice that it has indeed created a compressed archive version of the folder.</p><p class="calibre10">Play around with the solution by taking the following actions:</p><div class="book"><ul class="itemizedlist"><li class="listitem">Change the contents of the <code class="email">one.txt</code> file</li><li class="listitem">Add a file to the <code class="email">test</code> folder too</li><li class="listitem">Delete a file</li></ul></div></div></body></html>