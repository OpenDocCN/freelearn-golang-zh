<html><head></head><body>
<div id="page" style="height:0pt"/><div class="book" title="Entities and data access"><div class="book" id="61J262-9c484ed022e64a0fb0e1aebf8e05d4fd"><div class="book"><div class="book"><h1 class="title" id="calibre_pb_0"><a id="ch09lvl1sec0057" class="calibre1"/>Entities and data access</h1></div></div></div><p class="calibre10">To persist data in Google Cloud Datastore, we need a struct to represent each entity. These entity structures will be serialized and deserialized when we save and load data through the <code class="email">datastore</code> API. We can add helper methods to perform the interactions with the data store, which is a nice way to keep such functionality physically close to the entities themselves. For example, we will model an answer with a struct called <code class="email">Answer</code> and add a <code class="email">Create</code> method that in turn calls the appropriate function from the <code class="email">datastore</code> package. This prevents us from bloating our HTTP handlers with lots of data access code and allows us to keep them clean and simple instead.</p><p class="calibre10">One of the foundation blocks of our application is the concept of a question. A question can be asked by a user and answered by many. It will have a unique ID so that it is addressable (referable in a URL), and we'll store a timestamp of when it was created.</p><p class="calibre10">Create a new file inside <code class="email">answersapp</code> called <code class="email">questions.go</code> and add the following <code class="email">struct</code> function:</p><pre class="programlisting">type Question struct { 
  Key *datastore.Key `json:"id" datastore:"-"` 
  CTime time.Time `json:"created"` 
  Question string `json:"question"` 
  User UserCard `json:"user"` 
  AnswersCount int `json:"answers_count"` 
} 
</pre><p class="calibre10">The structure describes a question in our application. Most of it will seem quite obvious, as we've done similar things in the previous chapters. The <code class="email">UserCard</code> struct represents a denormalized <code class="email">User</code> entity, both of which we'll add later.</p><div class="informaltable" title="Tip"><h3 class="title2"><a id="tip138" class="calibre1"/>Tip</h3><p class="calibre10">You can import the <code class="email">datastore</code> package in your Go project using this:
<code class="email">import "google.golang.org/appengine/datastore" </code>
</p></div><p class="calibre10">It's worth spending a little time understanding the <code class="email">datastore.Key</code> type.</p></div></body></html>