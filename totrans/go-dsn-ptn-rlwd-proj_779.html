<html><head></head><body>
<div class="book" title="Google App Engine users" id="62HIO1-9c484ed022e64a0fb0e1aebf8e05d4fd">
<div class="book" title="Embedding denormalized data"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_1"><a id="ch09lvl2sec00101" class="calibre1"/>Embedding denormalized data</h2></div></div></div><p class="calibre10">If you recall, our Question type doesn't take the author as <code class="email">User</code>; rather, the type was <code class="email">UserCard</code>. When we embed denormalized data into other entities, sometimes we will want them to look slightly different from the master entity. In our case, since we do not store the key in the <code class="email">User</code> entity (remember the <code class="email">Key</code> fields have <code class="email">datastore:"-"</code>), we need to have a new type that stores the key.</p><p class="calibre10">At the bottom of <code class="email">users.go</code>, add the <code class="email">UserCard</code> struct and the associated helper method for <code class="email">User</code>:</p><pre class="programlisting">type UserCard struct { 
  Key         *datastore.Key `json:"id"` 
  DisplayName string         `json:"display_name"` 
  AvatarURL   string         `json:"avatar_url"` 
} 
func (u User) Card() UserCard { 
  return UserCard{ 
    Key:         u.Key, 
    DisplayName: u.DisplayName, 
    AvatarURL:   u.AvatarURL, 
  } 
} 
</pre><p class="calibre10">Note that <code class="email">UserCard</code> doesn't specify a <code class="email">datastore</code> tag, so the <code class="email">Key</code> field will indeed be persisted in the data store. Our <code class="email">Card()</code> helper function just builds and returns <code class="email">UserCard</code> by copying the values of each field. This seems wasteful but offers great control, especially if you want embedded data to look very different from its original entity.</p></div></div></body></html>