- en: Indexing
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Reads from Google Cloud Datastore are extremely fast due to the extensive use
    of indexes. By default, every field in our structure is indexed. Queries that
    attempt to filter on fields that aren't indexed will fail (the method will return
    an error); the data store doesn't fall back to scanning like some other technologies
    do because it's considered too slow. If one query filters two or more fields,
    an additional index must be added that is composed of all fields.
  prefs: []
  type: TYPE_NORMAL
- en: 'A structure with 10 fields would perform multiple write operations when you
    put it: one for the entity itself and one for each index that needs to be updated.
    So it is sensible to turn off indexing for fields that are you not planning to
    query on.'
  prefs: []
  type: TYPE_NORMAL
- en: 'In `questions.go`, add the `datastore` field tags to the `Question` structure:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE
- en: The addition of the `datastore:",noindex"` field tags will tell the data store
    not to index these fields.
  prefs: []
  type: TYPE_NORMAL
- en: Note
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: The `,noindex` value beginning with a comma is a little confusing. The value
    is essentially a list of comma-separated arguments, the first being the name we
    want the data store to use when storing each field (just like it does for the
    `json` tag). Since we don't want to say anything about the name we want the data
    store to use the real field name we are omitting it; so the first argument is
    empty, and the second argument is `noindex`.
  prefs: []
  type: TYPE_NORMAL
- en: 'Do this for fields that we do not want indexed in the `Answer` structure:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE1]'
  prefs: []
  type: TYPE_PRE
- en: 'And for the `Vote` structure, do this:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE2]'
  prefs: []
  type: TYPE_PRE
- en: 'You can also add a `noindex` declaration to all fields inside our card types:
    `AnswerCard`, `UserCard`, and `QuestionCard`.'
  prefs: []
  type: TYPE_NORMAL
- en: Note
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: The fields we have left without `noindex` will be used in queries, and we need
    to make sure Google Cloud Datastore does indeed maintain indexes on these fields.
  prefs: []
  type: TYPE_NORMAL
