- en: Indexing
  id: totrans-0
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 索引
- en: Reads from Google Cloud Datastore are extremely fast due to the extensive use
    of indexes. By default, every field in our structure is indexed. Queries that
    attempt to filter on fields that aren't indexed will fail (the method will return
    an error); the data store doesn't fall back to scanning like some other technologies
    do because it's considered too slow. If one query filters two or more fields,
    an additional index must be added that is composed of all fields.
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 由于广泛使用索引，从Google Cloud Datastore的读取速度非常快。默认情况下，我们结构中的每个字段都是索引的。尝试在未索引的字段上过滤的查询将失败（方法将返回错误）；数据存储不会像某些其他技术那样回退到扫描，因为这被认为太慢。如果一个查询过滤了两个或更多字段，必须添加一个额外的索引，该索引由所有字段组成。
- en: 'A structure with 10 fields would perform multiple write operations when you
    put it: one for the entity itself and one for each index that needs to be updated.
    So it is sensible to turn off indexing for fields that are you not planning to
    query on.'
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 当您放入一个包含10个字段的架构时，它会执行多次写操作：一次用于实体本身，一次用于需要更新的每个索引。因此，对于您不打算查询的字段，关闭索引是有意义的。
- en: 'In `questions.go`, add the `datastore` field tags to the `Question` structure:'
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 在`questions.go`中，将`datastore`字段标签添加到`Question`结构中：
- en: '[PRE0]'
  id: totrans-4
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: The addition of the `datastore:",noindex"` field tags will tell the data store
    not to index these fields.
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: 添加`datastore:",noindex"`字段标签将告诉数据存储不要索引这些字段。
- en: Note
  id: totrans-6
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: The `,noindex` value beginning with a comma is a little confusing. The value
    is essentially a list of comma-separated arguments, the first being the name we
    want the data store to use when storing each field (just like it does for the
    `json` tag). Since we don't want to say anything about the name we want the data
    store to use the real field name we are omitting it; so the first argument is
    empty, and the second argument is `noindex`.
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: 以逗号开头的`,`noindex`值有点令人困惑。该值本质上是一个逗号分隔的参数列表，第一个是我们希望数据存储在存储每个字段时使用的名称（就像它对`json`标签所做的那样）。由于我们不想对希望数据存储使用的名称说任何东西，所以我们省略了真实字段名称；因此，第一个参数是空的，第二个参数是`noindex`。
- en: 'Do this for fields that we do not want indexed in the `Answer` structure:'
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: 对于我们不想在`Answer`结构中索引的字段，请这样做：
- en: '[PRE1]'
  id: totrans-9
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: 'And for the `Vote` structure, do this:'
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: 对于`Vote`结构，请这样做：
- en: '[PRE2]'
  id: totrans-11
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: 'You can also add a `noindex` declaration to all fields inside our card types:
    `AnswerCard`, `UserCard`, and `QuestionCard`.'
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 您还可以将`noindex`声明添加到我们卡片类型中的所有字段：`AnswerCard`、`UserCard`和`QuestionCard`。
- en: Note
  id: totrans-13
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: The fields we have left without `noindex` will be used in queries, and we need
    to make sure Google Cloud Datastore does indeed maintain indexes on these fields.
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: 我们没有添加`noindex`的字段将用于查询，我们需要确保Google Cloud Datastore确实在这些字段上维护索引。
