- en: Casting a vote
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 投票
- en: Before our API is a complete feature, we need to add the ability for users to
    cast votes. We'll break this piece into two functions in order to increase the
    readability of our code.
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 在我们的 API 完全功能化之前，我们需要添加用户投票的能力。我们将把这个功能拆分成两个函数，以提高我们代码的可读性。
- en: 'Inside `votes.go`, add the following function:'
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 在 `votes.go` 文件中，添加以下函数：
- en: '[PRE0]'
  id: totrans-3
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: The `CastVote` function takes (along with the obligatory `Context`) `datastore.Key`
    for the answer that is being voted for and a score integer. It loads the question
    and the current user, starts a data store transaction, and passes execution off
    to the `castVoteInTransaction` function.
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: '`CastVote` 函数接收（连同必填的 `Context`）用于投票的 `datastore.Key` 和一个分数整数。它加载问题以及当前用户，开始数据存储事务，并将执行权传递给
    `castVoteInTransaction` 函数。'
