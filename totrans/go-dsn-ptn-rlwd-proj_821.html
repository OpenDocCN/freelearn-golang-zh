<html><head></head><body>
<div class="book" title="Creating a server command">
<div class="book" title="Preventing a main function from terminating immediately"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_4"><a id="ch10lvl2sec00127" class="calibre1"/>Preventing a main function from terminating immediately</h2></div></div></div><p class="calibre10">If we closed our main function here, it would immediately exit and terminate all of our servers. This is because everything we're doing that would prevent this is inside its own goroutine. To prevent this, we need a way to block the function at the end to wait until something tells the program to terminate.</p><p class="calibre10">Since we are using the <code class="email">errChan</code> error channel for errors, this is a perfect candidate. We can just listen on this channel, which (while nothing has been sent down it) will block and allow the other goroutines to do their work. If something goes wrong (or if a termination signal is received), the <code class="email">&lt;-errChan</code> call will unblock and exit and all goroutines will be stopped.</p><p class="calibre10">At the bottom of the main function, add the final statement and closing block:</p><pre class="programlisting">  log.Fatalln(&lt;-errChan) 
} 
</pre><p class="calibre10">When an error occurs, we'll just log it and exit with a nonzero code.</p></div></div></body></html>