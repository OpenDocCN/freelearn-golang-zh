<html><head></head><body>
<div class="book" title="Building a gRPC client">
<div class="book" title="Parsing arguments in CLIs"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_2"><a id="ch10lvl2sec00130" class="calibre1"/>Parsing arguments in CLIs</h2></div></div></div><p class="calibre10">Parsing arguments in command-line tools is very common, and there is a neat idiomatic way to do it in Go. The arguments are all available via the <code class="email">os.Args</code> slice, or if you're using flags, the <code class="email">flags.Args()</code> method (which gets arguments with flags stripped). We want to take each argument off the slice (from the beginning) and consume them in an order, which will help us decide which execution flow to take through the program. We're going to add a helper function called <code class="email">pop</code>, which will return the first item, and the slice with the first item trimmed.</p><p class="calibre10">We'll write a quick unit test to ensure that our <code class="email">pop</code> function is working as expected. If you would like to try and write the pop function yourself, then you should do that once the test is in place. Remember that you can run tests by navigating to the appropriate folder in a terminal and executing this:</p><pre class="programlisting">
<span class="strong"><strong class="calibre2">go test</strong></span>
</pre><p class="calibre10">Create a new file inside <code class="email">vaultcli</code> called <code class="email">main_test.go</code> and add the following test function:</p><pre class="programlisting">func TestPop(t *testing.T) { 
  args := []string{"one", "two", "three"} 
  var s string 
  s, args = pop(args) 
  if s != "one" { 
    t.Errorf("unexpected "%s"", s) 
  } 
  s, args = pop(args) 
  if s != "two" { 
    t.Errorf("unexpected "%s"", s) 
  } 
  s, args = pop(args) 
  if s != "three" { 
    t.Errorf("unexpected "%s"", s) 
  } 
  s, args = pop(args) 
  if s != "" { 
    t.Errorf("unexpected "%s"", s) 
  } 
} 
</pre><p class="calibre10">We expect each call to pop to yield the next item in the slice and empty arguments once the slice is empty.</p><p class="calibre10">At the bottom of <code class="email">main.go</code>, add the <code class="email">pop</code> function:</p><pre class="programlisting">func pop(s []string) (string, []string) { 
  if len(s) == 0 { 
    return "", s 
  } 
  return s[0], s[1:] 
} 
</pre></div></div></body></html>