<html><head></head><body>
<div class="book" title="Building a gRPC client">
<div class="book" title="Maintaining good line of sight by extracting case bodies"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_3"><a id="ch10lvl2sec00131" class="calibre1"/>Maintaining good line of sight by extracting case bodies</h2></div></div></div><p class="calibre10">The only thing that remains for us to do is implement the hash and validate methods referred to in the switch statement shown earlier.</p><p class="calibre10">We could have embedded this code inside the switch statement itself, but that would make the main function very difficult to read and also hide happy path execution at different indentation levels, something we should try to avoid.</p><p class="calibre10">Instead, it is a good practice to have the cases inside the switch statement jump out to a dedicated function, taking in any arguments it needs. Underneath the main function, add the following hash and validate functions:</p><pre class="programlisting">func hash(ctx context.Context, service vault.Service, 
  password string) { 
  h, err := service.Hash(ctx, password) 
  if err != nil { 
    log.Fatalln(err.Error()) 
  } 
  fmt.Println(h) 
} 
func validate(ctx context.Context, service vault.Service,  
  password, hash string) { 
  valid, err := service.Validate(ctx, password, hash) 
  if err != nil { 
    log.Fatalln(err.Error()) 
  } 
  if !valid { 
    fmt.Println("invalid") 
    os.Exit(1) 
  } 
  fmt.Println("valid") 
} 
</pre><p class="calibre10">These functions simply call the appropriate method on the service, and depending on the result, log or print the results to the console. If the validate method returns false, the program will exit with an exit code of 1, since nonzero means an error.</p></div></div></body></html>