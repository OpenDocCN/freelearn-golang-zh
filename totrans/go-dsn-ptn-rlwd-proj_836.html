<html><head></head><body>
<div class="book" title="Chapter&#xA0;11.&#xA0;Deploying Go Applications Using Docker">
<div class="book" title="Using Docker locally">
<div class="book" title="Dockerfile"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_3"><a id="ch11lvl2sec00137" class="calibre1"/>Dockerfile</h2></div></div></div><p class="calibre10">A Docker image is like a mini virtual machine. It contains everything that's needed to run an application: the operating system the code will run on, any dependencies that our code might have (such as Go kit in the case of our Vault service), and the binaries of our application itself.</p><p class="calibre10">An image is described with <code class="email">Dockerfile</code>; a text file containing a list of special commands that instruct Docker how to build the image. They are usually based on another container, which saves you from building up everything that might be needed in order to build and run Go applications.</p><p class="calibre10">Inside the <code class="email">vault</code> folder from the code we wrote in <a class="calibre1" title="Chapter 10.  Micro-services in Go with the Go kit Framework" href="part0213_split_000.html#6B47Q1-9c484ed022e64a0fb0e1aebf8e05d4fd">Chapter 10</a>, <span class="strong"><em class="calibre11">Micro-services in Go with the Go kit Framework</em></span>, add a file called <code class="email">Dockerfile</code> (note that this filename has no extension), containing the following code:</p><pre class="programlisting">FROM scratch 
MAINTAINER Your Name &lt;your@email.address&gt; 
ADD vaultd vaultd 
EXPOSE 8080 8081 
ENTRYPOINT ["/vaultd"] 
</pre><p class="calibre10">Each line in a  <code class="email">Dockerfile</code> file represents a different command that is run while the image is being built. The following table describes each of the commands we have used:</p><div class="informaltable"><table border="1" class="calibre17"><colgroup class="calibre18"><col class="calibre19"/><col class="calibre19"/></colgroup><tbody class="calibre20"><tr class="calibre21"><td class="calibre22">
<p class="calibre23">
<span><strong class="calibre24">Command</strong></span>
</p>
</td><td class="calibre22">
<p class="calibre23">
<span><strong class="calibre24">Description</strong></span>
</p>
</td></tr><tr class="calibre21"><td class="calibre22">
<p class="calibre23">
<code class="literal">FROM</code>
</p>
</td><td class="calibre22">
<p class="calibre23">The name of the image that this image will be based on. Single words, such as scratch, represent official Docker images hosted on Docker Hub. For more information on the scratch image, refer to <code class="literal">https://hub.docker.com/_/scratch/</code>.</p>
</td></tr><tr class="calibre21"><td class="calibre22">
<p class="calibre23">
<code class="literal">ADD</code>
</p>
</td><td class="calibre22">
<p class="calibre23">Copies files into the container. We are copying our <code class="literal">vaultd</code> binary and calling it <code class="literal">vaultd</code>.</p>
</td></tr><tr class="calibre21"><td class="calibre22">
<p class="calibre23">
<code class="literal">EXPOSE</code>
</p>
</td><td class="calibre22">
<p class="calibre23">Exposes the list of ports; in our case, the Vault service binds to <code class="literal">:8080</code> and <code class="literal">:8081</code>.</p>
</td></tr><tr class="calibre21"><td class="calibre22">
<p class="calibre23">
<code class="literal">ENTRYPOINT</code>
</p>
</td><td class="calibre22">
<p class="calibre23">The binary to run when the container is executed in our case, the <code class="literal">vaultd</code> binary, which will be put there by the previous call to go install.</p>
</td></tr><tr class="calibre21"><td class="calibre22">
<p class="calibre23">
<code class="literal">MAINTAINER</code>
</p>
</td><td class="calibre22">
<p class="calibre23">Name and email of the person responsible for maintaining the Docker image.</p>
</td></tr></tbody></table></div><div class="informaltable" title="Note"><h3 class="title2"><a id="note00179" class="calibre1"/>Note</h3><p class="calibre10">For a complete list of the supported commands, consult the online Docker documentation at <a class="calibre1" href="https://docs.docker.com/engine/reference/builder/#dockerfile-reference">https://docs.docker.com/engine/reference/builder/#dockerfile-reference</a>.</p></div></div></div></div></body></html>