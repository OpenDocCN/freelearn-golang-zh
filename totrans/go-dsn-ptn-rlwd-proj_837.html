<html><head></head><body>
<div class="book" title="Chapter&#xA0;11.&#xA0;Deploying Go Applications Using Docker">
<div class="book" title="Using Docker locally">
<div class="book" title="Building Go binaries for different architectures"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_4"><a id="ch11lvl2sec00138" class="calibre1"/>Building Go binaries for different architectures</h2></div></div></div><p class="calibre10">Go supports cross-complication, a mechanism by which we can build a binary on one machine (say, our Mac) targeted for a different operating system (such as Linux or Windows) and architecture. Docker containers are Linux-based; so, in order to deliver a binary that can run in that environment, we must first build one.</p><p class="calibre10">In a terminal, navigate to the vault folder and run the following command:</p><pre class="programlisting">
<span class="strong"><strong class="calibre2">CGO_ENABLED=0 GOOS=linux go build -a ./cmd/vaultd/</strong></span>
</pre><p class="calibre10">We are essentially calling go build here but with a few extra bits and pieces to control the build process. <code class="email">CGO_ENABLED</code> and <code class="email">GOOS</code> are environment variables that go build will pay attention to, <code class="email">-a</code> is a flag, and <code class="email">./cmd/vaultd/</code> is the location of the command we want to build (in our case, the <code class="email">vaultd</code> command we built in the previous chapter).</p><div class="book"><ul class="itemizedlist"><li class="listitem">The <code class="email">CGO_ENABLED=0</code> indicates that we do not want cgo to be enabled. Since we are not binding to any C dependencies, we can reduce the size of our build by disabling this.</li><li class="listitem"><code class="email">GOOS</code> is short for Go Operating System and lets us specify which OS we are targeting, in our case, Linux. For a complete list of the available options, you can look directly in the Go source code by visiting <a class="calibre1" href="https://github.com/golang/go/blob/master/src/go/build/syslist.go">https://github.com/golang/go/blob/master/src/go/build/syslist.go</a>.</li></ul></div><p class="calibre10">After a short while, you'll notice that a new binary has appeared, called <code class="email">vaultd</code>. If you're on a non-Linux machine, you won't be able to directly execute this but don't worry; it'll run inside our Docker container just fine.</p></div></div></div></body></html>