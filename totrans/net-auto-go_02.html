<html><head></head><body>
<div id="_idContainer026">
<h1 class="chapter-number" id="_idParaDest-41"><a id="_idTextAnchor040"/><span class="koboSpan" id="kobo.1.1">2</span></h1>
<h1 id="_idParaDest-42"><a id="_idTextAnchor041"/><span class="koboSpan" id="kobo.2.1">Go Basics</span></h1>
<p><span class="koboSpan" id="kobo.3.1">With so many programming languages out there, it’s fair to wonder why anyone would have to invent yet another one. </span><span class="koboSpan" id="kobo.3.2">What the background is of the people behind Go and what the problems are they are trying to solve with this new language are some of the items we will address in this chapter. </span></p>
<p><span class="koboSpan" id="kobo.4.1">These topics give us some perspective on the challenges large-scale software development presents to software developers today and why modern technologies such as programming languages are </span><span class="No-Break"><span class="koboSpan" id="kobo.5.1">constantly evolving.</span></span></p>
<p><span class="koboSpan" id="kobo.6.1">By the end of this chapter, you should have a better understanding of where Go comes from and its role in developing distributed systems running on multi-core processors, as well as be familiar with Go’s source code structure as we go through the </span><span class="No-Break"><span class="koboSpan" id="kobo.7.1">following areas:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.8.1">What is Go? </span></li>
<li><span class="koboSpan" id="kobo.9.1">Go’s guiding principles </span></li>
<li><span class="koboSpan" id="kobo.10.1">Go source code file structure </span></li>
<li><span class="koboSpan" id="kobo.11.1">Go packages and modules </span></li>
<li><span class="koboSpan" id="kobo.12.1">Compiling Go programs </span></li>
<li><span class="koboSpan" id="kobo.13.1">Running Go programs online </span></li>
<li><span class="koboSpan" id="kobo.14.1">Exploring the Go tool to manage Go </span><span class="No-Break"><span class="koboSpan" id="kobo.15.1">source code</span></span></li>
</ul>
<h1 id="_idParaDest-43"><a id="_idTextAnchor042"/><span class="koboSpan" id="kobo.16.1">Technical requirements</span></h1>
<p><span class="koboSpan" id="kobo.17.1">We assume that you have basic familiarity with the command line, Git, and GitHub. </span><span class="koboSpan" id="kobo.17.2">You can find the code examples for this chapter in the book’s GitHub repository, </span><a href="B16971_02.xhtml"><span class="koboSpan" id="kobo.18.1">https://github.com/PacktPublishing/Network-Automation-with-Go</span></a><span class="koboSpan" id="kobo.19.1">, in the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.20.1">ch02</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.21.1"> folder.</span></span></p>
<p><span class="koboSpan" id="kobo.22.1">To run the examples, follow </span><span class="No-Break"><span class="koboSpan" id="kobo.23.1">these steps:</span></span></p>
<ol>
<li><span class="koboSpan" id="kobo.24.1">Install Go 1.17 or later for your operating system. </span><span class="koboSpan" id="kobo.24.2">You can follow the instructions in </span><a href="B16971_01.xhtml#_idTextAnchor015"><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.25.1">Chapter 1</span></em></span></a><span class="koboSpan" id="kobo.26.1">, </span><em class="italic"><span class="koboSpan" id="kobo.27.1">Introduction</span></em><span class="koboSpan" id="kobo.28.1">, in the </span><em class="italic"><span class="koboSpan" id="kobo.29.1">Installing Go</span></em><span class="koboSpan" id="kobo.30.1"> on your computer section, or go </span><span class="No-Break"><span class="koboSpan" id="kobo.31.1">to </span></span><a href="https://packages.cloud.google.com/apt/doc/apt-key.gpg"><span class="No-Break"><span class="koboSpan" id="kobo.32.1">https://go.dev/doc/install</span></span></a><span class="No-Break"><span class="koboSpan" id="kobo.33.1">.</span></span></li>
<li><span class="koboSpan" id="kobo.34.1">Clone the book’s GitHub repository with </span><strong class="source-inline"><span class="koboSpan" id="kobo.35.1">git clone</span></strong> <span class="No-Break"><span class="koboSpan" id="kobo.36.1">at </span></span><a href="https://kubernetes.io/docs/reference/ports-and-protocols/"><span class="No-Break"><span class="koboSpan" id="kobo.37.1">https://github.com/PacktPublishing/Network-Automation-with-Go.git</span></span></a><span class="No-Break"><span class="koboSpan" id="kobo.38.1">.</span></span></li>
<li><span class="koboSpan" id="kobo.39.1">Change the directory to an example’s folder – </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.40.1">cd Network-Automation-with-Go/ch02/pong</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.41.1">.</span></span></li>
<li><span class="koboSpan" id="kobo.42.1">Execute </span><strong class="source-inline"><span class="koboSpan" id="kobo.43.1">go </span></strong><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.44.1">run main.go</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.45.1">.</span></span></li>
</ol>
<h1 id="_idParaDest-44"><a id="_idTextAnchor043"/><span class="koboSpan" id="kobo.46.1">What is Go?</span></h1>
<p><span class="koboSpan" id="kobo.47.1">During the second half of 2007, </span><em class="italic"><span class="koboSpan" id="kobo.48.1">Robert Griesemer</span></em><span class="koboSpan" id="kobo.49.1">, </span><em class="italic"><span class="koboSpan" id="kobo.50.1">Rob Pike</span></em><span class="koboSpan" id="kobo.51.1">, and </span><em class="italic"><span class="koboSpan" id="kobo.52.1">Ken Thompson</span></em><span class="koboSpan" id="kobo.53.1"> started discussing the design of a new programming language that would solve some problems they were experiencing when writing software at Google, such as the increased complexity to use some languages, long code compilation times, and not being able to program efficiently on </span><span class="No-Break"><span class="koboSpan" id="kobo.54.1">multiprocessor computers.</span></span></p>
<p><em class="italic"><span class="koboSpan" id="kobo.55.1">Rob Pike</span></em><span class="koboSpan" id="kobo.56.1"> was trying to take some concurrency and communicating channels ideas into C++, based on his earlier work on the Newsqueak language in 1988, as he describes in </span><em class="italic"><span class="koboSpan" id="kobo.57.1">Go: Ten years and climbing</span></em><span class="koboSpan" id="kobo.58.1"> (</span><em class="italic"><span class="koboSpan" id="kobo.59.1">Further reading</span></em><span class="koboSpan" id="kobo.60.1">) and </span><em class="italic"><span class="koboSpan" id="kobo.61.1">Less is exponentially more</span></em><span class="koboSpan" id="kobo.62.1"> (</span><em class="italic"><span class="koboSpan" id="kobo.63.1">Further reading</span></em><span class="koboSpan" id="kobo.64.1">). </span><span class="koboSpan" id="kobo.64.2">This turned out to be too hard to implement. </span><span class="koboSpan" id="kobo.64.3">He would work out of the same office with </span><em class="italic"><span class="koboSpan" id="kobo.65.1">Robert Griesemer</span></em><span class="koboSpan" id="kobo.66.1"> and </span><em class="italic"><span class="koboSpan" id="kobo.67.1">Ken Thompson</span></em><span class="koboSpan" id="kobo.68.1">. </span><span class="koboSpan" id="kobo.68.2">Ken had worked together with Rob Pike in the past to create the character-encoding UTF-8, while </span><em class="italic"><span class="koboSpan" id="kobo.69.1">Ken Thompson</span></em><span class="koboSpan" id="kobo.70.1"> had designed and implemented the Unix operating system and invented the B programming language (the predecessor to the C </span><span class="No-Break"><span class="koboSpan" id="kobo.71.1">programming language).</span></span></p>
<p><span class="koboSpan" id="kobo.72.1">They chose the name </span><strong class="bold"><span class="koboSpan" id="kobo.73.1">Go</span></strong><span class="koboSpan" id="kobo.74.1"> for</span><a id="_idIndexMarker075"/><span class="koboSpan" id="kobo.75.1"> this new programming language because it’s short, but the DNS entry for </span><a href="https://cloud.google.com/architecture/reduce-carbon-footprint"><span class="koboSpan" id="kobo.76.1">go.com</span></a><span class="koboSpan" id="kobo.77.1"> wasn’t available, so Go’s website ended up at </span><a href="https://docs.aws.amazon.com/awsaccountbilling/latest/aboutv2/what-is-ccft.html"><span class="koboSpan" id="kobo.78.1">golang.org</span></a><span class="koboSpan" id="kobo.79.1">. </span><span class="koboSpan" id="kobo.79.2">And so, </span><strong class="bold"><span class="koboSpan" id="kobo.80.1">golang</span></strong><span class="koboSpan" id="kobo.81.1"> became</span><a id="_idIndexMarker076"/><span class="koboSpan" id="kobo.82.1"> a nickname for Go. </span><span class="koboSpan" id="kobo.82.2">While golang is convenient for search queries, it’s not the name of the language (which </span><span class="No-Break"><span class="koboSpan" id="kobo.83.1">is Go):</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer015">
<span class="koboSpan" id="kobo.84.1"><img alt="Figure 2.1 – The initial Go discussion email thread " src="image/B16971_02_01.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.85.1">Figure 2.1 – The initial Go discussion email thread</span></p>
<p><span class="koboSpan" id="kobo.86.1">Though they</span><a id="_idIndexMarker077"/><span class="koboSpan" id="kobo.87.1"> initially thought of C/C++ to be the starting point, they ended up starting from scratch to define a more expressive language, despite a large number of simplifications when compared to its predecessors. </span><span class="koboSpan" id="kobo.87.2">Go inherits some things from C, such as, but not limited to, basic data types, expression syntax, pointers, and compilation to machine code, but it doesn’t have things such as the following: </span></p>
<ul>
<li><span class="No-Break"><span class="koboSpan" id="kobo.88.1">Header files</span></span></li>
<li><span class="No-Break"><span class="koboSpan" id="kobo.89.1">Exceptions</span></span></li>
<li><span class="No-Break"><span class="koboSpan" id="kobo.90.1">Pointer arithmetic</span></span></li>
<li><span class="koboSpan" id="kobo.91.1">Subtype inheritance (</span><span class="No-Break"><span class="koboSpan" id="kobo.92.1">no subclasses)</span></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.93.1">this</span></strong> <span class="No-Break"><span class="koboSpan" id="kobo.94.1">in methods</span></span></li>
<li><span class="koboSpan" id="kobo.95.1">Promotion to a superclass (it uses </span><span class="No-Break"><span class="koboSpan" id="kobo.96.1">embedding instead)</span></span></li>
<li><span class="No-Break"><span class="koboSpan" id="kobo.97.1">Circular dependencies</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.98.1">Pascal, Oberon, and Newsqueak are among the programming languages that have influenced Go. </span><span class="koboSpan" id="kobo.98.2">In particular, its</span><a id="_idIndexMarker078"/><span class="koboSpan" id="kobo.99.1"> concurrency model comes from </span><em class="italic"><span class="koboSpan" id="kobo.100.1">Tony Hoare</span></em><span class="koboSpan" id="kobo.101.1">’s </span><strong class="bold"><span class="koboSpan" id="kobo.102.1">Communicating Sequential Processes</span></strong><span class="koboSpan" id="kobo.103.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.104.1">CSPs</span></strong><span class="koboSpan" id="kobo.105.1">) (</span><em class="italic"><span class="koboSpan" id="kobo.106.1">Further reading</span></em><span class="koboSpan" id="kobo.107.1">) white paper, and CSP’s implementations in </span><em class="italic"><span class="koboSpan" id="kobo.108.1">Rob Pike</span></em><span class="koboSpan" id="kobo.109.1">’s interpreted language Newsqueak and, later, Phil Winterbottom’s C-like compiled version, Alef. </span><span class="koboSpan" id="kobo.109.2">The next figure shows Go’s </span><span class="No-Break"><span class="koboSpan" id="kobo.110.1">family tree:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer016">
<span class="koboSpan" id="kobo.111.1"><img alt="Figure 2.2 – The Go ancestors " src="image/B16971_02_02.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.112.1">Figure 2.2 – The Go ancestors</span></p>
<p><span class="koboSpan" id="kobo.113.1">The number of </span><a id="_idIndexMarker079"/><span class="koboSpan" id="kobo.114.1">C++ programmers that come to Go is just a few compared to what the Go founders expected. </span><span class="koboSpan" id="kobo.114.2">Most Go programmers actually come from languages such as Python </span><span class="No-Break"><span class="koboSpan" id="kobo.115.1">and Ruby.</span></span></p>
<p><span class="koboSpan" id="kobo.116.1">Go became an open source project on November 10, 2009. </span><span class="koboSpan" id="kobo.116.2">They host Go’s source code at </span><a href="https://www.microsoft.com/en-us/sustainability/emissions-impact-dashboard?activetab=pivot_2%3aprimaryr12"><span class="koboSpan" id="kobo.117.1">https://go.googlesource.com/go</span></a><span class="koboSpan" id="kobo.118.1"> and keep a mirror of the code at </span><a href="https://cloud.google.com/carbon-footprint"><span class="koboSpan" id="kobo.119.1">https://github.com/golang/go</span></a><span class="koboSpan" id="kobo.120.1"> where you can submit pull requests. </span><span class="koboSpan" id="kobo.120.2">While Go is an open source programming language, it’s actually supported </span><span class="No-Break"><span class="koboSpan" id="kobo.121.1">by Google.</span></span></p>
<p><span class="koboSpan" id="kobo.122.1">They wrote the first Go compiler in C, but they later converted it to Go. </span><span class="koboSpan" id="kobo.122.2">Russ Cox describes this in detail in Go 1.3+ Compiler Overhaul (</span><em class="italic"><span class="koboSpan" id="kobo.123.1">Further reading</span></em><span class="koboSpan" id="kobo.124.1">). </span><span class="koboSpan" id="kobo.124.2">As mind-blowing as it may sound, the Go source code of today is written </span><span class="No-Break"><span class="koboSpan" id="kobo.125.1">in Go.</span></span></p>
<p><span class="koboSpan" id="kobo.126.1">They released Go 1 on March 28, 2012. </span><span class="koboSpan" id="kobo.126.2">We highlight some notable changes to the language since then in the summarized version of Go’s timeline in the </span><span class="No-Break"><span class="koboSpan" id="kobo.127.1">next figure:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer017">
<span class="koboSpan" id="kobo.128.1"><img alt="Figure 2.3 – Go's brief timeline " src="image/B16971_02_03.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.129.1">Figure 2.3 – Go’s brief timeline</span></p>
<p><span class="koboSpan" id="kobo.130.1">Go is a</span><a id="_idIndexMarker080"/><span class="koboSpan" id="kobo.131.1"> stable language, and the semantics should not change unless Go 2 happens. </span><span class="koboSpan" id="kobo.131.2">The only change that the Go team has confirmed at this point is the addition of generic programming using type parameters in early 2022 (Go 1.18), as described in the Type Parameters Proposal (</span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.132.1">Further reading</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.133.1">).</span></span></p>
<p><span class="koboSpan" id="kobo.134.1">Go is a programming language that attempts to combine the ease of programming of a dynamically typed language with the efficiency and safety of a statically typed language. </span><span class="koboSpan" id="kobo.134.2">It builds executable files in seconds, and with Go’s first-class support for concurrency, we can take full advantage of </span><span class="No-Break"><span class="koboSpan" id="kobo.135.1">multi-core CPUs.</span></span></p>
<p><span class="koboSpan" id="kobo.136.1">Before we dive into Go code, we cover some guiding principles that make Go unique through the </span><span class="No-Break"><span class="koboSpan" id="kobo.137.1">Go proverbs.</span></span></p>
<h1 id="_idParaDest-45"><a id="_idTextAnchor044"/><span class="koboSpan" id="kobo.138.1">Go Proverbs</span></h1>
<p><em class="italic"><span class="koboSpan" id="kobo.139.1">Rob Pike</span></em><span class="koboSpan" id="kobo.140.1"> introduced the</span><a id="_idIndexMarker081"/><span class="koboSpan" id="kobo.141.1"> Go language proverbs at </span><em class="italic"><span class="koboSpan" id="kobo.142.1">Gopherfest</span></em><span class="koboSpan" id="kobo.143.1"> in </span><em class="italic"><span class="koboSpan" id="kobo.144.1">2015</span></em><span class="koboSpan" id="kobo.145.1"> to explain or teach Go philosophically. </span><span class="koboSpan" id="kobo.145.2">These are general guidelines that Go developers tend to adhere to. </span><span class="koboSpan" id="kobo.145.3">Most of these proverbs are good practices – but optional – that convey the spirit of the language. </span></p>
<p><span class="koboSpan" id="kobo.146.1">We only include our favorite proverbs here. </span><span class="koboSpan" id="kobo.146.2">You can check out the full list at </span><em class="italic"><span class="koboSpan" id="kobo.147.1">Go Proverbs</span></em><span class="koboSpan" id="kobo.148.1"> (</span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.149.1">Further reading</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.150.1">):</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.151.1">Gofmt’s style is no one’s favorite, yet gofmt is everyone’s favorite. </span><span class="koboSpan" id="kobo.151.2">When you write code in Go, you don’t have to worry about the debate of white spaces versus tabs, or where you put braces or curly brackets. </span><span class="koboSpan" id="kobo.151.3">Gofmt (</span><strong class="source-inline"><span class="koboSpan" id="kobo.152.1">gofmt</span></strong><span class="koboSpan" id="kobo.153.1">) formats your code with a prescriptive style guide, so all Go code looks the same. </span><span class="koboSpan" id="kobo.153.2">This way, you don’t have to think about it when you write or read </span><span class="No-Break"><span class="koboSpan" id="kobo.154.1">Go code:</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.155.1">Clear is better than clever</span></strong><span class="koboSpan" id="kobo.156.1">: Go </span><a id="_idIndexMarker082"/><span class="koboSpan" id="kobo.157.1">favors clear code over clever code that is difficult to analyze or describe. </span><span class="koboSpan" id="kobo.157.2">Write code other people can read and with behavior they </span><span class="No-Break"><span class="koboSpan" id="kobo.158.1">can understand.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.159.1">Errors are values</span></strong><span class="koboSpan" id="kobo.160.1">: An error in Go is not an exception. </span><span class="koboSpan" id="kobo.160.2">It’s a value you can use in your program logic – as a variable, </span><span class="No-Break"><span class="koboSpan" id="kobo.161.1">for example.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.162.1">Don’t just check errors; handle them gracefully</span></strong><span class="koboSpan" id="kobo.163.1">: Go encourages you to think about whether you should do something with an error, instead of just returning it and forgetting about it. </span><span class="koboSpan" id="kobo.163.2">Depending on the error, maybe you can trigger a different execution path, add more info to it, or save it for later. </span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.164.1">A little copying is better than a little dependency</span></strong><span class="koboSpan" id="kobo.165.1">: If you only need a few lines from a library, maybe you can just copy those lines instead of importing the entire library to keep your dependency tree under control and make your code more compact. </span><span class="koboSpan" id="kobo.165.2">This way, your program not only compiles faster but is also more manageable and simpler </span><span class="No-Break"><span class="koboSpan" id="kobo.166.1">to understand.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.167.1">Don’t communicate by sharing memory; share memory by communicating</span></strong><span class="koboSpan" id="kobo.168.1">: This describes how concurrent processes in Go can coordinate between each other. </span><span class="koboSpan" id="kobo.168.2">In other languages, concurrent processes communicate by sharing memory, which you have to protect with locks to prevent a data race condition when these processes try to access a memory location concurrently. </span><span class="koboSpan" id="kobo.168.3">Go, in contrast, uses channels instead to pass references to data between processes, so only one process has access to the data at </span><span class="No-Break"><span class="koboSpan" id="kobo.169.1">a time.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.170.1">Concurrency is not parallelism</span></strong><span class="koboSpan" id="kobo.171.1">: Concurrency is structuring the execution of independent processes, whose instructions are not necessarily executed in sequence. </span><span class="koboSpan" id="kobo.171.2">Whether these instructions run in parallel depends on the availability of different CPU cores or </span><a id="_idIndexMarker083"/><span class="koboSpan" id="kobo.172.1">hardware threads. </span><em class="italic"><span class="koboSpan" id="kobo.173.1">Rob Pike</span></em><span class="koboSpan" id="kobo.174.1">’s </span><em class="italic"><span class="koboSpan" id="kobo.175.1">Concurrency is not Parallelism</span></em><span class="koboSpan" id="kobo.176.1"> (</span><em class="italic"><span class="koboSpan" id="kobo.177.1">Further reading</span></em><span class="koboSpan" id="kobo.178.1">) talk is a must for </span><span class="No-Break"><span class="koboSpan" id="kobo.179.1">Go developers.</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.180.1">The Go proverbs cover different aspects of Go, from formatting your Go code to how Go </span><span class="No-Break"><span class="koboSpan" id="kobo.181.1">achieves concurrency.</span></span></p>
<p><span class="koboSpan" id="kobo.182.1">Now, it’s time to roll up our sleeves as we start looking into Go source </span><span class="No-Break"><span class="koboSpan" id="kobo.183.1">code files.</span></span></p>
<h1 id="_idParaDest-46"><a id="_idTextAnchor045"/><span class="koboSpan" id="kobo.184.1">Go source code files</span></h1>
<p><span class="koboSpan" id="kobo.185.1">While there isn’t a filename convention for Go source code files, their filenames are typically one-word, all lowercase, and include an underscore if it has more than one word. </span><span class="koboSpan" id="kobo.185.2">It ends with the </span><strong class="source-inline"><span class="koboSpan" id="kobo.186.1">.</span></strong><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.187.1">go</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.188.1"> suffix.</span></span></p>
<p><span class="koboSpan" id="kobo.189.1">Each file has </span><span class="No-Break"><span class="koboSpan" id="kobo.190.1">three parts:</span></span></p>
<ul>
<li><strong class="bold"><span class="koboSpan" id="kobo.191.1">Package clause</span></strong><span class="koboSpan" id="kobo.192.1">: This </span><a id="_idIndexMarker084"/><span class="koboSpan" id="kobo.193.1">defines the name of the package a file </span><span class="No-Break"><span class="koboSpan" id="kobo.194.1">belongs to.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.195.1">Import declaration</span></strong><span class="koboSpan" id="kobo.196.1">: This is </span><a id="_idIndexMarker085"/><span class="koboSpan" id="kobo.197.1">a list of packages that you need </span><span class="No-Break"><span class="koboSpan" id="kobo.198.1">to import.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.199.1">Top-level declaration</span></strong><span class="koboSpan" id="kobo.200.1">: This </span><a id="_idIndexMarker086"/><span class="koboSpan" id="kobo.201.1">is constant, variable, type, function, and method declarations with a package scope. </span><span class="koboSpan" id="kobo.201.2">Every declaration here starts with a keyword (</span><strong class="source-inline"><span class="koboSpan" id="kobo.202.1">const</span></strong><span class="koboSpan" id="kobo.203.1">, </span><strong class="source-inline"><span class="koboSpan" id="kobo.204.1">var</span></strong><span class="koboSpan" id="kobo.205.1">, </span><strong class="source-inline"><span class="koboSpan" id="kobo.206.1">type</span></strong><span class="koboSpan" id="kobo.207.1">, </span><span class="No-Break"><span class="koboSpan" id="kobo.208.1">or </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.209.1">func</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.210.1">):</span></span></li>
</ul>
<pre class="source-code"><span class="Code_Brown"><span class="koboSpan" id="kobo.211.1">// package clause</span></span>
<span class="Code_Purple"><span class="koboSpan" id="kobo.212.1">package</span></span><span class="koboSpan" id="kobo.213.1"> main
</span><span class="Code_Brown"><span class="koboSpan" id="kobo.214.1">// import declaration</span></span>
<span class="Code_Purple"><span class="koboSpan" id="kobo.215.1">import</span></span> <span class="Code_Red"><span class="koboSpan" id="kobo.216.1">"fmt"</span></span>
<span class="Code_Brown"><span class="koboSpan" id="kobo.217.1">// top level declaration</span></span>
<span class="Code_Purple"><span class="koboSpan" id="kobo.218.1">const</span></span><span class="koboSpan" id="kobo.219.1"> s </span><span class="Code_Red"><span class="koboSpan" id="kobo.220.1">= "Hello, </span></span><span class="Code_Red"><span class="koboSpan" id="kobo.221.1">世界</span></span><span class="Code_Red"><span class="koboSpan" id="kobo.222.1">"</span></span>
<span class="Code_Purple"><span class="koboSpan" id="kobo.223.1">func</span></span><span class="koboSpan" id="kobo.224.1"> main() {
    fmt.Println(s)
}</span></pre>
<p><span class="koboSpan" id="kobo.225.1">The code example shows the package declaration for the </span><strong class="source-inline"><span class="koboSpan" id="kobo.226.1">main</span></strong><span class="koboSpan" id="kobo.227.1"> package at the top. </span><span class="koboSpan" id="kobo.227.2">It follows the import declaration, where we specify that we use the </span><strong class="source-inline"><span class="koboSpan" id="kobo.228.1">fmt</span></strong><span class="koboSpan" id="kobo.229.1"> package in this file. </span><span class="koboSpan" id="kobo.229.2">Then, we include all declarations in the code – in this case, an </span><strong class="source-inline"><span class="koboSpan" id="kobo.230.1">s</span></strong><span class="koboSpan" id="kobo.231.1"> constant and the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.232.1">main</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.233.1"> function.</span></span></p>
<h2 id="_idParaDest-47"><a id="_idTextAnchor046"/><span class="koboSpan" id="kobo.234.1">Packages</span></h2>
<p><span class="koboSpan" id="kobo.235.1">A package is </span><a id="_idIndexMarker087"/><span class="koboSpan" id="kobo.236.1">one or more </span><strong class="source-inline"><span class="koboSpan" id="kobo.237.1">.go</span></strong><span class="koboSpan" id="kobo.238.1"> files in the same folder that declares the related constants, types, variables, and functions. </span><span class="koboSpan" id="kobo.238.2">These declarations are accessible to every file in the same package, so breaking down the code into different files is optional. </span><span class="koboSpan" id="kobo.238.3">It’s more of a personal preference on how to better </span><span class="No-Break"><span class="koboSpan" id="kobo.239.1">organize code.</span></span></p>
<p><span class="koboSpan" id="kobo.240.1">In the standard library, they divide the code into separate files for larger packages. </span><span class="koboSpan" id="kobo.240.2">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.241.1">encoding/base64</span></strong><span class="koboSpan" id="kobo.242.1"> package has one </span><strong class="source-inline"><span class="koboSpan" id="kobo.243.1">.go</span></strong><span class="koboSpan" id="kobo.244.1"> file (other than the test and example files), such as </span><span class="No-Break"><span class="koboSpan" id="kobo.245.1">the following:</span></span></p>
<pre class="console"><span class="Code_Blue"><span class="koboSpan" id="kobo.246.1">$ ls -1</span></span><span class="koboSpan" id="kobo.247.1"> /usr/local/go/src/encoding/base64/ | </span><span class="Code_Blue"><span class="koboSpan" id="kobo.248.1">grep -v</span></span><span class="koboSpan" id="kobo.249.1"> _test.go
base64.go</span></pre>
<p><span class="koboSpan" id="kobo.250.1">By contrast, the </span><strong class="source-inline"><span class="koboSpan" id="kobo.251.1">encoding/json</span></strong><span class="koboSpan" id="kobo.252.1"> package has nine </span><strong class="source-inline"><span class="koboSpan" id="kobo.253.1">.go</span></strong><span class="koboSpan" id="kobo.254.1"> source </span><span class="No-Break"><span class="koboSpan" id="kobo.255.1">code files:</span></span></p>
<pre class="console"><span class="Code_Blue"><span class="koboSpan" id="kobo.256.1">$ ls -1</span></span><span class="koboSpan" id="kobo.257.1"> /usr/local/go/src/encoding/json/ | grep -v _test.go
decode.go
encode.go
fold.go
fuzz.go
indent.go
scanner.go
stream.go
tables.go
tags.go</span></pre>
<p><span class="koboSpan" id="kobo.258.1">Package </span><a id="_idIndexMarker088"/><span class="koboSpan" id="kobo.259.1">names are short and meaningful (no underscore). </span><span class="koboSpan" id="kobo.259.2">Users of a package refer to the package name when importing something from it – for example, the </span><strong class="source-inline"><span class="koboSpan" id="kobo.260.1">Decode</span></strong><span class="koboSpan" id="kobo.261.1"> method exists in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.262.1">json</span></strong><span class="koboSpan" id="kobo.263.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.264.1">xml</span></strong><span class="koboSpan" id="kobo.265.1"> packages. </span><span class="koboSpan" id="kobo.265.2">Users can call these methods with </span><strong class="source-inline"><span class="koboSpan" id="kobo.266.1">json.Decode</span></strong><span class="koboSpan" id="kobo.267.1"> and </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.268.1">xml.Decode</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.269.1">,</span></span><span class="No-Break"><span class="koboSpan" id="kobo.270.1"> respectively.</span></span></p>
<p><span class="koboSpan" id="kobo.271.1">One special package is </span><strong class="source-inline"><span class="koboSpan" id="kobo.272.1">main</span></strong><span class="koboSpan" id="kobo.273.1">. </span><span class="koboSpan" id="kobo.273.2">This is the entry point for any program that imports other packages. </span><span class="koboSpan" id="kobo.273.3">This package must have a </span><strong class="source-inline"><span class="koboSpan" id="kobo.274.1">main</span></strong><span class="koboSpan" id="kobo.275.1"> function that takes no arguments and returns no value, such as the code example at the beginning of </span><span class="No-Break"><span class="koboSpan" id="kobo.276.1">this section.</span></span></p>
<h2 id="_idParaDest-48"><a id="_idTextAnchor047"/><span class="koboSpan" id="kobo.277.1">Go modules</span></h2>
<p><span class="koboSpan" id="kobo.278.1">Go </span><a id="_idIndexMarker089"/><span class="koboSpan" id="kobo.279.1">modules became the default way to release packages in Go 1.16. </span><span class="koboSpan" id="kobo.279.2">They were first introduced in Go 1.11, back in 2018, to improve dependency management in Go. </span><span class="koboSpan" id="kobo.279.3">It allows you to define an import path and the dependencies for a package or collection </span><span class="No-Break"><span class="koboSpan" id="kobo.280.1">of packages.</span></span></p>
<p><span class="koboSpan" id="kobo.281.1">Let’s define a small package called </span><strong class="source-inline"><span class="koboSpan" id="kobo.282.1">ping</span></strong><span class="koboSpan" id="kobo.283.1">, with a </span><strong class="source-inline"><span class="koboSpan" id="kobo.284.1">Send</span></strong><span class="koboSpan" id="kobo.285.1"> function that returns a string with the </span><span class="No-Break"><span class="koboSpan" id="kobo.286.1">word </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.287.1">pong</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.288.1">:</span></span></p>
<pre class="source-code"><span class="Code_Purple"><span class="koboSpan" id="kobo.289.1">package</span></span><span class="koboSpan" id="kobo.290.1"> ping
</span><span class="Code_Purple"><span class="koboSpan" id="kobo.291.1">func</span></span><span class="koboSpan" id="kobo.292.1"> Send() </span><span class="Code_Purple"><span class="koboSpan" id="kobo.293.1">string</span></span><span class="koboSpan" id="kobo.294.1"> {
    </span><span class="Code_Purple"><span class="koboSpan" id="kobo.295.1">return</span></span> <span class="Code_Red"><span class="koboSpan" id="kobo.296.1">"pong"</span></span><span class="koboSpan" id="kobo.297.1">
}</span></pre>
<p><span class="koboSpan" id="kobo.298.1">This is the </span><a href="http://www.sustainableitplaybook.com"><span class="koboSpan" id="kobo.299.1">https://github.com/PacktPublishing/Network-Automation-with-Go/blob/main/ch02/ping/code.go</span></a><span class="koboSpan" id="kobo.300.1"> file in the book’s GitHub repository. </span><span class="koboSpan" id="kobo.300.2">You can create a module for this package with the </span><strong class="source-inline"><span class="koboSpan" id="kobo.301.1">go mod init</span></strong><span class="koboSpan" id="kobo.302.1"> command at the root folder of this example (</span><strong class="source-inline"><span class="koboSpan" id="kobo.303.1">ch02/ping</span></strong><span class="koboSpan" id="kobo.304.1">). </span><span class="koboSpan" id="kobo.304.2">The argument for this command should be the module location, where users can get access to it. </span><span class="koboSpan" id="kobo.304.3">The result is a </span><strong class="source-inline"><span class="koboSpan" id="kobo.305.1">go.mod</span></strong><span class="koboSpan" id="kobo.306.1"> file with the import path and a list of external package dependencies </span><span class="No-Break"><span class="koboSpan" id="kobo.307.1">in it:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.308.1">ch02/ping$ go mod init github.com/PacktPublishing/Network-Automation-with-Go/ch02/ping
go: creating new go.mod: module github.com/PacktPublishing/Network-Automation-with-Go/ch02/ping</span></pre>
<p><span class="koboSpan" id="kobo.309.1">With this, anyone can now</span><a id="_idIndexMarker090"/><span class="koboSpan" id="kobo.310.1"> import this package. </span><span class="koboSpan" id="kobo.310.2">The following program imports this package to the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.311.1">pong</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.312.1"> output:</span></span></p>
<pre class="source-code"><span class="Code_Purple"><span class="koboSpan" id="kobo.313.1">package</span></span><span class="koboSpan" id="kobo.314.1"> main
</span><span class="Code_Purple"><span class="koboSpan" id="kobo.315.1">import</span></span><span class="koboSpan" id="kobo.316.1"> (
    </span><span class="Code_Red"><span class="koboSpan" id="kobo.317.1">"fmt"</span></span>
<span class="Code_Red"><span class="koboSpan" id="kobo.318.1">    "github.com/PacktPublishing/Network-Automation-with-Go/ch02/ping"</span></span><span class="koboSpan" id="kobo.319.1">
)
</span><span class="Code_Purple"><span class="koboSpan" id="kobo.320.1">func</span></span><span class="koboSpan" id="kobo.321.1"> main() {
    s :</span><span class="Code_Red"><span class="koboSpan" id="kobo.322.1">=</span></span><span class="koboSpan" id="kobo.323.1"> ping.Send()
    fmt.Println(s)
}</span></pre>
<p><span class="koboSpan" id="kobo.324.1">You can run this program from the Go Playground (</span><em class="italic"><span class="koboSpan" id="kobo.325.1">Further reading</span></em><span class="koboSpan" id="kobo.326.1">), which imports the module we just created. </span><span class="koboSpan" id="kobo.326.2">This is also a great segue into the next section on packet importing and a sneak peek into the Go Playground section that we will cover in just a few </span><span class="No-Break"><span class="koboSpan" id="kobo.327.1">more pages.</span></span></p>
<h2 id="_idParaDest-49"><a id="_idTextAnchor048"/><span class="koboSpan" id="kobo.328.1">Importing packages</span></h2>
<p><span class="koboSpan" id="kobo.329.1">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.330.1">import</span></strong><span class="koboSpan" id="kobo.331.1"> keyword lists</span><a id="_idIndexMarker091"/><span class="koboSpan" id="kobo.332.1"> the packages to import in a source file. </span><span class="koboSpan" id="kobo.332.2">The import path is the module path, followed by the folder where the package is within the module, unless the package is in the standard library, in which case you only need to reference the directory. </span><span class="koboSpan" id="kobo.332.3">Let’s examine an example of </span><span class="No-Break"><span class="koboSpan" id="kobo.333.1">each scenario.</span></span></p>
<p><span class="koboSpan" id="kobo.334.1">To give an example, the </span><strong class="source-inline"><span class="koboSpan" id="kobo.335.1">google.golang.org/grpc</span></strong><span class="koboSpan" id="kobo.336.1"> module has a package in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.337.1">credentials</span></strong><span class="koboSpan" id="kobo.338.1"> folder. </span><span class="koboSpan" id="kobo.338.2">You would import it with </span><strong class="source-inline"><span class="koboSpan" id="kobo.339.1">google.golang.org/grpc/credentials</span></strong><span class="koboSpan" id="kobo.340.1">. </span><span class="koboSpan" id="kobo.340.2">The last part of the path is how you prefix the package types and functions, </span><strong class="source-inline"><span class="koboSpan" id="kobo.341.1">credentials.TransportCredentials</span></strong><span class="koboSpan" id="kobo.342.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.343.1">credentials.NewClientTLSFromFile</span></strong><span class="koboSpan" id="kobo.344.1">, respectively, in the next </span><span class="No-Break"><span class="koboSpan" id="kobo.345.1">code sample.</span></span></p>
<p><span class="koboSpan" id="kobo.346.1">Go’s standard</span><a id="_idIndexMarker092"/><span class="koboSpan" id="kobo.347.1"> library (</span><em class="italic"><span class="koboSpan" id="kobo.348.1">Further reading</span></em><span class="koboSpan" id="kobo.349.1">) at </span><strong class="source-inline"><span class="koboSpan" id="kobo.350.1">go/src</span></strong><span class="koboSpan" id="kobo.351.1"> is a collection of packages of the </span><strong class="source-inline"><span class="koboSpan" id="kobo.352.1">std</span></strong><span class="koboSpan" id="kobo.353.1"> module. </span><span class="koboSpan" id="kobo.353.2">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.354.1">fmt</span></strong><span class="koboSpan" id="kobo.355.1"> folder hosts the package that implements functions to format input and output. </span><span class="koboSpan" id="kobo.355.2">The path to import this package is </span><span class="No-Break"><span class="koboSpan" id="kobo.356.1">just </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.357.1">fmt</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.358.1">:</span></span></p>
<pre class="source-code"><span class="Code_Purple"><span class="koboSpan" id="kobo.359.1">package</span></span><span class="koboSpan" id="kobo.360.1"> xrgrpc
</span><span class="Code_Purple"><span class="koboSpan" id="kobo.361.1">import</span></span><span class="koboSpan" id="kobo.362.1"> (
    </span><span class="Code_Red"><span class="koboSpan" id="kobo.363.1">"fmt"</span></span><span class="koboSpan" id="kobo.364.1">
    </span><span class="Code_Brown"><span class="koboSpan" id="kobo.365.1">/* ... </span><span class="koboSpan" id="kobo.365.2">&lt;omitted for brevity &gt; ... </span><span class="koboSpan" id="kobo.365.3">*/</span></span><span class="koboSpan" id="kobo.366.1">
    </span><span class="Code_Red"><span class="koboSpan" id="kobo.367.1">"google.golang.org/grpc/credentials"</span></span><span class="koboSpan" id="kobo.368.1">
)
</span><span class="Code_Purple"><span class="koboSpan" id="kobo.369.1">func</span></span><span class="koboSpan" id="kobo.370.1"> newClientTLS(c client) (credentials.TransportCredentials, </span><span class="Code_Purple"><span class="koboSpan" id="kobo.371.1">error</span></span><span class="koboSpan" id="kobo.372.1">) {
    </span><span class="Code_Purple"><span class="koboSpan" id="kobo.373.1">if</span></span><span class="koboSpan" id="kobo.374.1"> c.Cert </span><span class="Code_Red"><span class="koboSpan" id="kobo.375.1">!= ""</span></span><span class="koboSpan" id="kobo.376.1"> {
                </span><span class="Code_Purple"><span class="koboSpan" id="kobo.377.1">return</span></span><span class="koboSpan" id="kobo.378.1"> credentials.NewClientTLSFromFile(...)
    }
    </span><span class="Code_Brown"><span class="koboSpan" id="kobo.379.1">/* ... </span><span class="koboSpan" id="kobo.379.2">&lt;omitted for brevity &gt; ... </span><span class="koboSpan" id="kobo.379.3">*/</span></span><span class="koboSpan" id="kobo.380.1">
    fmt.Printf(</span><span class="Code_Red"><span class="koboSpan" id="kobo.381.1">"%s"</span></span><span class="koboSpan" id="kobo.382.1">, </span><span class="Code_Red"><span class="koboSpan" id="kobo.383.1">'test'</span></span><span class="koboSpan" id="kobo.384.1">)
    </span><span class="Code_Brown"><span class="koboSpan" id="kobo.385.1">/* ... </span><span class="koboSpan" id="kobo.385.2">&lt;omitted for brevity &gt; ... </span><span class="koboSpan" id="kobo.385.3">*/</span></span><span class="koboSpan" id="kobo.386.1">
}</span></pre>
<p><span class="koboSpan" id="kobo.387.1">Packages do</span><a id="_idIndexMarker093"/><span class="koboSpan" id="kobo.388.1"> not live in a central repository such as </span><strong class="source-inline"><span class="koboSpan" id="kobo.389.1">maven</span></strong><span class="koboSpan" id="kobo.390.1">, </span><strong class="source-inline"><span class="koboSpan" id="kobo.391.1">pip</span></strong><span class="koboSpan" id="kobo.392.1">, or </span><strong class="source-inline"><span class="koboSpan" id="kobo.393.1">npm</span></strong><span class="koboSpan" id="kobo.394.1">. </span><span class="koboSpan" id="kobo.394.2">You can share your code by upstreaming it to a version control system and distribute it by sharing its location. </span><span class="koboSpan" id="kobo.394.3">Users can download it with the </span><strong class="source-inline"><span class="koboSpan" id="kobo.395.1">go</span></strong><span class="koboSpan" id="kobo.396.1"> command (</span><strong class="source-inline"><span class="koboSpan" id="kobo.397.1">go install</span></strong><span class="koboSpan" id="kobo.398.1"> or </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.399.1">go get</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.400.1">).</span></span></p>
<p><span class="koboSpan" id="kobo.401.1">For developing and testing purposes, you can reference local packages by pointing to their local path in the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.402.1">go.mod</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.403.1"> file:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.404.1">module github.com/PacktPublishing/Network-Automation-with-Go/ch02/pong
 
go 1.17
 
require github.com/PacktPublishing/Network-Automation-with-Go/ch02/ping v0.0.0-20220223180011-2e4e63479343
 
replace github.com/PacktPublishing/Network-Automation-with-Go/ch02/ping v1.0.0 =&gt; ../ping</span></pre>
<p><span class="koboSpan" id="kobo.405.1">In the </span><strong class="source-inline"><span class="koboSpan" id="kobo.406.1">ch02/pong</span></strong><span class="koboSpan" id="kobo.407.1"> example, the Go tool automatically created the first three lines of the </span><strong class="source-inline"><span class="koboSpan" id="kobo.408.1">go.mod</span></strong><span class="koboSpan" id="kobo.409.1"> file for us, referencing the ping module from the book’s GitHub repository (</span><em class="italic"><span class="koboSpan" id="kobo.410.1">Further reading</span></em><span class="koboSpan" id="kobo.411.1">). </span><span class="koboSpan" id="kobo.411.2">We later added a fourth line to replace that module, with the contents of the local version of it (</span><strong class="source-inline"><span class="koboSpan" id="kobo.412.1">../ping</span></strong><span class="koboSpan" id="kobo.413.1">). </span></p>
<h2 id="_idParaDest-50"><a id="_idTextAnchor049"/><span class="koboSpan" id="kobo.414.1">Comments</span></h2>
<p><span class="koboSpan" id="kobo.415.1">Code comments</span><a id="_idIndexMarker094"/><span class="koboSpan" id="kobo.416.1"> in Go play a key role, as they become your package documentation. </span><span class="koboSpan" id="kobo.416.2">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.417.1">go doc</span></strong><span class="koboSpan" id="kobo.418.1"> tool takes the comments preceding a type, constant, function, or method that you export in a package as a document string for that declaration, producing an HTML file that the tool presents as a web page. </span></p>
<p><span class="koboSpan" id="kobo.419.1">To give an example, all public Go packages (</span><em class="italic"><span class="koboSpan" id="kobo.420.1">Further reading</span></em><span class="koboSpan" id="kobo.421.1">) display this </span><span class="No-Break"><span class="koboSpan" id="kobo.422.1">autogenerated documentation.</span></span></p>
<p><span class="koboSpan" id="kobo.423.1">Go offers two ways to</span><a id="_idIndexMarker095"/> <span class="No-Break"><span class="koboSpan" id="kobo.424.1">create comments:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.425.1">C++-style </span><strong class="source-inline"><span class="koboSpan" id="kobo.426.1">//</span></strong><span class="koboSpan" id="kobo.427.1"> line comments, which is the most </span><span class="No-Break"><span class="koboSpan" id="kobo.428.1">common form:</span></span><pre class="console"><span class="Code_Brown"><span class="koboSpan" id="kobo.429.1">// IsPrivate reports whether ip is a private address, according to</span></span></pre><pre class="console"><span class="Code_Brown"><span class="koboSpan" id="kobo.430.1">// RFC 1918 (IPv4 addresses) and RFC 4193 (IPv6 addresses).</span></span></pre><pre class="console"><span class="Code_Purple"><span class="koboSpan" id="kobo.431.1">func</span></span><span class="koboSpan" id="kobo.432.1"> (ip IP) IsPrivate() </span><span class="Code_Purple"><span class="koboSpan" id="kobo.433.1">bool</span></span><span class="koboSpan" id="kobo.434.1"> {</span></pre><pre class="console"><span class="koboSpan" id="kobo.435.1">    </span><span class="Code_Purple"><span class="koboSpan" id="kobo.436.1">if</span></span><span class="koboSpan" id="kobo.437.1"> ip4 :</span><span class="Code_Red"><span class="koboSpan" id="kobo.438.1">=</span></span><span class="koboSpan" id="kobo.439.1"> ip.To4(); ip4 </span><span class="Code_Red"><span class="koboSpan" id="kobo.440.1">!=</span></span> <span class="Code_Blue"><span class="koboSpan" id="kobo.441.1">nil</span></span><span class="koboSpan" id="kobo.442.1"> {</span></pre><pre class="console"><span class="koboSpan" id="kobo.443.1">        </span><span class="Code_Purple"><span class="koboSpan" id="kobo.444.1">return</span></span><span class="koboSpan" id="kobo.445.1"> ip4[</span><span class="Code_Green"><span class="koboSpan" id="kobo.446.1">0</span></span><span class="koboSpan" id="kobo.447.1">] </span><span class="Code_Red"><span class="koboSpan" id="kobo.448.1">==</span></span> <span class="Code_Green"><span class="koboSpan" id="kobo.449.1">10</span></span> <span class="Code_Red"><span class="koboSpan" id="kobo.450.1">||</span></span></pre><pre class="console"><span class="koboSpan" id="kobo.451.1">            (ip4[</span><span class="Code_Green"><span class="koboSpan" id="kobo.452.1">0</span></span><span class="koboSpan" id="kobo.453.1">] </span><span class="Code_Red"><span class="koboSpan" id="kobo.454.1">==</span></span> <span class="Code_Green"><span class="koboSpan" id="kobo.455.1">172</span></span> <span class="Code_Red"><span class="koboSpan" id="kobo.456.1">&amp;&amp;</span></span><span class="koboSpan" id="kobo.457.1"> ip4[</span><span class="Code_Green"><span class="koboSpan" id="kobo.458.1">1</span></span><span class="koboSpan" id="kobo.459.1">]</span><span class="Code_Red"><span class="koboSpan" id="kobo.460.1">&amp;</span></span><span class="Code_Green"><span class="koboSpan" id="kobo.461.1">0xf0</span></span> <span class="Code_Red"><span class="koboSpan" id="kobo.462.1">==</span></span> <span class="Code_Green"><span class="koboSpan" id="kobo.463.1">16</span></span><span class="koboSpan" id="kobo.464.1">) ||</span></pre><pre class="console"><span class="koboSpan" id="kobo.465.1">            (ip4[</span><span class="Code_Green"><span class="koboSpan" id="kobo.466.1">0</span></span><span class="koboSpan" id="kobo.467.1">] </span><span class="Code_Red"><span class="koboSpan" id="kobo.468.1">==</span></span> <span class="Code_Green"><span class="koboSpan" id="kobo.469.1">192</span></span> <span class="Code_Red"><span class="koboSpan" id="kobo.470.1">&amp;&amp;</span></span><span class="koboSpan" id="kobo.471.1"> ip4[</span><span class="Code_Green"><span class="koboSpan" id="kobo.472.1">1</span></span><span class="koboSpan" id="kobo.473.1">] </span><span class="Code_Red"><span class="koboSpan" id="kobo.474.1">==</span></span> <span class="Code_Green"><span class="koboSpan" id="kobo.475.1">168</span></span><span class="koboSpan" id="kobo.476.1">)</span></pre><pre class="console"><span class="koboSpan" id="kobo.477.1">    }</span></pre><pre class="console"><span class="koboSpan" id="kobo.478.1">    </span><span class="Code_Purple"><span class="koboSpan" id="kobo.479.1">return</span></span> <span class="Code_Blue"><span class="koboSpan" id="kobo.480.1">len</span></span><span class="koboSpan" id="kobo.481.1">(ip) </span><span class="Code_Red"><span class="koboSpan" id="kobo.482.1">==</span></span><span class="koboSpan" id="kobo.483.1"> IPv6len </span><span class="Code_Red"><span class="koboSpan" id="kobo.484.1">&amp;&amp;</span></span><span class="koboSpan" id="kobo.485.1"> ip[0]</span><span class="Code_Red"><span class="koboSpan" id="kobo.486.1">&amp;</span></span><span class="Code_Green"><span class="koboSpan" id="kobo.487.1">0xfe</span></span> <span class="Code_Red"><span class="koboSpan" id="kobo.488.1">==</span></span> <span class="Code_Green"><span class="koboSpan" id="kobo.489.1">0xfc</span></span></pre><pre class="console"><span class="koboSpan" id="kobo.490.1">}</span></pre></li>
<li><span class="koboSpan" id="kobo.491.1">C-style </span><strong class="source-inline"><span class="koboSpan" id="kobo.492.1">/* */</span></strong><span class="koboSpan" id="kobo.493.1"> block comments, which are primarily for package descriptions or large blocks of </span><span class="No-Break"><span class="koboSpan" id="kobo.494.1">formatted/indented code:</span></span><pre class="console"><span class="Code_Brown"><span class="koboSpan" id="kobo.495.1">/*</span></span></pre><pre class="console"><span class="Code_Brown"><span class="koboSpan" id="kobo.496.1">Copyright 2014 The Kubernetes Authors.</span></span></pre><pre class="console"><span class="Code_Brown"><span class="koboSpan" id="kobo.497.1">Licensed under the Apache License, Version 2.0 (the "License");</span></span></pre><pre class="console"><span class="Code_Brown"><span class="koboSpan" id="kobo.498.1">...</span></span></pre><pre class="console"><span class="Code_Brown"><span class="koboSpan" id="kobo.499.1">See the License for the specific language governing permissions and</span></span></pre><pre class="console"><span class="Code_Brown"><span class="koboSpan" id="kobo.500.1">limitations under the License.</span></span></pre><pre class="console"><span class="Code_Brown"><span class="koboSpan" id="kobo.501.1">*/</span></span></pre><pre class="console"><span class="Code_Purple"><span class="koboSpan" id="kobo.502.1">package</span></span><span class="koboSpan" id="kobo.503.1"> kubectl</span></pre></li>
</ul>
<p><span class="koboSpan" id="kobo.504.1">Dave Cheney in </span><em class="italic"><span class="koboSpan" id="kobo.505.1">Practical Go: Real-world advice for writing maintainable Go programs</span></em><span class="koboSpan" id="kobo.506.1"> (</span><em class="italic"><span class="koboSpan" id="kobo.507.1">Further reading</span></em><span class="koboSpan" id="kobo.508.1">) suggests that a code comment should explain one – and only one – of these </span><span class="No-Break"><span class="koboSpan" id="kobo.509.1">three things:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.510.1">What </span><span class="No-Break"><span class="koboSpan" id="kobo.511.1">it does</span></span></li>
<li><span class="koboSpan" id="kobo.512.1">How something does what </span><span class="No-Break"><span class="koboSpan" id="kobo.513.1">it does</span></span></li>
<li><span class="koboSpan" id="kobo.514.1">Why something is why </span><span class="No-Break"><span class="koboSpan" id="kobo.515.1">it is</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.516.1">A good practice is to make comments on variables that describe their contents, rather than their purpose. </span><span class="koboSpan" id="kobo.516.2">You could use the name of the variable to describe its purpose. </span><span class="koboSpan" id="kobo.516.3">This brings us to the </span><span class="No-Break"><span class="koboSpan" id="kobo.517.1">naming style.</span></span></p>
<h2 id="_idParaDest-51"><a id="_idTextAnchor050"/><span class="koboSpan" id="kobo.518.1">Names</span></h2>
<p><span class="koboSpan" id="kobo.519.1">The convention for declaring names</span><a id="_idIndexMarker096"/><span class="koboSpan" id="kobo.520.1"> in Go is to use camel case (MixedCaps or mixedCaps) instead of, for example, dashes or underscores when you use more than one word for the name of a function or variable. </span><span class="koboSpan" id="kobo.520.2">The exception to the rule are acronyms that have a consistent case, such as </span><strong class="source-inline"><span class="koboSpan" id="kobo.521.1">ServeHTTP</span></strong><span class="koboSpan" id="kobo.522.1"> and </span><span class="No-Break"><span class="koboSpan" id="kobo.523.1">not </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.524.1">ServeHttp</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.525.1">:</span></span></p>
<pre class="source-code"><span class="Code_Purple"><span class="koboSpan" id="kobo.526.1">package</span></span><span class="koboSpan" id="kobo.527.1"> net
</span><span class="Code_Brown"><span class="koboSpan" id="kobo.528.1">// IsMulticast reports whether ip is a multicast address.</span></span>
<span class="Code_Purple"><span class="koboSpan" id="kobo.529.1">func</span></span><span class="koboSpan" id="kobo.530.1"> (ip IP) IsMulticast() </span><span class="Code_Purple"><span class="koboSpan" id="kobo.531.1">bool</span></span><span class="koboSpan" id="kobo.532.1"> {
     </span><span class="Code_Purple"><span class="koboSpan" id="kobo.533.1">if</span></span><span class="koboSpan" id="kobo.534.1"> ip4 :</span><span class="Code_Red"><span class="koboSpan" id="kobo.535.1">=</span></span><span class="koboSpan" id="kobo.536.1"> ip.To4(); ip4 </span><span class="Code_Red"><span class="koboSpan" id="kobo.537.1">!=</span></span> <span class="Code_Blue"><span class="koboSpan" id="kobo.538.1">nil</span></span><span class="koboSpan" id="kobo.539.1"> {
         </span><span class="Code_Purple"><span class="koboSpan" id="kobo.540.1">return</span></span><span class="koboSpan" id="kobo.541.1"> ip4[</span><span class="Code_Green"><span class="koboSpan" id="kobo.542.1">0</span></span><span class="koboSpan" id="kobo.543.1">]</span><span class="Code_Red"><span class="koboSpan" id="kobo.544.1">&amp;</span></span><span class="Code_Green"><span class="koboSpan" id="kobo.545.1">0xf0</span></span> <span class="Code_Red"><span class="koboSpan" id="kobo.546.1">==</span></span> <span class="Code_Green"><span class="koboSpan" id="kobo.547.1">0xe0</span></span><span class="koboSpan" id="kobo.548.1">
     }
     </span><span class="Code_Purple"><span class="koboSpan" id="kobo.549.1">return</span></span> <span class="Code_Blue"><span class="koboSpan" id="kobo.550.1">len</span></span><span class="koboSpan" id="kobo.551.1">(ip) </span><span class="Code_Red"><span class="koboSpan" id="kobo.552.1">==</span></span><span class="koboSpan" id="kobo.553.1"> IPv6len </span><span class="Code_Red"><span class="koboSpan" id="kobo.554.1">&amp;&amp;</span></span><span class="koboSpan" id="kobo.555.1"> ip[</span><span class="Code_Green"><span class="koboSpan" id="kobo.556.1">0</span></span><span class="koboSpan" id="kobo.557.1">] </span><span class="Code_Red"><span class="koboSpan" id="kobo.558.1">==</span></span> <span class="Code_Green"><span class="koboSpan" id="kobo.559.1">0xff</span></span><span class="koboSpan" id="kobo.560.1">
}</span></pre>
<p><span class="koboSpan" id="kobo.561.1">The first letter of the name determines whether the package exports this top-level declaration. </span><span class="koboSpan" id="kobo.561.2">Packages export names that start with a capital letter. </span><span class="koboSpan" id="kobo.561.3">These names are the only ones an external user of the package can reference when importing the package – for example, you can reference </span><strong class="source-inline"><span class="koboSpan" id="kobo.562.1">IsMulticast</span></strong><span class="koboSpan" id="kobo.563.1"> in the preceding code sample from another package </span><span class="No-Break"><span class="koboSpan" id="kobo.564.1">as </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.565.1">net.IsMulticast</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.566.1">:</span></span></p>
<pre class="source-code"><span class="Code_Purple"><span class="koboSpan" id="kobo.567.1">package</span></span><span class="koboSpan" id="kobo.568.1"> net
</span><span class="Code_Red"><span class="koboSpan" id="kobo.569.1">func</span></span><span class="koboSpan" id="kobo.570.1"> allFF(b []</span><span class="Code_Purple"><span class="koboSpan" id="kobo.571.1">byte</span></span><span class="koboSpan" id="kobo.572.1">) </span><span class="Code_Purple"><span class="koboSpan" id="kobo.573.1">bool</span></span><span class="koboSpan" id="kobo.574.1"> {
     </span><span class="Code_Purple"><span class="koboSpan" id="kobo.575.1">for</span></span><span class="koboSpan" id="kobo.576.1"> _, c :</span><span class="Code_Red"><span class="koboSpan" id="kobo.577.1">=</span></span> <span class="Code_Purple"><span class="koboSpan" id="kobo.578.1">range</span></span><span class="koboSpan" id="kobo.579.1"> b {
          </span><span class="Code_Purple"><span class="koboSpan" id="kobo.580.1">if</span></span><span class="koboSpan" id="kobo.581.1"> c </span><span class="Code_Red"><span class="koboSpan" id="kobo.582.1">!=</span></span> <span class="Code_Green"><span class="koboSpan" id="kobo.583.1">0xff</span></span><span class="koboSpan" id="kobo.584.1"> {
                 </span><span class="Code_Purple"><span class="koboSpan" id="kobo.585.1">return</span></span> <span class="Code_Blue"><span class="koboSpan" id="kobo.586.1">false</span></span><span class="koboSpan" id="kobo.587.1">
          }
     }
     </span><span class="Code_Purple"><span class="koboSpan" id="kobo.588.1">return</span></span> <span class="Code_Blue"><span class="koboSpan" id="kobo.589.1">true</span></span><span class="koboSpan" id="kobo.590.1">
}</span></pre>
<p><span class="koboSpan" id="kobo.591.1">If the first letter is lowercase, no other package has access to this resource. </span><span class="koboSpan" id="kobo.591.2">Packages can have declarations that are only for internal consumption. </span><span class="koboSpan" id="kobo.591.3">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.592.1">allFF</span></strong><span class="koboSpan" id="kobo.593.1"> function in the last code example comes from the </span><strong class="source-inline"><span class="koboSpan" id="kobo.594.1">net</span></strong><span class="koboSpan" id="kobo.595.1"> package. </span><span class="koboSpan" id="kobo.595.2">This means only functions in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.596.1">net</span></strong><span class="koboSpan" id="kobo.597.1"> package can call the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.598.1">allFF</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.599.1"> function.</span></span></p>
<p><span class="koboSpan" id="kobo.600.1">Languages such as Java </span><a id="_idIndexMarker097"/><span class="koboSpan" id="kobo.601.1">and C++ have explicit keywords such as </span><strong class="source-inline"><span class="koboSpan" id="kobo.602.1">public</span></strong><span class="koboSpan" id="kobo.603.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.604.1">private</span></strong><span class="koboSpan" id="kobo.605.1"> to control access to types and methods. </span><span class="koboSpan" id="kobo.605.2">Python follows the convention of naming variables or methods for internal use with a single underscore prefix. </span><span class="koboSpan" id="kobo.605.3">In Go, you can access any variable or method that starts with a lowercase letter from any source code file within the package, but not from </span><span class="No-Break"><span class="koboSpan" id="kobo.606.1">another package.</span></span></p>
<h2 id="_idParaDest-52"><a id="_idTextAnchor051"/><span class="koboSpan" id="kobo.607.1">Executing your Go code</span></h2>
<p><span class="koboSpan" id="kobo.608.1">The </span><a id="_idIndexMarker098"/><span class="koboSpan" id="kobo.609.1">Go compiler translates Go programs into machine code, producing a binary file. </span><span class="koboSpan" id="kobo.609.2">Aside from your program, the binary includes the Go runtime, which offers services such as garbage collection and concurrency. </span><span class="koboSpan" id="kobo.609.3">Having access to binary files that work for different platforms makes Go programs </span><span class="No-Break"><span class="koboSpan" id="kobo.610.1">very portable.</span></span></p>
<p><span class="koboSpan" id="kobo.611.1">Let’s compile the </span><a href="https://www.cio.gov/assets/files/Application-Rationalization-Playbook.pdf"><span class="koboSpan" id="kobo.612.1">https://github.com/PacktPublishing/Network-Automation-with-Go/blob/main/ch02/pong/code.go</span></a><span class="koboSpan" id="kobo.613.1"> file of the book’s GitHub repository with the </span><strong class="source-inline"><span class="koboSpan" id="kobo.614.1">go build</span></strong><span class="koboSpan" id="kobo.615.1"> command. </span><span class="koboSpan" id="kobo.615.2">You can also time this operation with the </span><strong class="source-inline"><span class="koboSpan" id="kobo.616.1">time</span></strong><span class="koboSpan" id="kobo.617.1"> command to see how fast Go builds </span><span class="No-Break"><span class="koboSpan" id="kobo.618.1">really are:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.619.1">ch02/pong$ time go build
real  0m0.154s
user  0m0.190s
sys   0m0.070s</span></pre>
<p><span class="koboSpan" id="kobo.620.1">Now, you can execute the binary file. </span><span class="koboSpan" id="kobo.620.2">The default filename is the package name, </span><strong class="source-inline"><span class="koboSpan" id="kobo.621.1">pong</span></strong><span class="koboSpan" id="kobo.622.1">. </span><span class="koboSpan" id="kobo.622.2">You can change the filename with the </span><strong class="source-inline"><span class="koboSpan" id="kobo.623.1">-o</span></strong><span class="koboSpan" id="kobo.624.1"> option of the </span><strong class="source-inline"><span class="koboSpan" id="kobo.625.1">go build</span></strong><span class="koboSpan" id="kobo.626.1"> command. </span><span class="koboSpan" id="kobo.626.2">There will be more on this in the </span><em class="italic"><span class="koboSpan" id="kobo.627.1">Go </span></em><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.628.1">tool</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.629.1"> section:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.630.1">ch02/pong$ ./pong
pong</span></pre>
<p><span class="koboSpan" id="kobo.631.1">If you don’t </span><a id="_idIndexMarker099"/><span class="koboSpan" id="kobo.632.1">want to generate a binary or executable file and only run the code, you can use the </span><strong class="source-inline"><span class="koboSpan" id="kobo.633.1">go run</span></strong> <span class="No-Break"><span class="koboSpan" id="kobo.634.1">command instead:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.635.1">ch02/pong$ go run main.go 
pong</span></pre>
<p><span class="koboSpan" id="kobo.636.1">Either option is fine, and it probably comes down to a matter of personal preference or whether you intend to share the compiled artifact with others or deploy it </span><span class="No-Break"><span class="koboSpan" id="kobo.637.1">to servers.</span></span></p>
<p><span class="koboSpan" id="kobo.638.1">Go files have three main parts and they are organized into packages </span><span class="No-Break"><span class="koboSpan" id="kobo.639.1">and modules.</span></span></p>
<p><span class="koboSpan" id="kobo.640.1">You can run all the examples on your computer after installing Go, or you can run them online, as we discuss in the </span><span class="No-Break"><span class="koboSpan" id="kobo.641.1">next section.</span></span></p>
<h1 id="_idParaDest-53"><a id="_idTextAnchor052"/><span class="koboSpan" id="kobo.642.1">Running Go programs online</span></h1>
<p><span class="koboSpan" id="kobo.643.1">Sometimes, you</span><a id="_idIndexMarker100"/><span class="koboSpan" id="kobo.644.1"> need to test some code quickly or just want to share a code example with someone who might not have Go installed on their computer. </span><span class="koboSpan" id="kobo.644.2">In those situations, there are at least three websites where you can run and share Go code </span><span class="No-Break"><span class="koboSpan" id="kobo.645.1">for free:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.646.1">The </span><span class="No-Break"><span class="koboSpan" id="kobo.647.1">Go Playground</span></span></li>
<li><span class="koboSpan" id="kobo.648.1">The Go </span><span class="No-Break"><span class="koboSpan" id="kobo.649.1">Play Space</span></span></li>
<li><span class="koboSpan" id="kobo.650.1">The </span><span class="No-Break"><span class="koboSpan" id="kobo.651.1">Gotip Playground</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.652.1">They all share the backend infrastructure, but with </span><span class="No-Break"><span class="koboSpan" id="kobo.653.1">subtle differences.</span></span></p>
<h2 id="_idParaDest-54"><a id="_idTextAnchor053"/><span class="koboSpan" id="kobo.654.1">The Go Playground</span></h2>
<p><span class="koboSpan" id="kobo.655.1">The Go team runs the</span><a id="_idIndexMarker101"/><span class="koboSpan" id="kobo.656.1"> Go Playground (</span><a href="https://github.com/Green-Software-Foundation/awesome-green-software"><span class="koboSpan" id="kobo.657.1">https://play.golang.org/</span></a><span class="koboSpan" id="kobo.658.1">) on </span><a id="_idIndexMarker102"/><span class="koboSpan" id="kobo.659.1">golang.org’s servers. </span><span class="koboSpan" id="kobo.659.2">They shared some insights and its architecture in the article </span><em class="italic"><span class="koboSpan" id="kobo.660.1">Inside the Go Playground</span></em><span class="koboSpan" id="kobo.661.1"> (</span><em class="italic"><span class="koboSpan" id="kobo.662.1">Further reading</span></em><span class="koboSpan" id="kobo.663.1">), but more recently, </span><em class="italic"><span class="koboSpan" id="kobo.664.1">Brad Fitzpatrick</span></em><span class="koboSpan" id="kobo.665.1"> shared the history and the implementation details of the latest incarnation of the Go Playground (</span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.666.1">Further reading</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.667.1">).</span></span></p>
<p><span class="koboSpan" id="kobo.668.1">This service receives your program, runs it on a sandbox, and returns its output. </span><span class="koboSpan" id="kobo.668.2">This is very convenient if you are on your mobile phone, for example, and you want to verify the syntax of a function or </span><span class="No-Break"><span class="koboSpan" id="kobo.669.1">something else.</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer018">
<span class="koboSpan" id="kobo.670.1"><img alt="Figure 2.4 – The Go Playground " src="image/B16971_02_04.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.671.1">Figure 2.4 – The Go Playground</span></p>
<p><span class="koboSpan" id="kobo.672.1">If you are curious about how they built this service or you want to run it locally in your environment, make sure you check out the Playground source code (</span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.673.1">Further reading</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.674.1">).</span></span></p>
<h2 id="_idParaDest-55"><a id="_idTextAnchor054"/><span class="koboSpan" id="kobo.675.1">The Go Play Space</span></h2>
<p><span class="koboSpan" id="kobo.676.1">If you can’t </span><a id="_idIndexMarker103"/><span class="koboSpan" id="kobo.677.1">live without syntax highlighting, go to the Go Play Space (</span><em class="italic"><span class="koboSpan" id="kobo.678.1">Further reading</span></em><span class="koboSpan" id="kobo.679.1">). </span><span class="koboSpan" id="kobo.679.2">This is an experimental alternative Go Playground frontend. </span><span class="koboSpan" id="kobo.679.3">They proxy the code execution to the official Go Playground so that programs work the same. </span><span class="koboSpan" id="kobo.679.4">They also store shared snippets on the </span><a href="https://docs.aws.amazon.com/awsaccountbilling/latest/aboutv2/what-is-ccft.html"><span class="No-Break"><span class="koboSpan" id="kobo.680.1">golang.org</span></span></a><span class="No-Break"><span class="koboSpan" id="kobo.681.1"> servers:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer019">
<span class="koboSpan" id="kobo.682.1"><img alt="Figure 2.5 – The Go Play Space " src="image/B16971_02_05.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.683.1">Figure 2.5 – The Go Play Space</span></p>
<p><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.684.1">Figure 2</span></em></span><em class="italic"><span class="koboSpan" id="kobo.685.1">.5</span></em><span class="koboSpan" id="kobo.686.1"> shows some extra</span><a id="_idIndexMarker104"/><span class="koboSpan" id="kobo.687.1"> features that the Go Play Space includes besides syntax highlighting, such as auto-closing braces, access to documentation, and different </span><span class="No-Break"><span class="koboSpan" id="kobo.688.1">UI themes.</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer020">
<span class="koboSpan" id="kobo.689.1"><img alt="Figure 2.6 – Building a house in the Go Play Space " src="image/B16971_02_06.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.690.1">Figure 2.6 – Building a house in the Go Play Space</span></p>
<p><span class="koboSpan" id="kobo.691.1">We could not pass over the fact that it also has a Turtle graphics mode to help you visualize algorithms for fun, such as having a gopher build a house, as shown in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.692.1">Figure 2</span></em></span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.693.1">.6</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.694.1">.</span></span></p>
<h2 id="_idParaDest-56"><a id="_idTextAnchor055"/><span class="koboSpan" id="kobo.695.1">A look into the Future</span></h2>
<p><span class="koboSpan" id="kobo.696.1">The Gotip Playground</span><a id="_idIndexMarker105"/><span class="koboSpan" id="kobo.697.1"> runs on golang.org’s servers as well. </span><span class="koboSpan" id="kobo.697.2">This instance of the Go playground runs the latest development branch of Go. </span><span class="koboSpan" id="kobo.697.3">You can use it to test upcoming features that are in active development, such as the syntax described in the Type Parameters Proposal (</span><em class="italic"><span class="koboSpan" id="kobo.698.1">Further reading</span></em><span class="koboSpan" id="kobo.699.1">) or the new </span><strong class="source-inline"><span class="koboSpan" id="kobo.700.1">net/netip</span></strong><span class="koboSpan" id="kobo.701.1"> package, without having to install more than one Go version on your system if you don’t </span><span class="No-Break"><span class="koboSpan" id="kobo.702.1">want to.</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer021">
<span class="koboSpan" id="kobo.703.1"><img alt="Figure 2.7 – The Gotip Playground " src="image/Figure_2.7.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.704.1">Figure 2.7 – The Gotip Playground</span></p>
<p><span class="koboSpan" id="kobo.705.1">You can access the Gotip Playground</span><a id="_idIndexMarker106"/><span class="koboSpan" id="kobo.706.1"> via </span><a href="https://docs.aws.amazon.com/awsaccountbilling/latest/aboutv2/what-is-ccft.html"><span class="koboSpan" id="kobo.707.1">https://gotipplay.golang.org/</span></a><span class="koboSpan" id="kobo.708.1"> or by selecting the </span><strong class="bold"><span class="koboSpan" id="kobo.709.1">Go dev branch</span></strong><span class="koboSpan" id="kobo.710.1"> dropdown </span><span class="No-Break"><span class="koboSpan" id="kobo.711.1">at </span></span><a href="https://www.microsoft.com/en-us/sustainability/emissions-impact-dashboard?activetab=pivot_2:primaryr12"><span class="No-Break"><span class="koboSpan" id="kobo.712.1">https://go.dev/play/</span></span></a><span class="No-Break"><span class="koboSpan" id="kobo.713.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.714.1">These are all great options to run Go programs online that are available to you at no cost. </span><span class="koboSpan" id="kobo.714.2">In the next section, we go back to working on the command line as we explore the Go tool to manage Go </span><span class="No-Break"><span class="koboSpan" id="kobo.715.1">source code.</span></span></p>
<h1 id="_idParaDest-57"><a id="_idTextAnchor056"/><span class="koboSpan" id="kobo.716.1">The Go tool</span></h1>
<p><span class="koboSpan" id="kobo.717.1">One of the </span><a id="_idIndexMarker107"/><span class="koboSpan" id="kobo.718.1">convenient things about Go – as a programming language – is that a single tool handles all interactions with, and operations on, the source code. </span><span class="koboSpan" id="kobo.718.2">When installing Go, make sure that the </span><strong class="source-inline"><span class="koboSpan" id="kobo.719.1">go</span></strong><span class="koboSpan" id="kobo.720.1"> tool is in the searchable OS path so that you can invoke it from any command-line terminal. </span><span class="koboSpan" id="kobo.720.2">The user experience, regardless of the OS or platform architecture, is uniform and doesn’t require any customization when moving from one machine to another. </span></p>
<p><span class="koboSpan" id="kobo.721.1">IDEs also use the </span><strong class="source-inline"><span class="koboSpan" id="kobo.722.1">go</span></strong><span class="koboSpan" id="kobo.723.1"> tool to build and run code, report errors, and automatically format Go source code. </span><span class="koboSpan" id="kobo.723.2">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.724.1">go</span></strong><span class="koboSpan" id="kobo.725.1"> executable accepts a </span><em class="italic"><span class="koboSpan" id="kobo.726.1">verb</span></em><span class="koboSpan" id="kobo.727.1"> as the first argument that determines what </span><strong class="source-inline"><span class="koboSpan" id="kobo.728.1">go</span></strong><span class="koboSpan" id="kobo.729.1"> tool function to apply to Go </span><span class="No-Break"><span class="koboSpan" id="kobo.730.1">source files:</span></span></p>
<pre class="console"><span class="Code_Blue"><span class="koboSpan" id="kobo.731.1">$</span></span><span class="koboSpan" id="kobo.732.1"> go 
Go is a tool </span><span class="Code_Purple"><span class="koboSpan" id="kobo.733.1">for</span></span><span class="koboSpan" id="kobo.734.1"> managing Go </span><span class="Code_Blue"><span class="koboSpan" id="kobo.735.1">source</span></span><span class="koboSpan" id="kobo.736.1"> code.
</span><span class="koboSpan" id="kobo.736.2">Usage:
     go &lt;command&gt; [arguments]
The commands are:
     bug         </span><span class="Code_Blue"><span class="koboSpan" id="kobo.737.1">start</span></span><span class="koboSpan" id="kobo.738.1"> a bug report
     build       compile packages and dependencies
     ...       
     mod         module maintenance
     run         compile and run Go program
     test        test packages
     tool        run specified go tool
     version     print Go version
     vet         report likely mistakes in packages</span></pre>
<p><span class="koboSpan" id="kobo.739.1">We’re only exploring a subset of the functions</span><a id="_idIndexMarker108"/><span class="koboSpan" id="kobo.740.1"> of the Go tool in this section. </span><span class="koboSpan" id="kobo.740.2">You can find the full list and every detail of each one in the Go </span><strong class="source-inline"><span class="koboSpan" id="kobo.741.1">cmd</span></strong><span class="koboSpan" id="kobo.742.1"> documentation (</span><em class="italic"><span class="koboSpan" id="kobo.743.1">Further reading</span></em><span class="koboSpan" id="kobo.744.1">). </span><span class="koboSpan" id="kobo.744.2">The commands we’re covering are </span><span class="No-Break"><span class="koboSpan" id="kobo.745.1">as follows:</span></span></p>
<ul>
<li><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.746.1">build</span></strong></span></li>
<li><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.747.1">run</span></strong></span></li>
<li><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.748.1">mod</span></strong></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.749.1">get </span></strong></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.750.1">install </span></strong></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.751.1">fmt </span></strong></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.752.1">test </span></strong></li>
<li><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.753.1">env</span></strong></span></li>
</ul>
<p><span class="koboSpan" id="kobo.754.1">These help you build and run your Go programs, manage their dependencies, and format and test </span><span class="No-Break"><span class="koboSpan" id="kobo.755.1">your code.</span></span></p>
<h2 id="_idParaDest-58"><a id="_idTextAnchor057"/><span class="koboSpan" id="kobo.756.1">Build</span></h2>
<p><span class="koboSpan" id="kobo.757.1">We use the </span><strong class="source-inline"><span class="koboSpan" id="kobo.758.1">go build</span></strong><span class="koboSpan" id="kobo.759.1"> command to</span><a id="_idIndexMarker109"/><span class="koboSpan" id="kobo.760.1"> compile a Go program and generate an executable binary. </span><span class="koboSpan" id="kobo.760.2">If you are not using Go modules yet, the command expects a list of Go source files to compile as an argument. </span><span class="koboSpan" id="kobo.760.3">It generates a binary file as a result, with the same name as the first source file (without the </span><strong class="source-inline"><span class="koboSpan" id="kobo.761.1">.go</span></strong><span class="koboSpan" id="kobo.762.1"> suffix). </span><span class="koboSpan" id="kobo.762.2">In the </span><strong class="source-inline"><span class="koboSpan" id="kobo.763.1">ch02/hello</span></strong><span class="koboSpan" id="kobo.764.1"> folder of the book’s GitHub repository (</span><em class="italic"><span class="koboSpan" id="kobo.765.1">Further reading</span></em><span class="koboSpan" id="kobo.766.1">), we have the </span><strong class="source-inline"><span class="koboSpan" id="kobo.767.1">main.go</span></strong><span class="koboSpan" id="kobo.768.1"> and </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.769.1">vars.go</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.770.1"> files.</span></span></p>
<p><span class="koboSpan" id="kobo.771.1">You can build an executable file for the program in these files with the </span><strong class="source-inline"><span class="koboSpan" id="kobo.772.1">go </span></strong><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.773.1">build</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.774.1"> command:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.775.1">ch02/hello$ go build *.go
ch02/hello$ ./main
Hello World</span></pre>
<p><span class="koboSpan" id="kobo.776.1">Packaging compiled binaries is a common way of distributing Go programs, since it allows users of a program to skip the compilation stage and reduce the installation procedure to just a few commands (</span><strong class="source-inline"><span class="koboSpan" id="kobo.777.1">download</span></strong><span class="koboSpan" id="kobo.778.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.779.1">unzip</span></strong><span class="koboSpan" id="kobo.780.1">). </span><span class="koboSpan" id="kobo.780.2">But you can only run this binary file on a machine with the same architecture and OS. </span><span class="koboSpan" id="kobo.780.3">To produce binary files for other systems, you can cross-compile to a wide range of OSs and CPU architectures. </span><span class="koboSpan" id="kobo.780.4">For example, the following table shows some target CPU instruction sets that </span><span class="No-Break"><span class="koboSpan" id="kobo.781.1">are supported:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer022">
<span class="koboSpan" id="kobo.782.1"><img alt="Table 2.1 – Some supported CPU architectures " src="image/B16971_02_Table_2.1.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.783.1">Table 2.1 – Some supported CPU architectures</span></p>
<p><span class="koboSpan" id="kobo.784.1">Out of a long list of </span><a id="_idIndexMarker110"/><span class="koboSpan" id="kobo.785.1">supported operating systems, the next table shows the most </span><span class="No-Break"><span class="koboSpan" id="kobo.786.1">popular options:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer023">
<span class="koboSpan" id="kobo.787.1"><img alt="Table 2.2 – Some supported OSs " src="image/B16971_02_Table_2.2.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.788.1">Table 2.2 – Some supported OSs</span></p>
<p><span class="koboSpan" id="kobo.789.1">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.790.1">GOOS</span></strong><span class="koboSpan" id="kobo.791.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.792.1">GOARCH</span></strong><span class="koboSpan" id="kobo.793.1"> environment variables allow you to generate cross-compiled binaries for any other supported system. </span><span class="koboSpan" id="kobo.793.2">If you are on a Windows machine, you can generate a binary for macOS running on a 64-bit Intel processor with the </span><span class="No-Break"><span class="koboSpan" id="kobo.794.1">following command:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.795.1">ch02/hello$ GOOS=darwin GOARCH=amd64 go build *.go</span></pre>
<p><span class="koboSpan" id="kobo.796.1">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.797.1">go tool dist list</span></strong><span class="koboSpan" id="kobo.798.1"> command shows a complete set of unique combinations of OSs and architectures that the Go </span><span class="No-Break"><span class="koboSpan" id="kobo.799.1">compiler supports:</span></span></p>
<pre class="console"><span class="Code_Blue"><span class="koboSpan" id="kobo.800.1">$ go</span></span><span class="koboSpan" id="kobo.801.1"> tool dist list
...
</span><span class="koboSpan" id="kobo.801.2">darwin/amd64
darwin/arm64
...
</span><span class="koboSpan" id="kobo.801.3">linux/386
linux/amd64
linux/arm
linux/arm64
...
</span><span class="koboSpan" id="kobo.801.4">windows/386
windows/amd64</span></pre>
<p><span class="koboSpan" id="kobo.802.1">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.803.1">go build</span></strong><span class="koboSpan" id="kobo.804.1"> command </span><a id="_idIndexMarker111"/><span class="koboSpan" id="kobo.805.1">supports different flags to change its default behavior. </span><span class="koboSpan" id="kobo.805.2">Two of the most popular flags are </span><strong class="source-inline"><span class="koboSpan" id="kobo.806.1">-o</span></strong> <span class="No-Break"><span class="koboSpan" id="kobo.807.1">and </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.808.1">-ldflags</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.809.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.810.1">You can use </span><strong class="source-inline"><span class="koboSpan" id="kobo.811.1">-o</span></strong><span class="koboSpan" id="kobo.812.1"> to override the default binary name with a name of your preference. </span><span class="koboSpan" id="kobo.812.2">In the example, we’ve </span><span class="No-Break"><span class="koboSpan" id="kobo.813.1">selected </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.814.1">another_name</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.815.1">:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.816.1">ch02/hello$ </span><span class="Code_Purple"><span class="koboSpan" id="kobo.817.1">go</span></span><span class="koboSpan" id="kobo.818.1"> build </span><span class="Code_Red"><span class="koboSpan" id="kobo.819.1">-</span></span><span class="koboSpan" id="kobo.820.1">o another_name *.go
ch02/hello$ </span><span class="Code_Red"><span class="koboSpan" id="kobo.821.1">./another_name</span></span>
<span class="Code_Red"><span class="koboSpan" id="kobo.822.1">Hello World</span></span></pre>
<p><span class="koboSpan" id="kobo.823.1">To inject environment data at compile time into your program, use </span><strong class="source-inline"><span class="koboSpan" id="kobo.824.1">-ldflags</span></strong><span class="koboSpan" id="kobo.825.1"> with a reference to a variable and its value. </span><span class="koboSpan" id="kobo.825.2">This way, you can have access to build information during the program execution, such as the date you compiled the program or the version of the source code (</span><strong class="source-inline"><span class="koboSpan" id="kobo.826.1">git commit</span></strong><span class="koboSpan" id="kobo.827.1">) you compiled </span><span class="No-Break"><span class="koboSpan" id="kobo.828.1">it from:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.829.1">ch02/hello$ go build -</span><span class="Code_Red"><span class="koboSpan" id="kobo.830.1">ldflags='-X main.Version=1.0 -X main.GitCommit=600a82c442'</span></span><span class="koboSpan" id="kobo.831.1"> *.go
ch02/hello$ </span><span class="Code_Red"><span class="koboSpan" id="kobo.832.1">./main</span></span>
<span class="Code_Red"><span class="koboSpan" id="kobo.833.1">Version: "1.0"</span></span>
<span class="Code_Red"><span class="koboSpan" id="kobo.834.1">Git Commit: "600a82c442"</span></span>
<span class="Code_Red"><span class="koboSpan" id="kobo.835.1">Hello World</span></span></pre>
<p><span class="koboSpan" id="kobo.836.1">The last example is a very common way of version-tagging a Go binary. </span><span class="koboSpan" id="kobo.836.2">The benefit of this approach is that it doesn’t require any changes to the source code, and you can automate the entire process in a continuous </span><span class="No-Break"><span class="koboSpan" id="kobo.837.1">delivery pipeline.</span></span></p>
<h2 id="_idParaDest-59"><a id="_idTextAnchor058"/><span class="koboSpan" id="kobo.838.1">Run</span></h2>
<p><span class="koboSpan" id="kobo.839.1">Another way to run</span><a id="_idIndexMarker112"/><span class="koboSpan" id="kobo.840.1"> a Go program is by using the </span><strong class="source-inline"><span class="koboSpan" id="kobo.841.1">go run</span></strong><span class="koboSpan" id="kobo.842.1"> command. </span><span class="koboSpan" id="kobo.842.2">It accepts the same flags as </span><strong class="source-inline"><span class="koboSpan" id="kobo.843.1">go build</span></strong><span class="koboSpan" id="kobo.844.1"> with </span><span class="No-Break"><span class="koboSpan" id="kobo.845.1">two differences:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.846.1">It doesn’t produce </span><span class="No-Break"><span class="koboSpan" id="kobo.847.1">a binary.</span></span></li>
<li><span class="koboSpan" id="kobo.848.1">It runs the program right </span><span class="No-Break"><span class="koboSpan" id="kobo.849.1">after compilation.</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.850.1">The most common use case for </span><strong class="source-inline"><span class="koboSpan" id="kobo.851.1">go run</span></strong><span class="koboSpan" id="kobo.852.1"> is local debugging and troubleshooting, where a single command combines the processes of compilation </span><span class="No-Break"><span class="koboSpan" id="kobo.853.1">and execution:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.854.1">ch02/hello$ </span><span class="Code_Purple"><span class="koboSpan" id="kobo.855.1">go</span></span><span class="koboSpan" id="kobo.856.1"> run {main,vars}.</span><span class="Code_Purple"><span class="koboSpan" id="kobo.857.1">go</span></span><span class="koboSpan" id="kobo.858.1">
Hello World</span></pre>
<p><span class="koboSpan" id="kobo.859.1">In the example, we run the program in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.860.1">main.go</span></strong><span class="koboSpan" id="kobo.861.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.862.1">vars.go</span></strong><span class="koboSpan" id="kobo.863.1"> files, which produces the </span><strong class="source-inline"><span class="koboSpan" id="kobo.864.1">Hello </span></strong><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.865.1">World</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.866.1"> output.</span></span></p>
<h2 id="_idParaDest-60"><a id="_idTextAnchor059"/><span class="koboSpan" id="kobo.867.1">Mod</span></h2>
<p><span class="koboSpan" id="kobo.868.1">With the introduction of</span><a id="_idIndexMarker113"/><span class="koboSpan" id="kobo.869.1"> Go modules, the </span><strong class="source-inline"><span class="koboSpan" id="kobo.870.1">go</span></strong><span class="koboSpan" id="kobo.871.1"> tool got an extra command to work with them – </span><strong class="source-inline"><span class="koboSpan" id="kobo.872.1">go mod</span></strong><span class="koboSpan" id="kobo.873.1">. </span><span class="koboSpan" id="kobo.873.2">To describe its functionally, let’s review a typical Go program </span><span class="No-Break"><span class="koboSpan" id="kobo.874.1">development workflow:</span></span></p>
<ol>
<li value="1"><span class="koboSpan" id="kobo.875.1">You create a new project in a folder and initialize Go modules with the </span><strong class="source-inline"><span class="koboSpan" id="kobo.876.1">go mod init</span></strong><span class="koboSpan" id="kobo.877.1"> command, with a reference to the module name – </span><strong class="source-inline"><span class="koboSpan" id="kobo.878.1">go mod init example.com/my-project</span></strong><span class="koboSpan" id="kobo.879.1">. </span><span class="koboSpan" id="kobo.879.2">This creates a pair of files, </span><strong class="source-inline"><span class="koboSpan" id="kobo.880.1">go.mod</span></strong><span class="koboSpan" id="kobo.881.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.882.1">go.sum</span></strong><span class="koboSpan" id="kobo.883.1">, that keep track of your project’s dependencies. </span></li>
</ol>
<p><span class="koboSpan" id="kobo.884.1">The next output shows the size of these two files of a real-life project. </span><strong class="source-inline"><span class="koboSpan" id="kobo.885.1">go.mod</span></strong><span class="koboSpan" id="kobo.886.1"> lists all the dependencies and is relatively small in size compared to </span><strong class="source-inline"><span class="koboSpan" id="kobo.887.1">go.sum</span></strong><span class="koboSpan" id="kobo.888.1">, which has the checksum for all </span><span class="No-Break"><span class="koboSpan" id="kobo.889.1">the dependencies:</span></span></p>
<pre class="console"><span class="Code_Blue"><span class="koboSpan" id="kobo.890.1">$ ls -1hs</span></span><span class="koboSpan" id="kobo.891.1"> go.*
</span><span class="Code_Green"><span class="koboSpan" id="kobo.892.1">4</span></span><span class="koboSpan" id="kobo.893.1">.0K go.mod
 92K go.sum</span></pre>
<p><span class="koboSpan" id="kobo.894.1">If you plan to share this project with others, the name of the module should be a path that is reachable on the internet. </span><span class="koboSpan" id="kobo.894.2">It normally points to your source code repository – for example, </span><strong class="source-inline"><span class="koboSpan" id="kobo.895.1">github.com/username/my-project</span></strong><span class="koboSpan" id="kobo.896.1">. </span><span class="koboSpan" id="kobo.896.2">A real-life example </span><span class="No-Break"><span class="koboSpan" id="kobo.897.1">is </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.898.1">github.com/gohugoio/hugo/</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.899.1">.</span></span></p>
<ol>
<li value="2"><span class="koboSpan" id="kobo.900.1">As you develop your code and add more and more dependencies, the </span><strong class="source-inline"><span class="koboSpan" id="kobo.901.1">go</span></strong><span class="koboSpan" id="kobo.902.1"> tool updates the </span><strong class="source-inline"><span class="koboSpan" id="kobo.903.1">go.mod</span></strong><span class="koboSpan" id="kobo.904.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.905.1">go.sum</span></strong><span class="koboSpan" id="kobo.906.1"> files automatically whenever you run the </span><strong class="source-inline"><span class="koboSpan" id="kobo.907.1">go build</span></strong><span class="koboSpan" id="kobo.908.1"> or </span><strong class="source-inline"><span class="koboSpan" id="kobo.909.1">go </span></strong><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.910.1">run</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.911.1"> commands.</span></span></li>
<li><span class="koboSpan" id="kobo.912.1">When you add a dependency, the </span><strong class="source-inline"><span class="koboSpan" id="kobo.913.1">go</span></strong><span class="koboSpan" id="kobo.914.1"> tool locks its version in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.915.1">go.mod</span></strong><span class="koboSpan" id="kobo.916.1"> file to prevent accidental code breakages. </span><span class="koboSpan" id="kobo.916.2">If you decide you want to update to a newer minor version, you </span><a id="_idIndexMarker114"/><span class="koboSpan" id="kobo.917.1">can use the </span><strong class="source-inline"><span class="koboSpan" id="kobo.918.1">go get -u </span></strong><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.919.1">package@version</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.920.1"> command.</span></span></li>
<li><span class="koboSpan" id="kobo.921.1">If you remove a dependency, you can run </span><strong class="source-inline"><span class="koboSpan" id="kobo.922.1">go mod tidy</span></strong><span class="koboSpan" id="kobo.923.1"> to clean up the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.924.1">go.mod</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.925.1"> file.</span></span></li>
<li><span class="koboSpan" id="kobo.926.1">The two </span><strong class="source-inline"><span class="koboSpan" id="kobo.927.1">go.*</span></strong><span class="koboSpan" id="kobo.928.1"> files contain a full list of dependencies, including the ones that are not directly referenced in your code, that are indirect or chained/transitive dependencies. </span><span class="koboSpan" id="kobo.928.2">If you want to find out why a particular dependency is present in your </span><strong class="source-inline"><span class="koboSpan" id="kobo.929.1">go.mod</span></strong><span class="koboSpan" id="kobo.930.1"> file, you can use the </span><strong class="source-inline"><span class="koboSpan" id="kobo.931.1">go mod why package</span></strong><span class="koboSpan" id="kobo.932.1"> or </span><strong class="source-inline"><span class="koboSpan" id="kobo.933.1">go mod graph</span></strong><span class="koboSpan" id="kobo.934.1"> commands to print the dependency tree on </span><span class="No-Break"><span class="koboSpan" id="kobo.935.1">the screen:</span></span><pre class="console"><span class="koboSpan" id="kobo.936.1">hugo$ go mod why go.opencensus.io/internal</span></pre><pre class="console"><span class="Code_Red"><span class="koboSpan" id="kobo.937.1"># go.opencensus.io/internal</span></span></pre><pre class="console"><span class="koboSpan" id="kobo.938.1">github.com/gohugoio/hugo/deploy</span></pre><pre class="console"><span class="koboSpan" id="kobo.939.1">gocloud.dev/blob</span></pre><pre class="console"><span class="koboSpan" id="kobo.940.1">gocloud.dev/internal/oc</span></pre><pre class="console"><span class="koboSpan" id="kobo.941.1">go.opencensus.io/trace</span></pre><pre class="console"><span class="koboSpan" id="kobo.942.1">go.opencensus.io/internal</span></pre></li>
</ol>
<p><span class="koboSpan" id="kobo.943.1">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.944.1">go list</span></strong><span class="koboSpan" id="kobo.945.1"> command can also be of help. </span><span class="koboSpan" id="kobo.945.2">It lists all the </span><span class="No-Break"><span class="koboSpan" id="kobo.946.1">module dependencies:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.947.1">hugo$ go list </span><span class="Code_Blue"><span class="koboSpan" id="kobo.948.1">-m</span></span><span class="koboSpan" id="kobo.949.1"> all | </span><span class="Code_Blue"><span class="koboSpan" id="kobo.950.1">grep</span></span><span class="koboSpan" id="kobo.951.1"> ^go.opencensus.io
go.opencensus.io v0.23.0</span></pre>
<p><span class="koboSpan" id="kobo.952.1">It also lists the actual </span><span class="No-Break"><span class="koboSpan" id="kobo.953.1">package dependencies:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.954.1">hugo$ go list all | </span><span class="Code_Blue"><span class="koboSpan" id="kobo.955.1">grep</span></span><span class="koboSpan" id="kobo.956.1"> ^go.opencensus.io
go.opencensus.io
go.opencensus.io/internal
go.opencensus.io/internal/tagencoding
go.opencensus.io/metric/metricdata
go.opencensus.io/metric/metricproducer
go.opencensus.io/plugin/ocgrpc
...
</span><span class="koboSpan" id="kobo.956.2">go.opencensus.io/trace/propagation
go.opencensus.io/trace/tracestate</span></pre>
<p><span class="koboSpan" id="kobo.957.1">If you prefer a visual </span><a id="_idIndexMarker115"/><span class="koboSpan" id="kobo.958.1">representation, there are projects such as Spaghetti (</span><em class="italic"><span class="koboSpan" id="kobo.959.1">Further reading</span></em><span class="koboSpan" id="kobo.960.1">), a dependency analysis tool for Go packages, that can present this information with a user-friendly interface, as shown in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.961.1">Figure 2</span></em></span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.962.1">.8</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.963.1">:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer024">
<span class="koboSpan" id="kobo.964.1"><img alt="Figure 2.8 – Hugo dependency analysis " src="image/B16971_02_08.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.965.1">Figure 2.8 – Hugo dependency analysis</span></p>
<p><span class="koboSpan" id="kobo.966.1">One thing that is important to </span><a id="_idIndexMarker116"/><span class="koboSpan" id="kobo.967.1">mention is that Go modules use semantic versioning. </span><span class="koboSpan" id="kobo.967.2">If you need to import a package that is part of a module at major version 2 or higher, you need to include that major version suffix in their import path (</span><strong class="source-inline"><span class="koboSpan" id="kobo.968.1">github.com/username/my-project/v2 v2.0.0</span></strong><span class="koboSpan" id="kobo.969.1">, </span><span class="No-Break"><span class="koboSpan" id="kobo.970.1">for example).</span></span></p>
<p><span class="koboSpan" id="kobo.971.1">Before we move to the next command, let’s create a </span><strong class="source-inline"><span class="koboSpan" id="kobo.972.1">go.mod</span></strong><span class="koboSpan" id="kobo.973.1"> file for the example in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.974.1">ch02/hello</span></strong><span class="koboSpan" id="kobo.975.1"> folder of the book’s GitHub repository (</span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.976.1">Further reading</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.977.1">):</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.978.1">ch02/hello$ go mod init hello
go: creating new go.mod: module hello
go: to add module requirements and sums:
go mod tidy
ch02/hello$ go mod tidy
ch02/hello$ go build
ch02/hello$ ./hello
Hello World</span></pre>
<p><span class="koboSpan" id="kobo.979.1">Now, you can build a binary file for the program with </span><strong class="source-inline"><span class="koboSpan" id="kobo.980.1">go build</span></strong><span class="koboSpan" id="kobo.981.1"> without having to reference all the Go files in the </span><span class="No-Break"><span class="koboSpan" id="kobo.982.1">folder (</span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.983.1">*.go</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.984.1">).</span></span></p>
<h2 id="_idParaDest-61"><a id="_idTextAnchor060"/><span class="koboSpan" id="kobo.985.1">Get</span></h2>
<p><span class="koboSpan" id="kobo.986.1">Before the Go 1.11 release, you could use the </span><strong class="source-inline"><span class="koboSpan" id="kobo.987.1">go get</span></strong><span class="koboSpan" id="kobo.988.1"> command</span><a id="_idIndexMarker117"/><span class="koboSpan" id="kobo.989.1"> to download and install Go programs. </span><span class="koboSpan" id="kobo.989.2">This legacy behavior is being completely deprecated, starting from Go 1.17, so we won’t cover it here. </span><span class="koboSpan" id="kobo.989.3">From now on, the sole role of this command is the management of dependencies in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.990.1">go.mod</span></strong><span class="koboSpan" id="kobo.991.1"> file to update them to a newer </span><span class="No-Break"><span class="koboSpan" id="kobo.992.1">minor version.</span></span></p>
<h2 id="_idParaDest-62"><a id="_idTextAnchor061"/><span class="koboSpan" id="kobo.993.1">Install</span></h2>
<p><span class="koboSpan" id="kobo.994.1">The easiest way to compile</span><a id="_idIndexMarker118"/><span class="koboSpan" id="kobo.995.1"> and install a Go binary without explicitly downloading the source code is to use the </span><strong class="source-inline"><span class="koboSpan" id="kobo.996.1">go install [packages]</span></strong><span class="koboSpan" id="kobo.997.1"> command. </span><span class="koboSpan" id="kobo.997.2">In the background, the </span><strong class="source-inline"><span class="koboSpan" id="kobo.998.1">go</span></strong><span class="koboSpan" id="kobo.999.1"> tool still downloads the code if necessary, runs </span><strong class="source-inline"><span class="koboSpan" id="kobo.1000.1">go build</span></strong><span class="koboSpan" id="kobo.1001.1">, and copies the binary into the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1002.1">GOBIN</span></strong><span class="koboSpan" id="kobo.1003.1"> directory, but the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1004.1">go</span></strong><span class="koboSpan" id="kobo.1005.1"> tool hides all this from the </span><span class="No-Break"><span class="koboSpan" id="kobo.1006.1">end user:</span></span></p>
<pre class="console"><span class="Code_Blue"><span class="koboSpan" id="kobo.1007.1">$ go</span></span><span class="koboSpan" id="kobo.1008.1"> install example.com/cmd@v1.2.3
</span><span class="Code_Blue"><span class="koboSpan" id="kobo.1009.1">$ go</span></span><span class="koboSpan" id="kobo.1010.1"> install example.com/cmd@latest</span></pre>
<p><span class="koboSpan" id="kobo.1011.1">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.1012.1">go install</span></strong><span class="koboSpan" id="kobo.1013.1"> command accepts an optional version suffix – for example, </span><strong class="source-inline"><span class="koboSpan" id="kobo.1014.1">@latest</span></strong><span class="koboSpan" id="kobo.1015.1"> – and falls back to the local </span><strong class="source-inline"><span class="koboSpan" id="kobo.1016.1">go.mod</span></strong><span class="koboSpan" id="kobo.1017.1"> file if the version is missing. </span><span class="koboSpan" id="kobo.1017.2">Thus, when running </span><strong class="source-inline"><span class="koboSpan" id="kobo.1018.1">go install</span></strong><span class="koboSpan" id="kobo.1019.1">, it’s recommended to always specify a version tag to avoid errors if the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1020.1">go</span></strong><span class="koboSpan" id="kobo.1021.1"> tool cannot find a local </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.1022.1">go.mod</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.1023.1"> file.</span></span></p>
<h2 id="_idParaDest-63"><a id="_idTextAnchor062"/><span class="koboSpan" id="kobo.1024.1">Fmt</span></h2>
<p><span class="koboSpan" id="kobo.1025.1">Go takes much of the</span><a id="_idIndexMarker119"/><span class="koboSpan" id="kobo.1026.1"> code formatting out of developers’ hands by shipping an opinionated formatting tool that you can invoke with the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1027.1">go fmt</span></strong><span class="koboSpan" id="kobo.1028.1"> command pointing to your Go source code – for example, </span><strong class="source-inline"><span class="koboSpan" id="kobo.1029.1">go fmt source.go</span></strong><span class="koboSpan" id="kobo.1030.1">. </span></p>
<p><a href="B16971_01.xhtml#_idTextAnchor015"><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.1031.1">Chapter 1</span></em></span></a><span class="koboSpan" id="kobo.1032.1">, </span><em class="italic"><span class="koboSpan" id="kobo.1033.1">Introduction</span></em><span class="koboSpan" id="kobo.1034.1">, covers how this improves code readability by making all Go code look similar. </span><span class="koboSpan" id="kobo.1034.2">Most IDEs with plugins for Go automatically format your code every time you save it, making it one less problem to worry about </span><span class="No-Break"><span class="koboSpan" id="kobo.1035.1">for developers.</span></span></p>
<h2 id="_idParaDest-64"><a id="_idTextAnchor063"/><span class="koboSpan" id="kobo.1036.1">Test</span></h2>
<p><span class="koboSpan" id="kobo.1037.1">Go is also</span><a id="_idIndexMarker120"/><span class="koboSpan" id="kobo.1038.1"> opinionated when it comes to testing. </span><span class="koboSpan" id="kobo.1038.2">It makes a few decisions on behalf of developers about the best way to organize code testing to unify the user experience and discourage the use of </span><span class="No-Break"><span class="koboSpan" id="kobo.1039.1">third-party frameworks:</span></span></p>
<ol>
<li value="1"><span class="koboSpan" id="kobo.1040.1">It automatically executes all files with the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1041.1">_test.go</span></strong><span class="koboSpan" id="kobo.1042.1"> suffix in their filenames when you run the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1043.1">go test</span></strong><span class="koboSpan" id="kobo.1044.1"> command. </span><span class="koboSpan" id="kobo.1044.2">This command accepts an optional argument that specifies which package, path, or source file </span><span class="No-Break"><span class="koboSpan" id="kobo.1045.1">to test.</span></span></li>
<li><span class="koboSpan" id="kobo.1046.1">The Go standard library includes a special </span><strong class="source-inline"><span class="koboSpan" id="kobo.1047.1">testing</span></strong><span class="koboSpan" id="kobo.1048.1"> package that works with the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1049.1">go test</span></strong><span class="koboSpan" id="kobo.1050.1"> command. </span><span class="koboSpan" id="kobo.1050.2">Aside from unit test support, this package offers comprehensive coverage reports </span><span class="No-Break"><span class="koboSpan" id="kobo.1051.1">and benchmarks.</span></span></li>
</ol>
<p><span class="koboSpan" id="kobo.1052.1">To put this into practice, we include a test program for the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1053.1">ping</span></strong><span class="koboSpan" id="kobo.1054.1"> package that we described in the Go modules section. </span><span class="koboSpan" id="kobo.1054.2">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.1055.1">ping</span></strong><span class="koboSpan" id="kobo.1056.1"> package has a </span><strong class="source-inline"><span class="koboSpan" id="kobo.1057.1">Send</span></strong><span class="koboSpan" id="kobo.1058.1"> function, which returns the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1059.1">pong</span></strong><span class="koboSpan" id="kobo.1060.1"> string when called. </span><span class="koboSpan" id="kobo.1060.2">The test we perform should verify this. </span><span class="koboSpan" id="kobo.1060.3">In the test program, we start by defining a string with the value we expect (</span><strong class="source-inline"><span class="koboSpan" id="kobo.1061.1">pong</span></strong><span class="koboSpan" id="kobo.1062.1">) and then compare it to the result of the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1063.1">ping</span></strong><span class="koboSpan" id="kobo.1064.1"> function. </span><span class="koboSpan" id="kobo.1064.2">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.1065.1">code_test.go</span></strong><span class="koboSpan" id="kobo.1066.1"> file (</span><a href="https://sdg-tracker.org/"><span class="koboSpan" id="kobo.1067.1">https://github.com/PacktPublishing/Network-Automation-with-Go/blob/main/ch02/ping/code_test.go</span></a><span class="koboSpan" id="kobo.1068.1">) in the same folder as </span><strong class="source-inline"><span class="koboSpan" id="kobo.1069.1">ping</span></strong><span class="koboSpan" id="kobo.1070.1"> represents this in Go code: </span></p>
<pre class="source-code"><span class="Code_Purple"><span class="koboSpan" id="kobo.1071.1">package</span></span><span class="koboSpan" id="kobo.1072.1"> ping_test
</span><span class="Code_Purple"><span class="koboSpan" id="kobo.1073.1">import</span></span><span class="koboSpan" id="kobo.1074.1"> (
    </span><span class="Code_Red"><span class="koboSpan" id="kobo.1075.1">"github.com/PacktPublishing/Network-Automation-with-Go/ch02/ping" </span></span>
<span class="Code_Red"><span class="koboSpan" id="kobo.1076.1">    "testing"</span></span><span class="koboSpan" id="kobo.1077.1">
)
</span><span class="Code_Purple"><span class="koboSpan" id="kobo.1078.1">func</span></span> <strong class="bold"><span class="koboSpan" id="kobo.1079.1">TestSend</span></strong><span class="koboSpan" id="kobo.1080.1">(t </span><span class="Code_Red"><span class="koboSpan" id="kobo.1081.1">*</span></span><span class="koboSpan" id="kobo.1082.1">testing.T) {
    want :</span><span class="Code_Red"><span class="koboSpan" id="kobo.1083.1">= "pong"</span></span><span class="koboSpan" id="kobo.1084.1">
    result :</span><span class="Code_Red"><span class="koboSpan" id="kobo.1085.1">=</span></span><span class="koboSpan" id="kobo.1086.1"> ping.Send()
    if result </span><span class="Code_Red"><span class="koboSpan" id="kobo.1087.1">!=</span></span><span class="koboSpan" id="kobo.1088.1"> want {
        t.Fatalf(</span><span class="Code_Red"><span class="koboSpan" id="kobo.1089.1">"[%s] is incorrect, we want [%s]"</span></span><span class="koboSpan" id="kobo.1090.1">, result, want)
    }
}</span></pre>
<p><span class="koboSpan" id="kobo.1091.1">All test functions have a </span><strong class="source-inline"><span class="koboSpan" id="kobo.1092.1">TestXxx</span></strong><span class="koboSpan" id="kobo.1093.1">(</span><strong class="source-inline"><span class="koboSpan" id="kobo.1094.1">t *testing.T</span></strong><span class="koboSpan" id="kobo.1095.1">) signature, and whether they have access to any other functions </span><a id="_idIndexMarker121"/><span class="koboSpan" id="kobo.1096.1">and variables defined in the same package depends on how you name </span><span class="No-Break"><span class="koboSpan" id="kobo.1097.1">the package:</span></span></p>
<ul>
<li><strong class="bold"><span class="koboSpan" id="kobo.1098.1">ping</span></strong><span class="koboSpan" id="kobo.1099.1">: This gives you access to everything in </span><span class="No-Break"><span class="koboSpan" id="kobo.1100.1">the package.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.1101.1">ping_test</span></strong><span class="koboSpan" id="kobo.1102.1">: This is a package type (the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1103.1">_test</span></strong><span class="koboSpan" id="kobo.1104.1"> suffix) that can live in the same folder as the package you are testing, but it does not have access to the original package variables and methods, so you must import it as any other user would do it. </span><span class="koboSpan" id="kobo.1104.2">It’s an effective way to document how to use the package while testing it. </span><span class="koboSpan" id="kobo.1104.3">In the example, we use the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1105.1">ping.Send</span></strong><span class="koboSpan" id="kobo.1106.1"> function instead of </span><strong class="source-inline"><span class="koboSpan" id="kobo.1107.1">Send</span></strong><span class="koboSpan" id="kobo.1108.1"> directly, as we are importing </span><span class="No-Break"><span class="koboSpan" id="kobo.1109.1">the package.</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.1110.1">This is an assurance that the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1111.1">Send</span></strong><span class="koboSpan" id="kobo.1112.1"> function always does the same even if they must optimize the code later. </span><span class="koboSpan" id="kobo.1112.2">Now, every time you change the code, you can run the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1113.1">go test</span></strong><span class="koboSpan" id="kobo.1114.1"> command to verify that the code still behaves the way you expect. </span><span class="koboSpan" id="kobo.1114.2">By default, when you run </span><strong class="source-inline"><span class="koboSpan" id="kobo.1115.1">go test</span></strong><span class="koboSpan" id="kobo.1116.1">, it prints the results of every test function it finds along with the time to </span><span class="No-Break"><span class="koboSpan" id="kobo.1117.1">execute them:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.1118.1">ch02/ping$ go test
PASS
ok github.com/PacktPublishing/Network-Automation-with-Go/ch02/ping 0.001s</span></pre>
<p><span class="koboSpan" id="kobo.1119.1">If someone makes a </span><a id="_idIndexMarker122"/><span class="koboSpan" id="kobo.1120.1">change in the code that modifies the behavior of the program so that it can no longer pass the test cases, we are in the presence of a potential bug. </span><span class="koboSpan" id="kobo.1120.2">You can proactively identify software issues with the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1121.1">go test</span></strong><span class="koboSpan" id="kobo.1122.1"> command. </span><span class="koboSpan" id="kobo.1122.2">Let’s say they change the return value of the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1123.1">Send</span></strong><span class="koboSpan" id="kobo.1124.1"> function </span><span class="No-Break"><span class="koboSpan" id="kobo.1125.1">to </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.1126.1">p1ong</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.1127.1">:</span></span></p>
<pre class="source-code"><span class="Code_Purple"><span class="koboSpan" id="kobo.1128.1">func</span></span> <strong class="bold"><span class="koboSpan" id="kobo.1129.1">Send</span></strong><span class="koboSpan" id="kobo.1130.1">() </span><span class="Code_Purple"><span class="koboSpan" id="kobo.1131.1">string</span></span><span class="koboSpan" id="kobo.1132.1"> {
    </span><span class="Code_Purple"><span class="koboSpan" id="kobo.1133.1">return</span></span> <span class="Code_Red"><span class="koboSpan" id="kobo.1134.1">"p1ong"</span></span><span class="koboSpan" id="kobo.1135.1">
}</span></pre>
<p><span class="koboSpan" id="kobo.1136.1">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.1137.1">go test</span></strong><span class="koboSpan" id="kobo.1138.1"> command then generates an error the next time your continuous integration pipeline runs the </span><span class="No-Break"><span class="koboSpan" id="kobo.1139.1">test cases:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.1140.1">ch02/ping$ go test
--- FAIL: TestSend (0.00s)
  code_test.go:12: [p1ong] is incorrect, we want [pong]
FAIL
</span><span class="Code_Purple"><span class="koboSpan" id="kobo.1141.1">exit</span></span><span class="koboSpan" id="kobo.1142.1"> status 1
FAIL github.com/PacktPublishing/Network-Automation-with-Go/ch02/ping 0.001s</span></pre>
<p><span class="koboSpan" id="kobo.1143.1">Now, you know you can’t promote this code to production. </span><span class="koboSpan" id="kobo.1143.2">The benefit of testing is that you reduce the number of software bugs your users might run into, as you can catch </span><span class="No-Break"><span class="koboSpan" id="kobo.1144.1">them beforehand.</span></span></p>
<h2 id="_idParaDest-65"><a id="_idTextAnchor064"/><span class="koboSpan" id="kobo.1145.1">Env</span></h2>
<p><span class="koboSpan" id="kobo.1146.1">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.1147.1">go env</span></strong><span class="koboSpan" id="kobo.1148.1"> command</span><a id="_idIndexMarker123"/><span class="koboSpan" id="kobo.1149.1"> displays the environment variables that the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1150.1">go</span></strong><span class="koboSpan" id="kobo.1151.1"> command uses for configuration. </span><span class="koboSpan" id="kobo.1151.2">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.1152.1">go</span></strong><span class="koboSpan" id="kobo.1153.1"> tool can print these variables as flat text or in the JSON format with the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1154.1">-</span></strong><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.1155.1">json</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.1156.1"> flag:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.1157.1">$ go env -json
{
    ...
</span><span class="koboSpan" id="kobo.1157.2">    </span><span class="Code_Red"><span class="koboSpan" id="kobo.1158.1">"GOPROXY"</span></span><span class="koboSpan" id="kobo.1159.1">: </span><span class="Code_Red"><span class="koboSpan" id="kobo.1160.1">"https://proxy.golang.org,direct"</span></span><span class="koboSpan" id="kobo.1161.1">,
    "GOROOT": </span><span class="Code_Red"><span class="koboSpan" id="kobo.1162.1">"/usr/local/go"</span></span><span class="koboSpan" id="kobo.1163.1">,
    ...
</span><span class="koboSpan" id="kobo.1163.2">    </span><span class="Code_Red"><span class="koboSpan" id="kobo.1164.1">"GOVERSION"</span></span><span class="koboSpan" id="kobo.1165.1">: </span><span class="Code_Red"><span class="koboSpan" id="kobo.1166.1">"go1.17"</span></span><span class="koboSpan" id="kobo.1167.1">,
    "PKG_CONFIG": </span><span class="Code_Red"><span class="koboSpan" id="kobo.1168.1">"pkg-config"</span></span><span class="koboSpan" id="kobo.1169.1">
}</span></pre>
<p><span class="koboSpan" id="kobo.1170.1">You can change the </span><a id="_idIndexMarker124"/><span class="koboSpan" id="kobo.1171.1">value of a variable with </span><strong class="source-inline"><span class="koboSpan" id="kobo.1172.1">go env -w &lt;NAME&gt;=&lt;VALUE&gt;</span></strong><span class="koboSpan" id="kobo.1173.1">. </span><span class="koboSpan" id="kobo.1173.2">The next table describes some of these configuration </span><span class="No-Break"><span class="koboSpan" id="kobo.1174.1">environment variables:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer025">
<span class="koboSpan" id="kobo.1175.1"><img alt="Table 2.3 – Some configuration environment variables " src="image/B16971_02_Table_2.3.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.1176.1">Table 2.3 – Some configuration environment variables</span></p>
<p><span class="koboSpan" id="kobo.1177.1">When you change a variable, the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1178.1">go</span></strong><span class="koboSpan" id="kobo.1179.1"> tool stores its new value in the path specified by the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1180.1">GOENV</span></strong><span class="koboSpan" id="kobo.1181.1"> variable, which defaults </span><span class="No-Break"><span class="koboSpan" id="kobo.1182.1">to </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.1183.1">~/.config/go</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.1184.1">:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.1185.1">$ go env -w GOBIN=$(go env GOPATH)/bin
$ cat ~/.config/go/env
GOBIN=/home/username/go/bin</span></pre>
<p><span class="koboSpan" id="kobo.1186.1">The preceding output </span><a id="_idIndexMarker125"/><span class="koboSpan" id="kobo.1187.1">example shows how to set the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1188.1">GOBIN</span></strong><span class="koboSpan" id="kobo.1189.1"> directory explicitly and how to </span><span class="No-Break"><span class="koboSpan" id="kobo.1190.1">verify it.</span></span></p>
<p><span class="koboSpan" id="kobo.1191.1">Go offers a command-line utility that helps you manage your source code, from formatting your code to performing </span><span class="No-Break"><span class="koboSpan" id="kobo.1192.1">dependency management.</span></span></p>
<h1 id="_idParaDest-66"><a id="_idTextAnchor065"/><span class="koboSpan" id="kobo.1193.1">Summary</span></h1>
<p><span class="koboSpan" id="kobo.1194.1">In this chapter, we reviewed Go’s origins and its guiding principles, and how you should structure Go source code files and work with dependencies to run your Go programs. </span></p>
<p><span class="koboSpan" id="kobo.1195.1">In the next chapter, we will drill down into the semantics of the Go language, the variable types, math logic, control flow, functions, and, of </span><span class="No-Break"><span class="koboSpan" id="kobo.1196.1">course, concurrency.</span></span></p>
<h1 id="_idParaDest-67"><a id="_idTextAnchor066"/><span class="koboSpan" id="kobo.1197.1">Further reading</span></h1>
<ul>
<li><em class="italic"><span class="koboSpan" id="kobo.1198.1">Less is exponentially </span></em><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.1199.1">more</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.1200.1">: </span></span><a href="https://docs.aws.amazon.com/wellarchitected/latest/sustainability-pillar/sustainability-pillar.html"><span class="No-Break"><span class="koboSpan" id="kobo.1201.1">https://commandcenter.blogspot.com/2012/06/less-is-exponentially-more.html?m=1</span></span></a></li>
<li><em class="italic"><span class="koboSpan" id="kobo.1202.1">Go: Ten years and </span></em><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.1203.1">climbing</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.1204.1">: </span></span><a href="https://github.com/kubernetes/kubernetes/releases"><span class="No-Break"><span class="koboSpan" id="kobo.1205.1">https://commandcenter.blogspot.com/2017/09/go-ten-years-and-climbing.html</span></span></a></li>
<li><em class="italic"><span class="koboSpan" id="kobo.1206.1">Communicating Sequential </span></em><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.1207.1">Processes</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.1208.1">: </span></span><a href="https://kubernetes.io/docs/concepts/cluster-administration/addons/"><span class="No-Break"><span class="koboSpan" id="kobo.1209.1">https://www.cs.cmu.edu/~crary/819-f09/Hoare78.pdf</span></span></a></li>
<li><em class="italic"><span class="koboSpan" id="kobo.1210.1">Go 1.3+ Compiler </span></em><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.1211.1">Overhaul</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.1212.1">: </span></span><a href="https://docs.projectcalico.org/manifests/tigera-operator.yaml"><span class="No-Break"><span class="koboSpan" id="kobo.1213.1">https://golang.org/s/go13compiler</span></span></a></li>
<li><em class="italic"><span class="koboSpan" id="kobo.1214.1">Type Parameters </span></em><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.1215.1">Proposal</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.1216.1">: </span></span><a href="B16971_02.xhtml"><span class="No-Break"><span class="koboSpan" id="kobo.1217.1">https://go.googlesource.com/proposal/+/refs/heads/master/design/43651-type-parameters.md</span></span></a></li>
<li><em class="italic"><span class="koboSpan" id="kobo.1218.1">Go </span></em><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.1219.1">Proverbs</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.1220.1">: </span></span><a href="https://multipass.run/"><span class="No-Break"><span class="koboSpan" id="kobo.1221.1">https://go-proverbs.github.io/</span></span></a></li>
<li><em class="italic"><span class="koboSpan" id="kobo.1222.1">Concurrency is not </span></em><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.1223.1">Parallelism</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.1224.1">: </span></span><a href="https://multipass.run/"><span class="No-Break"><span class="koboSpan" id="kobo.1225.1">https://www.youtube.com/watch?v=oV9rvDllKEg</span></span></a></li>
<li><span class="koboSpan" id="kobo.1226.1">The book’s GitHub </span><span class="No-Break"><span class="koboSpan" id="kobo.1227.1">repository: </span></span><a href="B16971_02.xhtml"><span class="No-Break"><span class="koboSpan" id="kobo.1228.1">https://github.com/PacktPublishing/Network-Automation-with-Go</span></span></a></li>
<li><span class="koboSpan" id="kobo.1229.1">Go </span><span class="No-Break"><span class="koboSpan" id="kobo.1230.1">Playground: </span></span><a href="B16971_02.xhtml"><span class="No-Break"><span class="koboSpan" id="kobo.1231.1">https://go.dev/play/p/ndfJcayqaGV</span></span></a></li>
<li><span class="koboSpan" id="kobo.1232.1">Playground source </span><span class="No-Break"><span class="koboSpan" id="kobo.1233.1">code: </span></span><a href="https://docs.aws.amazon.com/wellarchitected/latest/framework/sustainability.html"><span class="No-Break"><span class="koboSpan" id="kobo.1234.1">https://go.googlesource.com/playground</span></span></a></li>
<li><span class="koboSpan" id="kobo.1235.1">Go Play </span><span class="No-Break"><span class="koboSpan" id="kobo.1236.1">Space: </span></span><a href="https://cloud.google.com/carbon-footprint"><span class="No-Break"><span class="koboSpan" id="kobo.1237.1">https://goplay.space/</span></span></a></li>
<li><span class="koboSpan" id="kobo.1238.1">Go’s standard </span><span class="No-Break"><span class="koboSpan" id="kobo.1239.1">library: </span></span><a href="B16971_02.xhtml"><span class="No-Break"><span class="koboSpan" id="kobo.1240.1">https://github.com/golang/go/tree/master/src</span></span></a></li>
<li><em class="italic"><span class="koboSpan" id="kobo.1241.1">Practical Go: Real-world advice for writing maintainable Go </span></em><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.1242.1">programs</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.1243.1">: </span></span><a href="https://github.com/PacktPublishing/Network-Automation-with-Go"><span class="No-Break"><span class="koboSpan" id="kobo.1244.1">https://dave.cheney.net/practical-go/presentations/qcon-china.html#_comments</span></span></a></li>
<li><span class="koboSpan" id="kobo.1245.1">The latest incarnation of the Go </span><span class="No-Break"><span class="koboSpan" id="kobo.1246.1">Playground: </span></span><a href="https://go.dev/doc/install"><span class="No-Break"><span class="koboSpan" id="kobo.1247.1">https://talks.golang.org/2019/playground-v3/playground-v3.slide#1</span></span></a></li>
<li><em class="italic"><span class="koboSpan" id="kobo.1248.1">Inside the Go </span></em><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.1249.1">Playground</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.1250.1">: </span></span><a href="https://cloud.google.com/blog/topics/sustainability/pick-the-google-cloud-region-with-the-lowest-co2"><span class="No-Break"><span class="koboSpan" id="kobo.1251.1">https://go.dev/blog/playground</span></span></a></li>
<li><span class="koboSpan" id="kobo.1252.1">Cmd </span><span class="No-Break"><span class="koboSpan" id="kobo.1253.1">documentation: </span></span><a href="https://pkg.go.dev/syscall "><span class="No-Break"><span class="koboSpan" id="kobo.1254.1">https://pkg.go.dev/cmd/go#pkg-overview</span></span></a></li>
<li><span class="No-Break"><span class="koboSpan" id="kobo.1255.1">Spaghetti: </span></span><a href="http://www.blender.org"><span class="No-Break"><span class="koboSpan" id="kobo.1256.1">https://github.com/adonovan/spaghetti</span></span></a></li>
<li><em class="italic"><span class="koboSpan" id="kobo.1257.1">Deprecation of ’go get’ for installing </span></em><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.1258.1">executables</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.1259.1">: </span></span><a href="https://cloud.google.com/recommender/docs/unattended-project-recommender"><span class="No-Break"><span class="koboSpan" id="kobo.1260.1">https://golang.org/doc/go-get-install-deprecation</span></span></a></li>
</ul>
</div>
</body></html>