<html><head></head><body>
<div id="_idContainer056">
<h1 class="chapter-number" id="_idParaDest-129"><a id="_idTextAnchor128"/><span class="koboSpan" id="kobo.1.1">5</span></h1>
<h1 id="_idParaDest-130"><a id="_idTextAnchor129"/><span class="koboSpan" id="kobo.2.1">Network Automation</span></h1>
<p><span class="koboSpan" id="kobo.3.1">Up until this point, we’ve covered some Go fundamentals required to perform common network-related activities. </span><span class="koboSpan" id="kobo.3.2">Now, it’s time to focus on the principal topic of this book — network automation. </span><span class="koboSpan" id="kobo.3.3">Before we review the solutions, tools, and code libraries, let’s take a step back and look at network automation as a discipline. </span><span class="koboSpan" id="kobo.3.4">In this chapter, we aim to find an answer to the </span><span class="No-Break"><span class="koboSpan" id="kobo.4.1">following questions:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.5.1">What is network automation and why is it often considered a dedicated skill that’s distinct from, say, </span><span class="No-Break"><span class="koboSpan" id="kobo.6.1">network engineering?</span></span></li>
<li><span class="koboSpan" id="kobo.7.1">What is its impact on network operations and its benefits for </span><span class="No-Break"><span class="koboSpan" id="kobo.8.1">the business?</span></span></li>
<li><span class="koboSpan" id="kobo.9.1">What are some common automation use cases you can </span><span class="No-Break"><span class="koboSpan" id="kobo.10.1">tackle individually?</span></span></li>
<li><span class="koboSpan" id="kobo.11.1">How can you string these individual use cases together into a bigger network automation system and why would anyone </span><span class="No-Break"><span class="koboSpan" id="kobo.12.1">want that?</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.13.1">This chapter is light on code but heavy on words and may contain arguments that not everyone may agree on. </span><span class="koboSpan" id="kobo.13.2">We, as authors of this book, are trying to express our opinions as objectively as possible, but our views are ultimately based on subjective experiences that we’ve had in our careers. </span><span class="koboSpan" id="kobo.13.3">Still, we have tried our best to steer away from the most controversial topics such as automation reducing the need for human operators and, where possible, provided evidence to support </span><span class="No-Break"><span class="koboSpan" id="kobo.14.1">our arguments.</span></span></p>
<p><span class="koboSpan" id="kobo.15.1">In this chapter we will cover the </span><span class="No-Break"><span class="koboSpan" id="kobo.16.1">following topics:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.17.1">What is </span><span class="No-Break"><span class="koboSpan" id="kobo.18.1">network automation?</span></span></li>
<li><span class="koboSpan" id="kobo.19.1">Automating network </span><span class="No-Break"><span class="koboSpan" id="kobo.20.1">operation tasks</span></span></li>
<li><span class="No-Break"><span class="koboSpan" id="kobo.21.1">Systems approach</span></span></li>
</ul>
<h1 id="_idParaDest-131"><a id="_idTextAnchor130"/><span class="koboSpan" id="kobo.22.1">Technical requirements</span></h1>
<p><span class="koboSpan" id="kobo.23.1">You can find the code examples for this chapter in this book’s GitHub repository (specified in the </span><em class="italic"><span class="koboSpan" id="kobo.24.1">Further reading</span></em><span class="koboSpan" id="kobo.25.1"> section), under the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.26.1">ch05</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.27.1"> folder.</span></span></p>
<h1 id="_idParaDest-132"><a id="_idTextAnchor131"/><span class="koboSpan" id="kobo.28.1">What is network automation?</span></h1>
<p><span class="koboSpan" id="kobo.29.1">As a relatively new discipline, it’s not uncommon to see a broad spectrum of network automation definitions that vary in scope and goals. </span><span class="koboSpan" id="kobo.29.2">Network automation isn’t about one use case or technology in particular, but rather what can be of help in your environment and benefit </span><span class="No-Break"><span class="koboSpan" id="kobo.30.1">your business.</span></span></p>
<p><span class="koboSpan" id="kobo.31.1">Some engineers would argue that routing protocols already automate networks and the CLI is the intent-based API, transforming individual network commands into a dynamic network state. </span><span class="koboSpan" id="kobo.31.2">We don’t try to argue with this point of view, as there are some grains of truth in these statements, but it’s certainly not the most popular definition in </span><span class="No-Break"><span class="koboSpan" id="kobo.32.1">the industry.</span></span></p>
<p><span class="koboSpan" id="kobo.33.1">Instead, let’s define </span><a id="_idIndexMarker481"/><span class="koboSpan" id="kobo.34.1">network automation as a set of processes to automate common manual workflows performed by a network operator, such as provisioning services, performing software upgrades, or telemetry processing. </span><span class="koboSpan" id="kobo.34.2">This includes tasks that network engineers would otherwise traditionally have to click their way through, combined with running a set of </span><span class="No-Break"><span class="koboSpan" id="kobo.35.1">CLI commands.</span></span></p>
<p><span class="koboSpan" id="kobo.36.1">More complex network automation solutions may involve reacting to operational events by adjusting network configuration, applying traffic engineering policies, or even enforcing some design constraints. </span><span class="koboSpan" id="kobo.36.2">One common trait that unites all these activities is the ability to describe the desired behavior in a concrete sequence of steps that lead to the expected outcome. </span><span class="koboSpan" id="kobo.36.3">This may rule out some iterative activities such as network troubleshooting or creative activities such as network design, although they are making considerable progress in these areas with static configuration analysis (Batfish: </span><em class="italic"><span class="koboSpan" id="kobo.37.1">Further reading</span></em><span class="koboSpan" id="kobo.38.1">) and mathematical network modeling (Forward: </span><em class="italic"><span class="koboSpan" id="kobo.39.1">Further reading</span></em><span class="koboSpan" id="kobo.40.1">), for example, so we could eventually borrow concepts from the software world such as </span><strong class="bold"><span class="koboSpan" id="kobo.41.1">test-driven development</span></strong><span class="koboSpan" id="kobo.42.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.43.1">TDD</span></strong><span class="koboSpan" id="kobo.44.1">) to </span><a id="_idIndexMarker482"/><span class="koboSpan" id="kobo.45.1">automate the development and testing (whole-network </span><strong class="bold"><span class="koboSpan" id="kobo.46.1">quality assurance</span></strong><span class="koboSpan" id="kobo.47.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.48.1">QA</span></strong><span class="koboSpan" id="kobo.49.1">) and regression) of configuration templates of a </span><a id="_idIndexMarker483"/><span class="No-Break"><span class="koboSpan" id="kobo.50.1">network design.</span></span></p>
<h2 id="_idParaDest-133"><a id="_idTextAnchor132"/><span class="koboSpan" id="kobo.51.1">Why network automation exists</span></h2>
<p><span class="koboSpan" id="kobo.52.1">Probably a more </span><a id="_idIndexMarker484"/><span class="koboSpan" id="kobo.53.1">interesting question to answer is why network automation exists as a discipline unlike, say, systems administration, which has evolved into site reliability engineering and now encompasses not only plain infrastructure provisioning but also observability, automation, and even systems </span><span class="No-Break"><span class="koboSpan" id="kobo.54.1">software development.</span></span></p>
<p><span class="koboSpan" id="kobo.55.1">The way we run and operate networks has changed very little in the last few decades. </span><span class="koboSpan" id="kobo.55.2">Network management still mainly focuses on executing CLI commands and working with unstructured data, despite the wide acceptance that CLI-driven operations are error-prone and not scalable. </span><span class="koboSpan" id="kobo.55.3">Often, this leads to a lack of standardization that leaves network engineers with manual processes taking up most of their workday and making networks difficult to scale, support, </span><span class="No-Break"><span class="koboSpan" id="kobo.56.1">and secure.</span></span></p>
<p><span class="koboSpan" id="kobo.57.1">Network automation has emerged as a response to this to improve efficiency and reduce the overhead of mundane tasks. </span><span class="koboSpan" id="kobo.57.2">The goal is to produce more reliable and repeatable processes, which increases productivity. </span><span class="koboSpan" id="kobo.57.3">This also helps make networks more consistent and simpler to operate, while at the same time reducing the likelihood of an outage, thus </span><span class="No-Break"><span class="koboSpan" id="kobo.58.1">minimizing downtime.</span></span></p>
<p><span class="koboSpan" id="kobo.59.1">Despite this, not all network engineers have embarked on the journey of network automation. </span><span class="koboSpan" id="kobo.59.2">Some</span><a id="_idIndexMarker485"/><span class="koboSpan" id="kobo.60.1"> reasons we think this could be the case are </span><span class="No-Break"><span class="koboSpan" id="kobo.61.1">as follows:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.62.1">Lack of standard and vendor-agnostic APIs for network management that return structured data. </span><span class="koboSpan" id="kobo.62.2">Network vendors typically offer proprietary configuration syntax or CLIs designed primarily for </span><span class="No-Break"><span class="koboSpan" id="kobo.63.1">human interaction.</span></span></li>
<li><span class="koboSpan" id="kobo.64.1">Automation requires a completely new skill set and, since network engineers generally don’t come from a computer science background, programming remains a big </span><span class="No-Break"><span class="koboSpan" id="kobo.65.1">skill gap.</span></span></li>
<li><span class="koboSpan" id="kobo.66.1">Learning automation requires time and not every employer is happy to dedicate part of their employees’ time to something with no </span><span class="No-Break"><span class="koboSpan" id="kobo.67.1">immediate benefit.</span></span></li>
<li><span class="koboSpan" id="kobo.68.1">Automation speed can also propagate a failure rapidly, which may not help build trust in automation early on. </span><span class="koboSpan" id="kobo.68.2">It takes time to create systems that are reliable, secure, and offer </span><span class="No-Break"><span class="koboSpan" id="kobo.69.1">enough visibility.</span></span></li>
<li><span class="koboSpan" id="kobo.70.1">Given the large number of network automation tools, libraries, and frameworks with overlapping scopes, choosing the right one for a particular task can be challenging and introduces the risk of over-investing in something that may end up being a </span><span class="No-Break"><span class="koboSpan" id="kobo.71.1">wrong choice.</span></span></li>
<li><span class="koboSpan" id="kobo.72.1">Shifting from </span><em class="italic"><span class="koboSpan" id="kobo.73.1">it’s always been done this way</span></em><span class="koboSpan" id="kobo.74.1"> is hard. </span><span class="koboSpan" id="kobo.74.2">Sometimes, we follow the path of </span><a id="_idIndexMarker486"/><span class="koboSpan" id="kobo.75.1">least resistance and, thus, are reluctant </span><span class="No-Break"><span class="koboSpan" id="kobo.76.1">to change.</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.77.1">Introducing network automation into your environment brings a different set of gains and perils, depending on your point of view. </span><span class="koboSpan" id="kobo.77.2">So, let’s try to unpack what it means to both engineers operating the network and the upper management operating the business for whom a network can be a cost or a </span><span class="No-Break"><span class="koboSpan" id="kobo.78.1">profit center.</span></span></p>
<h2 id="_idParaDest-134"><a id="_idTextAnchor133"/><span class="koboSpan" id="kobo.79.1">Bottom-up view</span></h2>
<p><span class="koboSpan" id="kobo.80.1">Some network operation activities </span><a id="_idIndexMarker487"/><span class="koboSpan" id="kobo.81.1">that lend themselves well to automation include configuration changes, running audits or compliance checks, software and device life cycle management, and more. </span><span class="koboSpan" id="kobo.81.2">Several organizations have playbooks or require change management forms, documenting every operational step of these processes. </span><span class="koboSpan" id="kobo.81.3">Many companies already use a form of automation when a senior engineer prepares a change that a junior engineer </span><span class="No-Break"><span class="koboSpan" id="kobo.82.1">later executes.</span></span></p>
<p><span class="koboSpan" id="kobo.83.1">These activities usually have a set of very well-defined inputs, such as an inventory of devices, a list of commands to execute, a set of well-defined outputs, and maybe a filled-out spreadsheet or a new software version running on a device. </span><span class="koboSpan" id="kobo.83.2">These attributes make these activities suitable candidates </span><span class="No-Break"><span class="koboSpan" id="kobo.84.1">for automation.</span></span></p>
<p><span class="koboSpan" id="kobo.85.1">One of the commonly cited benefits of automation is its ability to scale – the relative cost of making a change to one device is the same as making a change to thousands of devices or making a hundred changes to hundreds of devices. </span><span class="koboSpan" id="kobo.85.2">Although scale and speed are important, they may not be the most valuable outcomes of </span><span class="No-Break"><span class="koboSpan" id="kobo.86.1">process automation.</span></span></p>
<p><span class="koboSpan" id="kobo.87.1">For some networking teams with relatively small-scale networks or low change rates, network automation may bring other benefits, such as </span><span class="No-Break"><span class="koboSpan" id="kobo.88.1">the following:</span></span></p>
<ul>
<li><strong class="bold"><span class="koboSpan" id="kobo.89.1">Consistency</span></strong><span class="koboSpan" id="kobo.90.1">: Since </span><a id="_idIndexMarker488"/><span class="koboSpan" id="kobo.91.1">computers perform these changes, you can expect them to yield the same result every time. </span><span class="koboSpan" id="kobo.91.2">Also, you can enforce the same configurations, templates, or policies </span><span class="No-Break"><span class="koboSpan" id="kobo.92.1">across elements.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.93.1">Reliability</span></strong><span class="koboSpan" id="kobo.94.1">: Instructions are code, which computers interprets unambiguously. </span><span class="koboSpan" id="kobo.94.2">You can also add automatic checks to validate inputs </span><span class="No-Break"><span class="koboSpan" id="kobo.95.1">or results.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.96.1">Visibility</span></strong><span class="koboSpan" id="kobo.97.1">: All future and past changes in the network can be viewed by all members of the team, to embrace peer review and </span><span class="No-Break"><span class="koboSpan" id="kobo.98.1">ease troubleshooting.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.99.1">Ubiquity</span></strong><span class="koboSpan" id="kobo.100.1">: The same </span><a id="_idIndexMarker489"/><span class="koboSpan" id="kobo.101.1">tools are used across different teams, which simplifies interactions and improves </span><span class="No-Break"><span class="koboSpan" id="kobo.102.1">knowledge sharing.</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.103.1">When introducing network automation to your peers, it’s important to emphasize that this is not a single product or a solution, but rather a journey – a vector in a new direction with no </span><span class="No-Break"><span class="koboSpan" id="kobo.104.1">fixed destination.</span></span></p>
<p><span class="koboSpan" id="kobo.105.1">Keep in mind that not all manual processes may be completely automatable, and it may take years to develop new practices and update existing procedures. </span><span class="koboSpan" id="kobo.105.2">This is why it’s also very important to get your organization’s management </span><span class="No-Break"><span class="koboSpan" id="kobo.106.1">on board.</span></span></p>
<h2 id="_idParaDest-135"><a id="_idTextAnchor134"/><span class="koboSpan" id="kobo.107.1">Top-down view</span></h2>
<p><span class="koboSpan" id="kobo.108.1">Network</span><a id="_idIndexMarker490"/><span class="koboSpan" id="kobo.109.1"> engineers can understand the preceding technical points and can judge for themselves whether a network automation project is worth their time and effort </span><span class="No-Break"><span class="koboSpan" id="kobo.110.1">to deploy.</span></span></p>
<p><span class="koboSpan" id="kobo.111.1">By contrast, the same arguments may not be enough to convince management if you don’t look at the bigger picture (the business). </span><span class="koboSpan" id="kobo.111.2">This could be one of the primary reasons a network automation initiative may fail. </span><span class="koboSpan" id="kobo.111.3">If the business benefits are not clear, then management may decide it’s not worth the investment of time. </span><span class="koboSpan" id="kobo.111.4">But the reverse is also true – a network automation initiative is more likely to succeed when it has support within the organization’s </span><span class="No-Break"><span class="koboSpan" id="kobo.112.1">management structure.</span></span></p>
<p><span class="koboSpan" id="kobo.113.1">Here is a list of business values that you can use as a starting point in discussions with management. </span><span class="koboSpan" id="kobo.113.2">Depending on the company, a network can be a cost center or a profit center, so adjust or re-prioritize them to fit </span><span class="No-Break"><span class="koboSpan" id="kobo.114.1">your circumstances:</span></span></p>
<ul>
<li><strong class="bold"><span class="koboSpan" id="kobo.115.1">Cost management</span></strong><span class="koboSpan" id="kobo.116.1">: Generate cost savings through resource optimization. </span><span class="koboSpan" id="kobo.116.2">You reduce the costs of running the network by troubleshooting fewer human errors, not having to manually compile audit reports, or having to work on </span><span class="No-Break"><span class="koboSpan" id="kobo.117.1">overtime changes.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.118.1">Speed of delivery</span></strong><span class="koboSpan" id="kobo.119.1">: Increase the speed to configure and validate changes in the network, allowing you to deliver customer services faster or </span><span class="No-Break"><span class="koboSpan" id="kobo.120.1">even on-demand.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.121.1">Risk management</span></strong><span class="koboSpan" id="kobo.122.1">: Enforce security policies consistently with every operation to reduce risk. </span><span class="koboSpan" id="kobo.122.2">Reduce the number of incidents that impact services and hence </span><span class="No-Break"><span class="koboSpan" id="kobo.123.1">your revenue.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.124.1">Business capabilities</span></strong><span class="koboSpan" id="kobo.125.1">: Depending on how your organization defines value, network automation can help discover opportunities. </span><span class="koboSpan" id="kobo.125.2">Increased visibility could help improve capacity planning or spot unused capacity or hot spots. </span><span class="koboSpan" id="kobo.125.3">New services or business capabilities can be an outcome of streamlined cross-team interactions due to the well-defined interfaces, inputs, and outputs of an </span><span class="No-Break"><span class="koboSpan" id="kobo.126.1">automated system.</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.127.1">Despite the rise of awareness about the benefits of network automation, some people are still hesitant to embrace it as an internal organizational practice, so getting support from them may require extra effort. </span><span class="koboSpan" id="kobo.127.2">Each situation is unique and, thus, may require a slightly distinct </span><a id="_idIndexMarker491"/><span class="koboSpan" id="kobo.128.1">set of arguments. </span><span class="koboSpan" id="kobo.128.2">In the end, network automation is becoming an important part of network engineering and its relevance in the industry continues </span><span class="No-Break"><span class="koboSpan" id="kobo.129.1">to increase.</span></span></p>
<p><span class="koboSpan" id="kobo.130.1">Now that we’ve defined what network automation is and why we need it, it’s time to dig deeper and start looking at concrete use cases and areas where you can apply it in the traditional network </span><span class="No-Break"><span class="koboSpan" id="kobo.131.1">engineering discipline.</span></span></p>
<h1 id="_idParaDest-136"><a id="_idTextAnchor135"/><span class="koboSpan" id="kobo.132.1">Automating network operation tasks</span></h1>
<p><span class="koboSpan" id="kobo.133.1">This section</span><a id="_idIndexMarker492"/><span class="koboSpan" id="kobo.134.1"> introduces some common network operation tasks and use cases where you can introduce automation without causing too much friction with the existing tools and processes. </span><span class="koboSpan" id="kobo.134.2">We aim to take a series of manual steps normally performed by a human operator and explore how you can convert them into code so that a computer can execute them for you, all while keeping the original inputs and outputs unchanged. </span><span class="koboSpan" id="kobo.134.3">We will divide this section into </span><span class="No-Break"><span class="koboSpan" id="kobo.135.1">three categories:</span></span></p>
<ul>
<li><span class="No-Break"><span class="koboSpan" id="kobo.136.1">Configuration management</span></span></li>
<li><span class="koboSpan" id="kobo.137.1">Network </span><span class="No-Break"><span class="koboSpan" id="kobo.138.1">state analysis</span></span></li>
<li><span class="koboSpan" id="kobo.139.1">Network audits </span><span class="No-Break"><span class="koboSpan" id="kobo.140.1">and reporting</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.141.1">Let’s </span><span class="No-Break"><span class="koboSpan" id="kobo.142.1">get started.</span></span></p>
<h2 id="_idParaDest-137"><a id="_idTextAnchor136"/><span class="koboSpan" id="kobo.143.1">Configuration management</span></h2>
<p><span class="koboSpan" id="kobo.144.1">This is the most popular area of the network</span><a id="_idIndexMarker493"/><span class="koboSpan" id="kobo.145.1"> engineering discipline that spans beyond network operations and often includes design and architecture stages. </span><span class="koboSpan" id="kobo.145.2">Most</span><a id="_idIndexMarker494"/><span class="koboSpan" id="kobo.146.1"> people see this as the lowest-hanging fruit to test, or where to start using, network automation. </span><span class="koboSpan" id="kobo.146.2">Let’s look at some common use cases that fall under </span><span class="No-Break"><span class="koboSpan" id="kobo.147.1">this category.</span></span></p>
<h3><span class="koboSpan" id="kobo.148.1">Config generation</span></h3>
<p><span class="koboSpan" id="kobo.149.1">Before we can make any changes to </span><a id="_idIndexMarker495"/><span class="koboSpan" id="kobo.150.1">a network device, we need to craft the desired configuration for that target device. </span><span class="koboSpan" id="kobo.150.2">Traditionally, we would do this manually in a text editor, which involves a lot of copy/paste and </span><span class="No-Break"><span class="koboSpan" id="kobo.151.1">search/replace actions.</span></span></p>
<p><span class="koboSpan" id="kobo.152.1">You can use the following Go packages to automate this process and generate a network device configuration based on a set </span><span class="No-Break"><span class="koboSpan" id="kobo.153.1">of inputs:</span></span></p>
<ul>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.154.1">text/template</span></strong><span class="koboSpan" id="kobo.155.1">: A</span><a id="_idIndexMarker496"/><span class="koboSpan" id="kobo.156.1"> package from the standard library that uses a special Go templating language to generate an unstructured text document based on the input program variables. </span><span class="koboSpan" id="kobo.156.2">We will use this package in the </span><em class="italic"><span class="koboSpan" id="kobo.157.1">Interacting with network devices via SSH</span></em><span class="koboSpan" id="kobo.158.1"> section in </span><a href="B16971_06.xhtml#_idTextAnchor144"><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.159.1">Chapter 6</span></em></span></a><span class="koboSpan" id="kobo.160.1">, </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.161.1">Configuration Management</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.162.1">.</span></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.163.1">flosch/pongo2</span></strong><span class="koboSpan" id="kobo.164.1">: A</span><a id="_idIndexMarker497"/><span class="koboSpan" id="kobo.165.1"> Django-syntax-like templating language for those that are more familiar with Jinja2 (the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.166.1">gonja</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.167.1"> fork).</span></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.168.1">encoding</span></strong><span class="koboSpan" id="kobo.169.1">: This</span><a id="_idIndexMarker498"/><span class="koboSpan" id="kobo.170.1"> package includes encoders and decoders for YAML and JSON to parse and generate documents you can use with structured network APIs (for example, YANG or OpenAPI). </span><span class="koboSpan" id="kobo.170.2">We will use this package in the </span><em class="italic"><span class="koboSpan" id="kobo.171.1">Getting config inputs from other systems via HTTP</span></em><span class="koboSpan" id="kobo.172.1"> section in </span><a href="B16971_06.xhtml#_idTextAnchor144"><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.173.1">Chapter 6</span></em></span></a><span class="koboSpan" id="kobo.174.1">, </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.175.1">Configuration Management</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.176.1">.</span></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.177.1">regexp</span></strong><span class="koboSpan" id="kobo.178.1">: Another </span><a id="_idIndexMarker499"/><span class="koboSpan" id="kobo.179.1">standard library package that implements efficient regular expression pattern matching and string manipulation. </span><span class="koboSpan" id="kobo.179.2">We will use this package in the example at the end of </span><span class="No-Break"><span class="koboSpan" id="kobo.180.1">this chapter.</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.181.1">Once you</span><a id="_idIndexMarker500"/><span class="koboSpan" id="kobo.182.1"> sort out the configuration details, you can send this config to the target device, which brings us to the next set of </span><span class="No-Break"><span class="koboSpan" id="kobo.183.1">use cases.</span></span></p>
<h3><span class="koboSpan" id="kobo.184.1">Configuration changes, backups, and restore</span></h3>
<p><span class="koboSpan" id="kobo.185.1">Working with device configuration</span><a id="_idIndexMarker501"/><span class="koboSpan" id="kobo.186.1"> may involve backing up and replacing the entire device configuration or making scoped changes to provision new services or update existing configuration snippets. </span><span class="koboSpan" id="kobo.186.2">Making these changes often involves logging into each device individually and executing a set of vendor-specific commands in </span><span class="No-Break"><span class="koboSpan" id="kobo.187.1">a sequence.</span></span></p>
<p><span class="koboSpan" id="kobo.188.1">The following Go packages can help with the transport abstractions that are common across different networking vendors to streamline the steps to make changes to, back up, or restore your </span><span class="No-Break"><span class="koboSpan" id="kobo.189.1">network configurations:</span></span></p>
<ul>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.190.1">crypto/ssh</span></strong><span class="koboSpan" id="kobo.191.1">: A</span><a id="_idIndexMarker502"/><span class="koboSpan" id="kobo.192.1"> standard library package that implements base SSH connectivity. </span><span class="koboSpan" id="kobo.192.2">We will use this package in the </span><em class="italic"><span class="koboSpan" id="kobo.193.1">Interacting with network devices via SSH</span></em><span class="koboSpan" id="kobo.194.1"> section in </span><a href="B16971_06.xhtml#_idTextAnchor144"><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.195.1">Chapter 6</span></em></span></a><span class="koboSpan" id="kobo.196.1">, </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.197.1">Configuration Management</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.198.1">.</span></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.199.1">scrapli/scrapligo</span></strong><span class="koboSpan" id="kobo.200.1">: A</span><a id="_idIndexMarker503"/><span class="koboSpan" id="kobo.201.1"> third-party package that builds on top of crypto/SSH and offers various convenient helper functions to work with different CLI prompts and commands from major networking vendors. </span><span class="koboSpan" id="kobo.201.2">You can also use this package as a NETCONF client. </span><span class="koboSpan" id="kobo.201.3">We will use this package in the </span><em class="italic"><span class="koboSpan" id="kobo.202.1">Automating routine SSH tasks</span></em><span class="koboSpan" id="kobo.203.1"> section in </span><a href="B16971_06.xhtml#_idTextAnchor144"><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.204.1">Chapter 6</span></em></span></a><span class="koboSpan" id="kobo.205.1">, </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.206.1">Configuration Management</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.207.1">.</span></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.208.1">net/http</span></strong><span class="koboSpan" id="kobo.209.1">: A standard</span><a id="_idIndexMarker504"/><span class="koboSpan" id="kobo.210.1"> library package that you can use to talk to HTTP-based APIs, such as RESTCONF or OpenAPI. </span><span class="koboSpan" id="kobo.210.2">We will use this package in the </span><em class="italic"><span class="koboSpan" id="kobo.211.1">Getting config inputs from other systems via HTTP</span></em><span class="koboSpan" id="kobo.212.1"> section in </span><a href="B16971_06.xhtml#_idTextAnchor144"><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.213.1">Chapter 6</span></em></span></a><span class="koboSpan" id="kobo.214.1">, </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.215.1">Configuration Management</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.216.1">.</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.217.1">The preceding list is by no means exclusive and several more third-party packages are available, including some that are specifically designed to work with </span><strong class="bold"><span class="koboSpan" id="kobo.218.1">RESTCONF</span></strong><span class="koboSpan" id="kobo.219.1"> (</span><em class="italic"><span class="koboSpan" id="kobo.220.1">Further reading</span></em><span class="koboSpan" id="kobo.221.1">) or </span><strong class="bold"><span class="koboSpan" id="kobo.222.1">NETCONF</span></strong><span class="koboSpan" id="kobo.223.1"> (</span><em class="italic"><span class="koboSpan" id="kobo.224.1">Further reading</span></em><span class="koboSpan" id="kobo.225.1">), but they all vary in their levels of activity or openness to </span><span class="No-Break"><span class="koboSpan" id="kobo.226.1">outside contributions.</span></span></p>
<p><span class="koboSpan" id="kobo.227.1">It always helps to look</span><a id="_idIndexMarker505"/><span class="koboSpan" id="kobo.228.1"> around, especially when choosing an external package, to make sure it fits your needs and has a healthy community </span><span class="No-Break"><span class="koboSpan" id="kobo.229.1">of contributors.</span></span></p>
<h3><span class="koboSpan" id="kobo.230.1">Configuration diffs and compliance checks</span></h3>
<p><span class="koboSpan" id="kobo.231.1">After you have applied</span><a id="_idIndexMarker506"/><span class="koboSpan" id="kobo.232.1"> the desired configuration, you may need to run periodic compliance checks to make sure certain invariants remain unchanged or to</span><a id="_idIndexMarker507"/><span class="koboSpan" id="kobo.233.1"> detect any configuration drift. </span><span class="koboSpan" id="kobo.233.2">These use cases rely on string searching, pattern matching, and computing differences. </span><span class="koboSpan" id="kobo.233.3">You can leverage the following Go packages for </span><span class="No-Break"><span class="koboSpan" id="kobo.234.1">this purpose:</span></span></p>
<ul>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.235.1">strings</span></strong><span class="koboSpan" id="kobo.236.1">: A</span><a id="_idIndexMarker508"/><span class="koboSpan" id="kobo.237.1"> package from the standard library that can offer basic string comparison and pattern matching with the </span><strong class="source-inline"><span class="koboSpan" id="kobo.238.1">Compare</span></strong><span class="koboSpan" id="kobo.239.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.240.1">Contains</span></strong><span class="koboSpan" id="kobo.241.1"> functions. </span><span class="koboSpan" id="kobo.241.2">We will use this package in the example at the end of </span><span class="No-Break"><span class="koboSpan" id="kobo.242.1">this chapter.</span></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.243.1">sergi/go-diff</span></strong><span class="koboSpan" id="kobo.244.1">: A</span><a id="_idIndexMarker509"/><span class="koboSpan" id="kobo.245.1"> third-party package that can compare, match, or patch plain text (a Go port of the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.246.1">google/diff-match-patch</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.247.1"> package).</span></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.248.1">homeport/dyff</span></strong><span class="koboSpan" id="kobo.249.1">: Another </span><a id="_idIndexMarker510"/><span class="koboSpan" id="kobo.250.1">third-party package and a command-line tool you can use to compare structured documents, such as JSON </span><span class="No-Break"><span class="koboSpan" id="kobo.251.1">or YAML.</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.252.1">While keeping your device configuration in check is crucial, you can’t derive everything that happens in the network from them. </span><span class="koboSpan" id="kobo.252.2">That’s why we need to complement our analysis with the operational data we gather from </span><span class="No-Break"><span class="koboSpan" id="kobo.253.1">the network.</span></span></p>
<h2 id="_idParaDest-138"><a id="_idTextAnchor137"/><span class="koboSpan" id="kobo.254.1">Network state analysis</span></h2>
<p><span class="koboSpan" id="kobo.255.1">The operational state that </span><a id="_idIndexMarker511"/><span class="koboSpan" id="kobo.256.1">results from an applied configuration is often hard </span><a id="_idIndexMarker512"/><span class="koboSpan" id="kobo.257.1">to predict. </span><span class="koboSpan" id="kobo.257.2">You can spend a significant amount of time fine-tuning monitoring and collecting information from the network. </span><span class="koboSpan" id="kobo.257.3">But these use cases are often a good first step into network automation because of their low-risk profile, so they present a very attractive opportunity to start </span><span class="No-Break"><span class="koboSpan" id="kobo.258.1">using Go.</span></span></p>
<h3><span class="koboSpan" id="kobo.259.1">Collecting operational state</span></h3>
<p><span class="koboSpan" id="kobo.260.1">Depending</span><a id="_idIndexMarker513"/><span class="koboSpan" id="kobo.261.1"> on the</span><a id="_idIndexMarker514"/><span class="koboSpan" id="kobo.262.1"> target </span><strong class="bold"><span class="koboSpan" id="kobo.263.1">network operating system</span></strong><span class="koboSpan" id="kobo.264.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.265.1">NOS</span></strong><span class="koboSpan" id="kobo.266.1">), collecting operational data from a network device can be a quick API call – for example, an HTTP GET with a URL parameter of </span><strong class="source-inline"><span class="koboSpan" id="kobo.267.1">?rev=operational</span></strong><span class="koboSpan" id="kobo.268.1"> indicates that the returned data should come from the operational data store. </span><span class="koboSpan" id="kobo.268.2">In contrast, for a human-first NOS, this may require extra steps to parse the CLI output you get from it. </span><span class="koboSpan" id="kobo.268.3">You can do this in Go in a few </span><span class="No-Break"><span class="koboSpan" id="kobo.269.1">different ways:</span></span></p>
<ul>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.270.1">regexp</span></strong><span class="koboSpan" id="kobo.271.1">: Using</span><a id="_idIndexMarker515"/><span class="koboSpan" id="kobo.272.1"> regular expressions is the most battle-tested and well-known way of parsing unstructured text into variables. </span><span class="koboSpan" id="kobo.272.2">Keep in mind that writing robust regular expressions and troubleshooting them can be a challenge. </span><span class="koboSpan" id="kobo.272.3">We will use this package in the example at the end of </span><span class="No-Break"><span class="koboSpan" id="kobo.273.1">this chapter.</span></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.274.1">sirikothe/gotextfsm</span></strong><span class="koboSpan" id="kobo.275.1">: This </span><a id="_idIndexMarker516"/><span class="koboSpan" id="kobo.276.1">package offers a higher-level abstraction built on top of the </span><strong class="source-inline"><span class="koboSpan" id="kobo.277.1">regexp</span></strong><span class="koboSpan" id="kobo.278.1"> package, designed to parse semi-formatted text, meaning text with visual structure, such as tables, but represented as a single string. </span><span class="koboSpan" id="kobo.278.2">We will use this package indirectly in the </span><em class="italic"><span class="koboSpan" id="kobo.279.1">Checking routing information</span></em><span class="koboSpan" id="kobo.280.1"> section in </span><a href="B16971_06.xhtml#_idTextAnchor144"><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.281.1">Chapter 6</span></em></span></a><span class="koboSpan" id="kobo.282.1">, </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.283.1">Configuration Management</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.284.1">.</span></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.285.1">scrapli/scrapligo</span></strong><span class="koboSpan" id="kobo.286.1">: This </span><a id="_idIndexMarker517"/><span class="koboSpan" id="kobo.287.1">package embeds</span><a id="_idIndexMarker518"/><span class="koboSpan" id="kobo.288.1"> the </span><strong class="source-inline"><span class="koboSpan" id="kobo.289.1">textfsm</span></strong><span class="koboSpan" id="kobo.290.1"> package and allows you to parse the responses you get from networking devices using the </span><strong class="source-inline"><span class="koboSpan" id="kobo.291.1">TextFsmParse(template string)</span></strong><span class="koboSpan" id="kobo.292.1"> function. </span><span class="koboSpan" id="kobo.292.2">We will use this package in the </span><em class="italic"><span class="koboSpan" id="kobo.293.1">Checking routing information</span></em><span class="koboSpan" id="kobo.294.1"> section in </span><a href="B16971_06.xhtml#_idTextAnchor144"><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.295.1">Chapter 6</span></em></span></a><span class="koboSpan" id="kobo.296.1">, </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.297.1">Configuration Management</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.298.1">.</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.299.1">You can get the operational state of the network and parse it into in-memory data structures before and after a maintenance window, for example, to compare them and vet the success of the work performed during this time. </span><span class="koboSpan" id="kobo.299.2">This is what we’ll </span><span class="No-Break"><span class="koboSpan" id="kobo.300.1">discuss next.</span></span></p>
<h3><span class="koboSpan" id="kobo.301.1">State snapshots and validation</span></h3>
<p><span class="koboSpan" id="kobo.302.1">Validating the</span><a id="_idIndexMarker519"/><span class="koboSpan" id="kobo.303.1"> operational state, to make</span><a id="_idIndexMarker520"/><span class="koboSpan" id="kobo.304.1"> sure that the values we receive are what we expect to see, is something network engineers do when they configure network devices, run troubleshooting sessions, provision services, perform software upgrades, and carry out other daily activities as part of their </span><span class="No-Break"><span class="koboSpan" id="kobo.305.1">job assignments.</span></span></p>
<p><span class="koboSpan" id="kobo.306.1">As we automate the collection of this data and since we can often pre-calculate the intended state, the next step is to check whether the state is as expected and then make sure that this state persists over time. </span><span class="koboSpan" id="kobo.306.2">For example, BGP neighbors should be in an </span><em class="italic"><span class="koboSpan" id="kobo.307.1">established</span></em><span class="koboSpan" id="kobo.308.1"> state and all connected interfaces should be </span><em class="italic"><span class="koboSpan" id="kobo.309.1">up</span></em><span class="koboSpan" id="kobo.310.1">. </span><span class="koboSpan" id="kobo.310.2">As we collect new data from the network, we record it in a structured format to compare it with the intended state and to trigger another action if we find </span><span class="No-Break"><span class="koboSpan" id="kobo.311.1">a difference.</span></span></p>
<p><span class="koboSpan" id="kobo.312.1">Comparing arbitrary data normally requires writing some custom code to traverse these data structures and look at the values that matter. </span><span class="koboSpan" id="kobo.312.2">But there are a few packages that can simplify </span><span class="No-Break"><span class="koboSpan" id="kobo.313.1">this task:</span></span></p>
<ul>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.314.1">reflect.DeepEqual</span></strong><span class="koboSpan" id="kobo.315.1">: This </span><a id="_idIndexMarker521"/><span class="koboSpan" id="kobo.316.1">package is part of the Go standard library and can use runtime reflection to compare values that are of the </span><span class="No-Break"><span class="koboSpan" id="kobo.317.1">same type.</span></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.318.1">mitchellh/hashstructure</span></strong><span class="koboSpan" id="kobo.319.1">: A </span><a id="_idIndexMarker522"/><span class="koboSpan" id="kobo.320.1">third-party package that can calculate a unique hash from arbitrary Go values that you can use to quickly answer the question if the operational state matches the one you expect. </span><span class="koboSpan" id="kobo.320.2">We will use this package in the example at the end of </span><span class="No-Break"><span class="koboSpan" id="kobo.321.1">this chapter.</span></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.322.1">r3labs/diff</span></strong><span class="koboSpan" id="kobo.323.1">: Another </span><a id="_idIndexMarker523"/><span class="koboSpan" id="kobo.324.1">third-party package that supports several standard Go types and relies on runtime reflection to produce a detailed log of all the differences between two Go structs </span><span class="No-Break"><span class="koboSpan" id="kobo.325.1">or values.</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.326.1">We can’t classify all operational states as </span><em class="italic"><span class="koboSpan" id="kobo.327.1">intended</span></em><span class="koboSpan" id="kobo.328.1">. </span><span class="koboSpan" id="kobo.328.2">Some values are more dynamic and their change is not always actionable. </span><span class="koboSpan" id="kobo.328.3">An example of this is MAC and IP address tables – their values fluctuate over time and long-term churn </span><span class="No-Break"><span class="koboSpan" id="kobo.329.1">is normal.</span></span></p>
<p><span class="koboSpan" id="kobo.330.1">Keeping</span><a id="_idIndexMarker524"/><span class="koboSpan" id="kobo.331.1"> track of the dynamic state of the </span><a id="_idIndexMarker525"/><span class="koboSpan" id="kobo.332.1">network can be helpful during routine maintenance, such as in software upgrades, where you make snapshots of the network state and can quickly compare the pre - and post-change values to spot any inconsistencies. </span><span class="koboSpan" id="kobo.332.2">Programmatically, this is just like the generic state validation use case. </span><span class="koboSpan" id="kobo.332.3">You use the same set of tools and libraries but save these snapshots as a structured document on a disk or inside a database </span><span class="No-Break"><span class="koboSpan" id="kobo.333.1">over time.</span></span></p>
<h2 id="_idParaDest-139"><a id="_idTextAnchor138"/><span class="koboSpan" id="kobo.334.1">Network audits and reporting</span></h2>
<p><span class="koboSpan" id="kobo.335.1">The scope of </span><a id="_idIndexMarker526"/><span class="koboSpan" id="kobo.336.1">network audits can vary greatly, from</span><a id="_idIndexMarker527"/><span class="koboSpan" id="kobo.337.1"> trying to identify obsolete hardware or end-of-life software to measuring the quality of the service or the rate of control plane updates. </span><span class="koboSpan" id="kobo.337.2">Normally, the goal is to collect and process state information from a large set of devices and produce some </span><span class="No-Break"><span class="koboSpan" id="kobo.338.1">human-readable output.</span></span></p>
<p><span class="koboSpan" id="kobo.339.1">We discussed state collection and validation tasks in the preceding section, and you can scale this process to target hundreds or thousands of network devices with goroutines, which we covered in </span><a href="B16971_03.xhtml#_idTextAnchor067"><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.340.1">Chapter 3</span></em></span></a><span class="koboSpan" id="kobo.341.1">, </span><em class="italic"><span class="koboSpan" id="kobo.342.1">Getting Started with Go</span></em><span class="koboSpan" id="kobo.343.1">. </span><span class="koboSpan" id="kobo.343.2">The missing part that we haven’t discussed yet is report generation. </span><span class="koboSpan" id="kobo.343.3">Here, Go also offers several resources that you can use to generate </span><span class="No-Break"><span class="koboSpan" id="kobo.344.1">human-readable outputs:</span></span></p>
<ul>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.345.1">text/tabwriter</span></strong><span class="koboSpan" id="kobo.346.1">: This is</span><a id="_idIndexMarker528"/><span class="koboSpan" id="kobo.347.1"> a package from the standard library you should consider if you want to send information to standard output. </span><span class="koboSpan" id="kobo.347.2">You can use this package to print tabbed data. </span><span class="koboSpan" id="kobo.347.3">Other feature-rich options exist outside of the standard library, one of which is the </span><strong class="source-inline"><span class="koboSpan" id="kobo.348.1">jedib0t/go-pretty/v6</span></strong><span class="koboSpan" id="kobo.349.1"> package, which can you can use to colorize text or print tables, lists, and </span><span class="No-Break"><span class="koboSpan" id="kobo.350.1">progress bars.</span></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.351.1">unidoc/unioffice</span></strong><span class="koboSpan" id="kobo.352.1">: This </span><a id="_idIndexMarker529"/><span class="koboSpan" id="kobo.353.1">package or </span><strong class="source-inline"><span class="koboSpan" id="kobo.354.1">qax-os/excelize</span></strong><span class="koboSpan" id="kobo.355.1"> are good options if you want to produce a spreadsheet. </span><span class="koboSpan" id="kobo.355.2">You can also use </span><strong class="source-inline"><span class="koboSpan" id="kobo.356.1">unidoc/unioffice</span></strong><span class="koboSpan" id="kobo.357.1"> to work with Word, Excel, or </span><span class="No-Break"><span class="koboSpan" id="kobo.358.1">PowerPoint documents.</span></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.359.1">html/template</span></strong><span class="koboSpan" id="kobo.360.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.361.1">text/template</span></strong><span class="koboSpan" id="kobo.362.1">: These are</span><a id="_idIndexMarker530"/><span class="koboSpan" id="kobo.363.1"> the two most common templating</span><a id="_idIndexMarker531"/><span class="koboSpan" id="kobo.364.1"> libraries. </span><span class="koboSpan" id="kobo.364.2">Hugo, the popular static site generator, uses both the </span><strong class="source-inline"><span class="koboSpan" id="kobo.365.1">html</span></strong><span class="koboSpan" id="kobo.366.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.367.1">text</span></strong><span class="koboSpan" id="kobo.368.1"> template packages, </span><span class="No-Break"><span class="koboSpan" id="kobo.369.1">for example.</span></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.370.1">go:embed</span></strong><span class="koboSpan" id="kobo.371.1">: This is a</span><a id="_idIndexMarker532"/><span class="koboSpan" id="kobo.372.1"> Go directive that you could use to allow templates to be embedded inside </span><a id="_idIndexMarker533"/><span class="koboSpan" id="kobo.373.1">a compiled Go binary to simplify </span><a id="_idIndexMarker534"/><span class="No-Break"><span class="koboSpan" id="kobo.374.1">code distribution.</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.375.1">The use cases we’ve introduced in this section are all relatively independent. </span><span class="koboSpan" id="kobo.375.2">Once you automate them, they can become so-called automation islands, completely isolated from one another at first, but once their number grows, they may merge into more complex multi-stage workflows or even complete closed-loop systems. </span><span class="koboSpan" id="kobo.375.3">This is what we’ll explore in the </span><span class="No-Break"><span class="koboSpan" id="kobo.376.1">next section.</span></span></p>
<h1 id="_idParaDest-140"><a id="_idTextAnchor139"/><span class="koboSpan" id="kobo.377.1">Systems approach</span></h1>
<p><span class="koboSpan" id="kobo.378.1">As you start automating different tasks with </span><a id="_idIndexMarker535"/><span class="koboSpan" id="kobo.379.1">an incremental approach, you may envision a path where you chain a subset of these automated tasks together to orchestrate </span><span class="No-Break"><span class="koboSpan" id="kobo.380.1">a workflow.</span></span></p>
<p><span class="koboSpan" id="kobo.381.1">You can also look at this from a different angle. </span><span class="koboSpan" id="kobo.381.2">You initially break down your existing manual processes into smaller chunks of work that you can automate independently, so you don’t need to wait until you get the full end-to-end process automated to start taking advantage of automation, while at the same time you are mindful of the </span><span class="No-Break"><span class="koboSpan" id="kobo.382.1">bigger picture.</span></span></p>
<p><span class="koboSpan" id="kobo.383.1">In this context, you take the first steps to interconnect different building blocks, which become part of a larger system that delivers a business outcome with eventually no human intervention that originally may have involved several teams. </span><span class="koboSpan" id="kobo.383.2">That’s what we call a </span><span class="No-Break"><span class="koboSpan" id="kobo.384.1">systems approach.</span></span></p>
<p><span class="koboSpan" id="kobo.385.1">One common example is when you mix the processes of configuring network services and collecting operational data from the network, which is what we’ll </span><span class="No-Break"><span class="koboSpan" id="kobo.386.1">discuss next.</span></span></p>
<h2 id="_idParaDest-141"><a id="_idTextAnchor140"/><span class="koboSpan" id="kobo.387.1">Closed-loop automation</span></h2>
<p><span class="koboSpan" id="kobo.388.1">One of the first things every</span><a id="_idIndexMarker536"/><span class="koboSpan" id="kobo.389.1"> network engineer does after configuring </span><a id="_idIndexMarker537"/><span class="koboSpan" id="kobo.390.1">anything on a network device is to check the status of that service, protocol, or resource configured via a CLI command. </span><span class="koboSpan" id="kobo.390.2">If an automated system performs this configuration, the network engineer still needs to log into a network device or group of network devices to execute commands, or maybe go to a web portal to check the logs or graphs that show the statistics for the network devices. </span><span class="koboSpan" id="kobo.390.3">This time-consuming, repetitive process that is error-prone for humans becomes a natural fit for automation </span><span class="No-Break"><span class="koboSpan" id="kobo.391.1">as well.</span></span></p>
<p><span class="koboSpan" id="kobo.392.1">Now, you not only push the configuration or instructions down to the network but also ingest real-time operational data from the network, which you can process to determine whether it matches the intended state of </span><span class="No-Break"><span class="koboSpan" id="kobo.393.1">the network.</span></span></p>
<p><span class="koboSpan" id="kobo.394.1">If we abstract away the network device details, a closed-loop application would consume </span><strong class="bold"><span class="koboSpan" id="kobo.395.1">network intelligence</span></strong><span class="koboSpan" id="kobo.396.1"> on one</span><a id="_idIndexMarker538"/><span class="koboSpan" id="kobo.397.1"> interface, and push intent down to the network. </span><span class="koboSpan" id="kobo.397.2">We can loosely define these </span><span class="No-Break"><span class="koboSpan" id="kobo.398.1">as follows:</span></span></p>
<ul>
<li><strong class="bold"><span class="koboSpan" id="kobo.399.1">Intent</span></strong><span class="koboSpan" id="kobo.400.1">: This would be the</span><a id="_idIndexMarker539"/><span class="koboSpan" id="kobo.401.1"> declarative definition of the operational state or measurable outcome you expect in the context of the network (topology, inventory, protocol, and so on) without requiring you to specify an exact procedure to get to it (those are </span><span class="No-Break"><span class="koboSpan" id="kobo.402.1">implementation details).</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.403.1">Network intelligence</span></strong><span class="koboSpan" id="kobo.404.1">: This </span><a id="_idIndexMarker540"/><span class="koboSpan" id="kobo.405.1">would be telemetry from the network that is actionable after some level of processing to make it useful. </span><span class="koboSpan" id="kobo.405.2">Keep in mind that events, metrics, stats, or alarms do not necessarily translate into actionable intelligence. </span><span class="koboSpan" id="kobo.405.3">Network operators get so many alarms that it’s hard to know what’s real and what’s noise. </span><span class="koboSpan" id="kobo.405.4">Hence, network intelligence results from</span><a id="_idIndexMarker541"/><span class="koboSpan" id="kobo.406.1"> correlating this data, running analytics, or any other process that helps tie this to the </span><span class="No-Break"><span class="koboSpan" id="kobo.407.1">desired intent.</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.408.1">The following is a high-level</span><a id="_idIndexMarker542"/><span class="koboSpan" id="kobo.409.1"> diagram of a </span><span class="No-Break"><span class="koboSpan" id="kobo.410.1">closed-loop application:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer054">
<span class="koboSpan" id="kobo.411.1"><img alt="Figure 5.1 – Closed-loop automation – 10,000 foot view" src="image/Figure_5.1.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.412.1">Figure 5.1 – Closed-loop automation – 10,000 foot view</span></p>
<p><span class="koboSpan" id="kobo.413.1">The intent translates into</span><a id="_idIndexMarker543"/><span class="koboSpan" id="kobo.414.1"> configuration syntax or programmatic instructions, which are specific to the network device. </span><span class="koboSpan" id="kobo.414.2">We can adjust these instructions based on the feedback we get from the network, enabling us to close the loop and automate the life cycle of </span><span class="No-Break"><span class="koboSpan" id="kobo.415.1">network services.</span></span></p>
<p><span class="koboSpan" id="kobo.416.1">You can think of a </span><a id="_idIndexMarker544"/><span class="koboSpan" id="kobo.417.1">closed-loop system as a continuous loop that learns from the networks and adapts to them. </span><span class="koboSpan" id="kobo.417.2">This could replace pre - and post-snapshot checks as you would compare the network at arbitrary times and for arbitrary deltas continuously. </span><span class="koboSpan" id="kobo.417.3">But what we see in networks today is somewhat closer to systems that react to the network feedback only during the time window in which they provision a service. </span><span class="koboSpan" id="kobo.417.4">This is what we will replicate in the </span><span class="No-Break"><span class="koboSpan" id="kobo.418.1">following example.</span></span></p>
<h2 id="_idParaDest-142"><a id="_idTextAnchor141"/><span class="koboSpan" id="kobo.419.1">Demo application</span></h2>
<p><span class="koboSpan" id="kobo.420.1">For the demo application, we</span><a id="_idIndexMarker545"/><span class="koboSpan" id="kobo.421.1"> could either build a distributed system where all the different components communicate and coordinate via messages over the network, or run everything on just one node in a single application. </span><span class="koboSpan" id="kobo.421.2">Because the goal is to illustrate the notion of closed-loop automation and not to show how distributed systems work, we will keep the application simple and run all the components as functions of a monolith application, as shown in the </span><span class="No-Break"><span class="koboSpan" id="kobo.422.1">following diagram:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer055">
<span class="koboSpan" id="kobo.423.1"><img alt="Figure 5.2 – Closed-loop automation sample application" src="image/Figure_5.2.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.424.1">Figure 5.2 – Closed-loop automation sample application</span></p>
<p><span class="koboSpan" id="kobo.425.1">The application starts by reading the input data from the user. </span><span class="koboSpan" id="kobo.425.2">It reads the target device information for this example from a file, </span><strong class="source-inline"><span class="koboSpan" id="kobo.426.1">input.yml</span></strong><span class="koboSpan" id="kobo.427.1">, as shown in the following code snippet. </span><span class="koboSpan" id="kobo.427.2">We hard code the parameters of the service to configure a variable (</span><strong class="source-inline"><span class="koboSpan" id="kobo.428.1">intent</span></strong><span class="koboSpan" id="kobo.429.1">) in the code. </span><span class="koboSpan" id="kobo.429.2">The service</span><a id="_idIndexMarker546"/><span class="koboSpan" id="kobo.430.1"> we want to configure in this case</span><a id="_idIndexMarker547"/><span class="koboSpan" id="kobo.431.1"> is </span><strong class="bold"><span class="koboSpan" id="kobo.432.1">gRPC</span></strong><span class="koboSpan" id="kobo.433.1">, listening on IPv4 port </span><strong class="source-inline"><span class="koboSpan" id="kobo.434.1">57777</span></strong><span class="koboSpan" id="kobo.435.1"> with </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.436.1">TLS</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.437.1"> enabled:</span></span></p>
<pre class="source-code"><span class="Code_Brown"><span class="koboSpan" id="kobo.438.1"># input.yml</span></span>
<span class="Code_Blue"><span class="koboSpan" id="kobo.439.1">router</span></span><span class="koboSpan" id="kobo.440.1">:
- </span><span class="Code_Blue"><span class="koboSpan" id="kobo.441.1">hostname</span></span><span class="koboSpan" id="kobo.442.1">: sandbox-iosxr-1.cisco.com
  </span><span class="Code_Blue"><span class="koboSpan" id="kobo.443.1">platform</span></span><span class="koboSpan" id="kobo.444.1">: cisco_iosxr
  </span><span class="Code_Blue"><span class="koboSpan" id="kobo.445.1">strictkey</span></span><span class="koboSpan" id="kobo.446.1">: false
  </span><span class="Code_Blue"><span class="koboSpan" id="kobo.447.1">username</span></span><span class="koboSpan" id="kobo.448.1">: admin
  </span><span class="Code_Blue"><span class="koboSpan" id="kobo.449.1">password</span></span><span class="koboSpan" id="kobo.450.1">: C1sco12345</span></pre>
<p><span class="koboSpan" id="kobo.451.1">We </span><a id="_idIndexMarker548"/><span class="koboSpan" id="kobo.452.1">encapsulate the service information in a </span><strong class="source-inline"><span class="koboSpan" id="kobo.453.1">Service</span></strong><span class="koboSpan" id="kobo.454.1"> definition that acts as a higher layer of abstraction than what a network device configuration represents, which translates into the intent for this example. </span><span class="koboSpan" id="kobo.454.2">We also compute a hash of this value so that we can compare it later with the operational information we receive from </span><span class="No-Break"><span class="koboSpan" id="kobo.455.1">the network:</span></span></p>
<pre class="source-code"><span class="Code_Purple"><span class="koboSpan" id="kobo.456.1">func main() {</span></span><span class="koboSpan" id="kobo.457.1">
    </span><span class="Code_Brown"><span class="koboSpan" id="kobo.458.1">/* ... </span><span class="koboSpan" id="kobo.458.2">&lt;omitted for brevity &gt; ... </span><span class="koboSpan" id="kobo.458.3">*/</span></span><span class="koboSpan" id="kobo.459.1">
    intent :</span><span class="Code_Red"><span class="koboSpan" id="kobo.460.1">=</span></span><span class="koboSpan" id="kobo.461.1"> Service{
        Name:     </span><span class="Code_Red"><span class="koboSpan" id="kobo.462.1">"grpc"</span></span><span class="koboSpan" id="kobo.463.1">,
        Port:     </span><span class="Code_Red"><span class="koboSpan" id="kobo.464.1">"57777"</span></span><span class="koboSpan" id="kobo.465.1">,
        AF:       </span><span class="Code_Red"><span class="koboSpan" id="kobo.466.1">"ipv4"</span></span><span class="koboSpan" id="kobo.467.1">,
        Insecure: </span><span class="Code_Blue"><span class="koboSpan" id="kobo.468.1">false</span></span><span class="koboSpan" id="kobo.469.1">,
        CLI:      </span><span class="Code_Red"><span class="koboSpan" id="kobo.470.1">"show grpc status"</span></span><span class="koboSpan" id="kobo.471.1">,
    }
    intentHash, err :</span><span class="Code_Red"><span class="koboSpan" id="kobo.472.1">=</span></span><span class="koboSpan" id="kobo.473.1"> hashstructure.Hash(intent,
        hashstructure.FormatV2, </span><span class="Code_Blue"><span class="koboSpan" id="kobo.474.1">nil</span></span><span class="koboSpan" id="kobo.475.1">)
    </span><span class="Code_Brown"><span class="koboSpan" id="kobo.476.1">/* ... </span><span class="koboSpan" id="kobo.476.2">&lt;omitted for brevity &gt; ... </span><span class="koboSpan" id="kobo.476.3">*/</span></span><span class="koboSpan" id="kobo.477.1">
}</span></pre>
<p><span class="koboSpan" id="kobo.478.1">Before the application configures the service, we have the chance to perform a series of pre-maintenance tasks, such as running a network audit to report whether the service is present already, so you may not need to configure it. </span><span class="koboSpan" id="kobo.478.2">Another good idea is to make a backup of the network device’s configuration in case we need to roll back </span><span class="No-Break"><span class="koboSpan" id="kobo.479.1">the changes.</span></span></p>
<p><span class="koboSpan" id="kobo.480.1">In this example, we must make a configuration backup of the target device with the </span><strong class="source-inline"><span class="koboSpan" id="kobo.481.1">getConfig</span></strong><span class="koboSpan" id="kobo.482.1"> method and then save it in a folder with the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.483.1">save</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.484.1"> method:</span></span></p>
<pre class="source-code"><span class="Code_Purple"><span class="koboSpan" id="kobo.485.1">func </span></span><span class="koboSpan" id="kobo.486.1">main() {
    </span><span class="Code_Brown"><span class="koboSpan" id="kobo.487.1">/* ... </span><span class="koboSpan" id="kobo.487.2">&lt;omitted for brevity &gt; ... </span><span class="koboSpan" id="kobo.487.3">*/</span></span><span class="koboSpan" id="kobo.488.1">
    config, err :</span><span class="Code_Red"><span class="koboSpan" id="kobo.489.1">=</span></span><span class="koboSpan" id="kobo.490.1"> iosxr.getConfig()
    </span><span class="Code_Brown"><span class="koboSpan" id="kobo.491.1">// process error</span></span><span class="koboSpan" id="kobo.492.1">
    err </span><span class="Code_Red"><span class="koboSpan" id="kobo.493.1">=</span></span><span class="koboSpan" id="kobo.494.1"> config.save()
    </span><span class="Code_Brown"><span class="koboSpan" id="kobo.495.1">/* ... </span><span class="koboSpan" id="kobo.495.2">&lt;omitted for brevity &gt; ... </span><span class="koboSpan" id="kobo.495.3">*/</span></span><span class="koboSpan" id="kobo.496.1">
}</span></pre>
<p><span class="koboSpan" id="kobo.497.1">With the </span><a id="_idIndexMarker549"/><span class="koboSpan" id="kobo.498.1">pre-work done, the application enters a continuous enforcement loop that runs, in this example, every 30 seconds. </span><span class="koboSpan" id="kobo.498.2">Inside the loop, the application collects the operational state of the service with the </span><strong class="source-inline"><span class="koboSpan" id="kobo.499.1">getOper</span></strong><span class="koboSpan" id="kobo.500.1"> method. </span><span class="koboSpan" id="kobo.500.2">This method sends a CLI command to the target device to gather the operational details of the service </span><span class="No-Break"><span class="koboSpan" id="kobo.501.1">we need:</span></span></p>
<pre class="source-code"><span class="Code_Purple"><span class="koboSpan" id="kobo.502.1">func </span></span><span class="koboSpan" id="kobo.503.1">(r Router) getOper(s Service) (o DeviceInfo, err </span><span class="Code_Purple"><span class="koboSpan" id="kobo.504.1">error</span></span><span class="koboSpan" id="kobo.505.1">) {
    rs, err :</span><span class="Code_Red"><span class="koboSpan" id="kobo.506.1">=</span></span><span class="koboSpan" id="kobo.507.1"> r.Conn.SendCommand(s.CLI)
    </span><span class="Code_Brown"><span class="koboSpan" id="kobo.508.1">// process error</span></span><span class="koboSpan" id="kobo.509.1">
    o </span><span class="Code_Red"><span class="koboSpan" id="kobo.510.1">=</span></span><span class="koboSpan" id="kobo.511.1"> DeviceInfo{
        Device:    r.Hostname,
        Output:    rs.Result,
        Timestamp: time.Now(),
    }
    </span><span class="Code_Purple"><span class="koboSpan" id="kobo.512.1">return </span></span><span class="koboSpan" id="kobo.513.1">o, </span><span class="Code_Blue"><span class="koboSpan" id="kobo.514.1">nil</span></span><span class="koboSpan" id="kobo.515.1">
}</span></pre>
<p><span class="koboSpan" id="kobo.516.1">Once we receive the response, we parse the information with regular expressions while using the </span><strong class="source-inline"><span class="koboSpan" id="kobo.517.1">regexp</span></strong><span class="koboSpan" id="kobo.518.1"> package to generate a new </span><strong class="source-inline"><span class="koboSpan" id="kobo.519.1">Service</span></strong><span class="koboSpan" id="kobo.520.1"> value with it that captures whether the service has </span><strong class="source-inline"><span class="koboSpan" id="kobo.521.1">TLS </span></strong><span class="koboSpan" id="kobo.522.1">enabled, for example, as well as the rest of the </span><strong class="source-inline"><span class="koboSpan" id="kobo.523.1">Service</span></strong><span class="koboSpan" id="kobo.524.1"> attributes. </span><span class="koboSpan" id="kobo.524.2">Then, we calculate a new hash for this </span><strong class="source-inline"><span class="koboSpan" id="kobo.525.1">Service</span></strong><span class="koboSpan" id="kobo.526.1"> type instance, which we compare with the original hash we have to validate whether the operational state of the service matches </span><span class="No-Break"><span class="koboSpan" id="kobo.527.1">the intent:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.528.1">    </span><span class="Code_Purple"><span class="koboSpan" id="kobo.529.1">if </span></span><span class="koboSpan" id="kobo.530.1">oprHash </span><span class="Code_Red"><span class="koboSpan" id="kobo.531.1">==</span></span><span class="koboSpan" id="kobo.532.1"> intentHash {
        </span><span class="Code_Purple"><span class="koboSpan" id="kobo.533.1">continue</span></span><span class="koboSpan" id="kobo.534.1">
    }</span></pre>
<p><span class="koboSpan" id="kobo.535.1">If these values match, we can proceed to the next iteration (</span><strong class="source-inline"><span class="koboSpan" id="kobo.536.1">continue</span></strong><span class="koboSpan" id="kobo.537.1">). </span><span class="koboSpan" id="kobo.537.2">Otherwise, we need to configure the router to bring the service to the desired state. </span><span class="koboSpan" id="kobo.537.3">Then, the loop starts over again. </span><span class="koboSpan" id="kobo.537.4">We get the service configuration in the target device’s syntax by using a template with the </span><strong class="source-inline"><span class="koboSpan" id="kobo.538.1">genConfig</span></strong><span class="koboSpan" id="kobo.539.1"> method and the </span><strong class="source-inline"><span class="koboSpan" id="kobo.540.1">text/template</span></strong><span class="koboSpan" id="kobo.541.1"> package, which we then send to the target device with the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.542.1">sendConfig</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.543.1"> function:</span></span></p>
<pre class="source-code"><span class="Code_Purple"><span class="koboSpan" id="kobo.544.1">func </span></span><span class="koboSpan" id="kobo.545.1">(r Router) sendConfig(conf </span><span class="Code_Purple"><span class="koboSpan" id="kobo.546.1">string</span></span><span class="koboSpan" id="kobo.547.1">) </span><span class="Code_Purple"><span class="koboSpan" id="kobo.548.1">error</span></span><span class="koboSpan" id="kobo.549.1"> {
    c, err :</span><span class="Code_Red"><span class="koboSpan" id="kobo.550.1">=</span></span><span class="koboSpan" id="kobo.551.1"> cfg.NewCfgDriver(r.Conn, r.Platform)
    </span><span class="Code_Brown"><span class="koboSpan" id="kobo.552.1">// process error</span></span><span class="koboSpan" id="kobo.553.1">
    err </span><span class="Code_Red"><span class="koboSpan" id="kobo.554.1">=</span></span><span class="koboSpan" id="kobo.555.1"> c.Prepare()
    </span><span class="Code_Brown"><span class="koboSpan" id="kobo.556.1">// process error</span></span><span class="koboSpan" id="kobo.557.1">
    _, err </span><span class="Code_Red"><span class="koboSpan" id="kobo.558.1">=</span></span><span class="koboSpan" id="kobo.559.1"> c.LoadConfig(conf, </span><span class="Code_Blue"><span class="koboSpan" id="kobo.560.1">false</span></span><span class="koboSpan" id="kobo.561.1">)
    </span><span class="Code_Brown"><span class="koboSpan" id="kobo.562.1">// process error</span></span><span class="koboSpan" id="kobo.563.1">
    _, err </span><span class="Code_Red"><span class="koboSpan" id="kobo.564.1">=</span></span><span class="koboSpan" id="kobo.565.1"> c.CommitConfig()
    </span><span class="Code_Brown"><span class="koboSpan" id="kobo.566.1">// process error</span></span><span class="koboSpan" id="kobo.567.1">
    </span><span class="Code_Purple"><span class="koboSpan" id="kobo.568.1">return </span></span><span class="Code_Blue"><span class="koboSpan" id="kobo.569.1">nil</span></span><span class="koboSpan" id="kobo.570.1">
}</span></pre>
<p><span class="koboSpan" id="kobo.571.1">If you want</span><a id="_idIndexMarker550"/><span class="koboSpan" id="kobo.572.1"> to see this example in action, you can run the code from the </span><strong class="source-inline"><span class="koboSpan" id="kobo.573.1">ch05/closed-loop</span></strong><span class="koboSpan" id="kobo.574.1"> folder. </span><span class="koboSpan" id="kobo.574.2">While it’s running, open an SSH session to the target Cisco DevNet device in a separate terminal window with </span><strong class="source-inline"><span class="koboSpan" id="kobo.575.1">sshpass -p "C1sco12345" ssh admin@sandbox-iosxr-1.cisco.com</span></strong><span class="koboSpan" id="kobo.576.1"> and execute the following to </span><span class="No-Break"><span class="koboSpan" id="kobo.577.1">disable </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.578.1">TLS</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.579.1">:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.580.1">conf
grpc no-tls 
commit</span></pre>
<p><span class="koboSpan" id="kobo.581.1">In the program’s output, you</span><a id="_idIndexMarker551"/><span class="koboSpan" id="kobo.582.1"> will see that it eventually catches this discrepancy, so it proceeds to remediate it by re-configuring TLS. </span><span class="koboSpan" id="kobo.582.2">The code</span><a id="_idIndexMarker552"/><span class="koboSpan" id="kobo.583.1"> for this example is available at </span><strong class="source-inline"><span class="koboSpan" id="kobo.584.1">ch05/closed-loop/main.go</span></strong><span class="koboSpan" id="kobo.585.1"> (</span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.586.1">Further reading</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.587.1">):</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.588.1">ch05/closed-loop$ go run main.go 
Entering to continuous loop </span><span class="Code_Red"><span class="koboSpan" id="kobo.589.1">====</span></span><span class="koboSpan" id="kobo.590.1">&gt;
 Loop at </span><span class="Code_Green"><span class="koboSpan" id="kobo.591.1">15</span></span><span class="koboSpan" id="kobo.592.1">:31:22
  Operational state from device:
   </span><span class="Code_Blue"><span class="koboSpan" id="kobo.593.1">service</span></span><span class="koboSpan" id="kobo.594.1">: grpc
   addr-family: ipv4
   port: </span><span class="Code_Green"><span class="koboSpan" id="kobo.595.1">57777</span></span><span class="koboSpan" id="kobo.596.1">
   TLS: </span><span class="Code_Blue"><span class="koboSpan" id="kobo.597.1">true</span></span><span class="koboSpan" id="kobo.598.1">
 Loop at </span><span class="Code_Green"><span class="koboSpan" id="kobo.599.1">15</span></span><span class="koboSpan" id="kobo.600.1">:31:52
  Operational state from device:
   </span><span class="Code_Blue"><span class="koboSpan" id="kobo.601.1">service</span></span><span class="koboSpan" id="kobo.602.1">: grpc
   addr-family: ipv4
   port: </span><span class="Code_Green"><span class="koboSpan" id="kobo.603.1">57777</span></span><span class="koboSpan" id="kobo.604.1">
   TLS: </span><span class="Code_Blue"><span class="koboSpan" id="kobo.605.1">false</span></span><span class="koboSpan" id="kobo.606.1">
Configuring device </span><span class="Code_Red"><span class="koboSpan" id="kobo.607.1">====</span></span><span class="koboSpan" id="kobo.608.1">&gt;
 Loop at </span><span class="Code_Green"><span class="koboSpan" id="kobo.609.1">15</span></span><span class="koboSpan" id="kobo.610.1">:32:22
  Operational state from device:
   </span><span class="Code_Blue"><span class="koboSpan" id="kobo.611.1">service</span></span><span class="koboSpan" id="kobo.612.1">: grpc
   addr-family: ipv4
   port: </span><span class="Code_Green"><span class="koboSpan" id="kobo.613.1">57777</span></span><span class="koboSpan" id="kobo.614.1">
   TLS: </span><span class="Code_Blue"><span class="koboSpan" id="kobo.615.1">true</span></span><span class="koboSpan" id="kobo.616.1">
...</span></pre>
<p><span class="koboSpan" id="kobo.617.1">The</span><a id="_idIndexMarker553"/><span class="koboSpan" id="kobo.618.1"> intelligence in this scenario only considers a boolean outcome, without a qualitative assessment of the network situation. </span><span class="koboSpan" id="kobo.618.2">You can also explore how to get a more involved assessment of the data you retrieve from the network to make a decision tree that goes beyond just a simple fix network yes </span><span class="No-Break"><span class="koboSpan" id="kobo.619.1">or no.</span></span></p>
<p><span class="koboSpan" id="kobo.620.1">Likewise, with intent, we only cover a direct predetermined relationship between the intent and the configuration you require to enable it. </span><span class="koboSpan" id="kobo.620.2">Real deployments likely have more moving parts and decisions on which parts </span><span class="No-Break"><span class="koboSpan" id="kobo.621.1">you need.</span></span></p>
<h1 id="_idParaDest-143"><a id="_idTextAnchor142"/><span class="koboSpan" id="kobo.622.1">Summary</span></h1>
<p><span class="koboSpan" id="kobo.623.1">In this chapter, we discussed what network automation is, its impact on network operations, and its benefits for the business. </span><span class="koboSpan" id="kobo.623.2">We talked about different use cases, from configuration management and network state analysis to running network audits and reporting, to finally look at how to put different pieces together to create a closed-loop system that can help you enforce the desired intent of </span><span class="No-Break"><span class="koboSpan" id="kobo.624.1">the network.</span></span></p>
<p><span class="koboSpan" id="kobo.625.1">In the next chapter, we’ll examine configuration management in detail, one of the more recurrent network automation use cases, and navigate through the options that Go presents to us to </span><span class="No-Break"><span class="koboSpan" id="kobo.626.1">automate it.</span></span></p>
<h1 id="_idParaDest-144"><a id="_idTextAnchor143"/><span class="koboSpan" id="kobo.627.1">Further reading</span></h1>
<p><span class="koboSpan" id="kobo.628.1">For more information about the topics that were covered in this chapter, take a look at the </span><span class="No-Break"><span class="koboSpan" id="kobo.629.1">following resources:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.630.1">This book’s GitHub </span><span class="No-Break"><span class="koboSpan" id="kobo.631.1">repository: </span></span><a href="https://github.com/PacktPublishing/Network-Automation-with-Go "><span class="No-Break"><span class="koboSpan" id="kobo.632.1">https://github.com/PacktPublishing/Network-Automation-with-Go</span></span></a></li>
<li><span class="No-Break"><span class="koboSpan" id="kobo.633.1">Batfish: </span></span><a href="https://www.batfish.org/ "><span class="No-Break"><span class="koboSpan" id="kobo.634.1">https://www.batfish.org/</span></span></a></li>
<li><span class="No-Break"><span class="koboSpan" id="kobo.635.1">Forward: </span></span><a href="https://forwardnetworks.com/forward-enterprise/ "><span class="No-Break"><span class="koboSpan" id="kobo.636.1">https://forwardnetworks.com/forward-enterprise/</span></span></a></li>
<li><span class="No-Break"><span class="koboSpan" id="kobo.637.1">RESTCONF: </span></span><a href="https://github.com/freeconf/restconf "><span class="No-Break"><span class="koboSpan" id="kobo.638.1">https://github.com/freeconf/restconf</span></span></a></li>
<li><span class="No-Break"><span class="koboSpan" id="kobo.639.1">NETCONF: </span></span><a href="https://github.com/Juniper/go-netconf "><span class="No-Break"><span class="koboSpan" id="kobo.640.1">https://github.com/Juniper/go-netconf</span></span></a></li>
<li><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.641.1">ch05/closed-loop/main.go</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.642.1">: </span></span><a href="https://github.com/PacktPublishing/Network-Automation-with-Go/blob/main/ch05/closed-loop/main.go#L1"><span class="No-Break"><span class="koboSpan" id="kobo.643.1">https://github.com/PacktPublishing/Network-Automation-with-Go/blob/main/ch05/closed-loop/main.go#L1</span></span></a></li>
</ul>
</div>
</body></html>